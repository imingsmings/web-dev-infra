"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[768],{3768:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Q});var s=n(6167),r=n(7798),i=n(5523),o=n(2974),l=n(7557),a=n(3444),c=n(1646),d=n.n(c),u=n(8208),h=n.n(u),f=n(4001),x=n(7878);d().extend(h());const m="translations-dashboard-differences";function j(e,t){try{const n=JSON.parse(localStorage.getItem(m)||"{}");n[e]=Object.assign({},n[e]||{},t),localStorage.setItem(m,JSON.stringify(n))}catch(n){console.warn("Unable to save to localStorage",n)}}function p(){const e=(0,f.bU)(),[t]=(0,i.lr)(),n=(0,r.s0)(),[l,a]=s.useState(null);s.useEffect((()=>{"en-us"===e.toLowerCase()&&n("/".concat(e,"/_translations"))}),[e,n]),s.useEffect((()=>{let t="All translations";"en-us"!==e.toLowerCase()&&(t+=" for ".concat(e)),l&&(t="(".concat(l.counts.found.toLocaleString()," found) ").concat(t)),document.title=t}),[l,e]);const{data:c,error:d,isValidating:u}=(0,o.ZP)("en-us"!==e.toLowerCase()?"/_translations/differences/?locale=".concat(e):null,(async e=>{const t=await fetch(e);if(!t.ok)throw new Error("".concat(t.status," (").concat(await t.text(),")"));if(!(t.headers.get("content-type")||"").includes("application/json"))throw new Error("Response is not JSON (".concat(t.headers.get("content-type"),")"));return t.json()}),{revalidateOnFocus:!1}),h=s.useRef();s.useEffect((()=>{if(e)if(c){if(c.counts.cacheMisses>0&&c.counts.cacheMisses===c.counts.total&&h.current){const t=(new Date).getTime()-h.current.getTime();j(e,{lastLoadTime:t})}}else h.current=new Date}),[e,c]),s.useEffect((()=>{c&&a(c)}),[c]);const p=function(e){try{const t=JSON.parse(localStorage.getItem(m)||"{}");if(t)return t[e]}catch(t){console.warn("Unable to retrieve from localStorage",t)}return null}(e),y=(null===p||void 0===p?void 0:p.defaultSort)||"modified",I=(null===p||void 0===p?void 0:p.defaultSortReverse)||"false",L=t.get("sort")||y,T=JSON.parse(t.get("sortReverse")||I);return s.useEffect((()=>{j(e,Object.assign({},p,{defaultSort:L,defaultSortReverse:T}))}),[e,L,T,p]),"en-us"===e.toLowerCase()?null:(0,x.jsxs)(g,{children:[l&&!d&&u&&(0,x.jsx)("p",{style:{float:"right"},children:"Reloading..."}),!c&&!d&&!l&&(0,x.jsx)(S,{estimate:p&&p.lastLoadTime||3e4}),l&&(0,x.jsxs)("p",{style:{textAlign:"right"},children:["Go to"," ",(0,x.jsxs)(i.rU,{to:"/".concat(e,"/_translations/missing"),children:["Missing translations for ",(0,x.jsx)("b",{children:e})]})]}),d&&(0,x.jsx)(v,{error:d}),l&&(0,x.jsxs)("div",{className:"filter-documents",children:[(0,x.jsx)(w,{}),(0,x.jsx)(N,{counts:l.counts,documents:l.documents,sort:L,sortReverse:T})]}),c&&(0,x.jsx)(b,{times:c.times})]})}function g(e){let{children:t}=e;return(0,x.jsx)(a.Z,{className:"all-translations",standalone:!0,children:t})}function v(e){let{error:t}=e;return(0,x.jsxs)("div",{className:"error-message search-error",children:[(0,x.jsx)("h3",{children:"Search error"}),(0,x.jsx)("pre",{children:t.toString()})]})}function b(e){let{times:t}=e;return(0,x.jsx)("div",{className:"search-times",children:(0,x.jsxs)("p",{children:["Time to find all documents ",function(e){if(e>1e3){return"".concat((e/1e3).toFixed(1)," seconds")}return"".concat(Math.trunc(e)," milliseconds")}(t.took)]})})}function S(e){let{estimate:t}=e;const n=new Date,[r]=s.useState(new Date(n.getTime()+t)),[,i]=s.useState(0);s.useEffect((()=>{const e=setInterval((()=>{i((e=>e+1))}),1e3);return()=>clearInterval(e)}),[]);const o=r.getTime()-n.getTime(),l=(new Date).getTime()-n.getTime(),a=100*l/o;return(0,x.jsxs)("div",{className:"loading",children:[(0,x.jsxs)("progress",{id:"progress",max:"100",value:a,style:{margin:20},children:[a,"%"]}),(0,x.jsx)("br",{}),(0,x.jsxs)("small",{children:["Estimated time to finish: ",((o-l)/1e3).toFixed(0),"s"," ",l>o?(0,x.jsx)("span",{"aria-label":"weird",role:"img",children:"\ud83d\ude43"}):null]})]})}function w(){const[e,t]=(0,i.lr)(),[n,r]=s.useState(e.get("title")||""),[o,l]=s.useState(e.get("url")||""),[a,c]=s.useState(e.get("differences")||"");function d(){let s=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const r=(0,i.fW)(e);for(const[e,t]of[["url",o],["title",n],["differences",a]])!s&&t?r.set(e,t):r.delete(e);r.delete("page"),t(r)}return(0,x.jsxs)("div",{className:"filters",children:[(0,x.jsx)("h3",{children:"Filters"}),(0,x.jsxs)("form",{onSubmit:e=>{e.preventDefault(),d()},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("h4",{children:"Document"}),(0,x.jsx)("input",{type:"search",placeholder:"Filter by document URI",value:o,onChange:e=>{l(e.target.value)},onBlur:()=>d()}),(0,x.jsx)("input",{type:"search",placeholder:"Filter by document title",value:n,onChange:e=>{r(e.target.value)},onBlur:()=>d()})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("h4",{children:"Differences"}),(0,x.jsx)("input",{type:"text",placeholder:"E.g. >0 or >=5",value:a,onChange:e=>{c(e.target.value)},onBlur:()=>d()})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("h4",{children:"\xa0"}),(0,x.jsx)("button",{type:"submit",children:"Filter now"})," ",(o||n)&&(0,x.jsx)("button",{type:"button",onClick:function(){l(""),r(""),c(""),d(!0)},children:"Reset filters"})]})]})]})}function N(e){let{counts:t,documents:n,sort:s,sortReverse:r}=e;const[o,l]=(0,i.lr)(),a=parseInt(o.get("page")||"1",10),c=parseInt(o.get("pageSize")||"20",10),d=o.get("title")||"",u=o.get("url")||"",h=o.get("differences")||"",f=function(e){function t(e){if(!e)throw new Error("Can't be empty");const t=parseInt(e,10);if(isNaN(t))throw new Error("'".concat(e,"' not a valid number"));return t}try{return e.startsWith(">=")?{operation:"gte",value:t(e.replace(">=",""))}:e.startsWith(">")?{operation:"gt",value:t(e.replace(">",""))}:e.startsWith("<=")?{operation:"lte",value:t(e.replace("<=",""))}:e.startsWith("<")?{operation:"lt",value:t(e.replace("<",""))}:e.startsWith("==")||e.startsWith("=")?{operation:"eq",value:t(e.replace(/=/g,""))}:e?{operation:"eq",value:t(e)}:null}catch(n){return console.warn(n),null}}(h);function m(e){let{id:t,title:n}=e;return(0,x.jsx)("th",{onClick:()=>{l(s===t?(0,i.fW)({sort:t,sortReverse:JSON.stringify(!r)}):(0,i.fW)({sort:t}))},className:"sortable ".concat(s===t?"active":""," ").concat(s===t&&r?"reverse":""),children:n})}const j=n.filter((e=>!(d&&!e.title.toLowerCase().includes(d.toLowerCase()))&&(!(u&&!e.mdn_url.toLowerCase().includes(u.toLowerCase()))&&!(f&&!function(e,t){if("eq"===t.operation){if(e!==t.value)return!1}else if("gt"===t.operation){if(!(e>t.value))return!1}else if("gte"===t.operation){if(!(e>=t.value))return!1}else if("lt"===t.operation){if(!(e<t.value))return!1}else{if("lte"!==t.operation)throw new Error("Not implemented operation '".concat(t.operation,"'"));if(!(e<=t.value))return!1}return!0}(e.differences.total,f))))).sort(((e,t)=>{let n=r?-1:1;if("modified"===s){const s=new Date(e.edits.modified);return n*(new Date(t.edits.modified).getTime()-s.getTime())}if("popularity"===s){const s=e.popularity.value;return n*(t.popularity.value-s)}if("differences"===s){const s=e.differences.total;return n*(t.differences.total-s)}if("title"===s){const s=e.title,r=t.title;return n*s.localeCompare(r)}if("mdn_url"===s){const s=e.mdn_url,r=t.mdn_url;return n*s.localeCompare(r)}throw new Error("Unrecognized sort '".concat(s,"'"))})),p=Math.ceil(t.found/c);return(0,x.jsxs)("div",{className:"documents",children:[(0,x.jsxs)("h3",{children:["Documents found (",j.length.toLocaleString(),")"," ",a>1&&(0,x.jsxs)("span",{className:"page",children:["page ",a]})," ",(0,x.jsxs)("small",{children:["of ",t.total.toLocaleString()," in total"]})]}),h&&!f&&(0,x.jsxs)("div",{className:"error-message",children:[(0,x.jsx)("h3",{children:"Invalid differences filter"}),(0,x.jsxs)("p",{children:["The ",(0,x.jsx)("i",{children:"differences"})," filter can't be parsed.",(0,x.jsx)("br",{}),(0,x.jsx)("code",{children:h})]})]}),(0,x.jsxs)("table",{children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)(m,{id:"title",title:"Document"}),(0,x.jsx)(m,{id:"popularity",title:"Popularity"}),(0,x.jsx)(m,{id:"modified",title:"Last modified"}),(0,x.jsx)(m,{id:"differences",title:"Differences"})]})}),(0,x.jsx)("tbody",{children:j.slice((a-1)*c,a*c).map((e=>(0,x.jsxs)("tr",{children:[(0,x.jsxs)("td",{children:[(0,x.jsx)("span",{className:"document-title-preview",children:d?(0,x.jsx)(I,{text:e.title,highlight:d}):e.title}),(0,x.jsx)("br",{}),(0,x.jsx)(i.rU,{to:"".concat(e.mdn_url,"#_flaws"),title:e.title,target:"_blank",children:(0,x.jsx)(L,{uri:e.mdn_url,filterURL:u})})]}),(0,x.jsxs)("td",{title:e.popularity.ranking?"Meaning there are ".concat(e.popularity.ranking-1," more popular pages than this"):"Meaning it has no ranking. Most likely a very rare (or new) document",children:[e.popularity.ranking?"".concat(T(e.popularity.ranking)):"n/a"," ",(0,x.jsxs)("small",{title:"For the parent document",children:["(",e.popularity.parentRanking?"".concat(T(e.popularity.parentRanking)):"n/a",")"]})]}),(0,x.jsx)("td",{children:(0,x.jsx)(y,{edits:e.edits})}),(0,x.jsx)("td",{children:e.differences.total.toLocaleString()})]},e.mdn_url)))})]}),p>1&&(0,x.jsxs)("p",{className:"pagination",children:[(0,x.jsx)(E,{number:1,disabled:1===a,children:"First page"})," ",a>2&&(0,x.jsxs)(E,{number:a-1,children:["Previous page (",a-1,")"]})," ",(0,x.jsxs)(E,{number:a+1,disabled:a+1>p,children:["Next page (",a+1,")"]})]})]})}function y(e){let{edits:t}=e;const n=d()(t.modified),s=d()(t.parentModified);return(0,x.jsxs)("span",{className:"last_modified ".concat(s<n?"ahead":"behind"),children:[(0,x.jsx)("a",{href:t.commitURL,target:"_blank",rel:"noreferrer",children:(0,x.jsx)("time",{dateTime:n.toISOString(),title:n.toISOString(),children:n.fromNow()})}),(0,x.jsx)("br",{}),(0,x.jsx)("a",{href:t.parentCommitURL,target:"_blank",rel:"noreferrer",children:(0,x.jsx)("small",{children:(0,x.jsxs)("time",{dateTime:s.toISOString(),title:s.toISOString(),children:["en-US ",s.fromNow()]})})})]})}function I(e){let{text:t,highlight:n}=e;const s=t.split(new RegExp("(".concat(n,")"),"gi"));return(0,x.jsxs)("span",{children:[" ",s.map(((e,t)=>(0,x.jsx)("span",{style:e.toLowerCase()===n.toLowerCase()?{fontWeight:"bold"}:{},children:e},t)))," "]})}function L(e){let{uri:t,filterURL:n}=e;const[s,r]=t.split(/\/docs\//,2);return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("span",{className:"url-prefix",children:[s,"/docs/"]}),(0,x.jsx)("span",{className:"url-slug",children:n?(0,x.jsx)(I,{text:r,highlight:n}):r})]})}function T(e){const t=["th","st","nd","rd"],n=e%100;return e.toLocaleString()+(t[(n-20)%10]||t[n]||t[0])}function E(e){let{number:t,disabled:n,children:s}=e;const[r]=(0,i.lr)(),o=(0,i.fW)(r);return t>1?o.set("page","".concat(t)):o.delete("page"),(0,x.jsx)(i.rU,{to:"?"+o.toString(),className:n?"disabled":"",onClick:e=>{n&&e.preventDefault();const t=document.querySelector("div.all-translations");t&&t.scrollIntoView({behavior:"smooth"})},children:s})}d().extend(h());const C="translations-dashboard-missing";function U(e,t){try{const n=JSON.parse(localStorage.getItem(C)||"{}");n[e]=Object.assign({},n[e]||{},t),localStorage.setItem(C,JSON.stringify(n))}catch(n){console.warn("Unable to save to localStorage",n)}}function R(){const e=(0,f.bU)(),[t]=(0,i.lr)(),n=(0,r.s0)(),[l,a]=s.useState(null);s.useEffect((()=>{"en-us"===e.toLowerCase()&&n("/".concat(e,"/_translations"))}),[e,n]),s.useEffect((()=>{let t="Missing translations";"en-us"!==e.toLowerCase()&&(t+=" for ".concat(e)),l&&(t="(".concat(l.counts.missing.toLocaleString()," found) ").concat(t)),document.title=t}),[l,e]);const{data:c,error:d,isValidating:u}=(0,o.ZP)("en-us"!==e.toLowerCase()?"/_translations/missing/?locale=".concat(e):null,(async e=>{const t=await fetch(e);if(!t.ok)throw new Error("".concat(t.status," (").concat(await t.text(),")"));if(!(t.headers.get("content-type")||"").includes("application/json"))throw new Error("Response is not JSON (".concat(t.headers.get("content-type"),")"));return t.json()}),{revalidateOnFocus:!1}),h=s.useRef();s.useEffect((()=>{if(e)if(c){if(c.counts.cacheMisses>0&&c.counts.cacheMisses===c.counts.total&&h.current){const t=(new Date).getTime()-h.current.getTime();U(e,{lastLoadTime:t})}}else h.current=new Date}),[e,c]),s.useEffect((()=>{c&&a(c)}),[c]);const m=function(e){try{const t=JSON.parse(localStorage.getItem(C)||"{}");if(t)return t[e]}catch(t){console.warn("Unable to retrieve from localStorage",t)}return null}(e),j=(null===m||void 0===m?void 0:m.defaultSort)||"popularity",p=(null===m||void 0===m?void 0:m.defaultSortReverse)||"false",g=t.get("sort")||j,v=JSON.parse(t.get("sortReverse")||p);return s.useEffect((()=>{U(e,Object.assign({},m,{defaultSort:g,defaultSortReverse:v}))}),[e,g,v,m]),"en-us"===e.toLowerCase()?null:(0,x.jsxs)(D,{children:[l&&!d&&u&&(0,x.jsx)("p",{style:{float:"right"},children:"Reloading..."}),!c&&!d&&!l&&(0,x.jsx)(O,{estimate:m&&m.lastLoadTime||3e4}),l&&(0,x.jsxs)("p",{style:{textAlign:"right"},children:["Go to"," ",(0,x.jsxs)(i.rU,{to:"/".concat(e,"/_translations/differences"),children:["Translation differences for ",(0,x.jsx)("b",{children:e})]})]}),d&&(0,x.jsx)(_,{error:d}),l&&(0,x.jsxs)("div",{className:"filter-documents",children:[(0,x.jsx)(F,{}),(0,x.jsx)(P,{counts:l.counts,documents:l.missingDocuments,sort:g,sortReverse:v})]}),c&&(0,x.jsx)(k,{times:c.times})]})}function D(e){let{children:t}=e;return(0,x.jsx)(a.Z,{className:"missing-translations",standalone:!0,children:t})}function _(e){let{error:t}=e;return(0,x.jsxs)("div",{className:"error-message search-error",children:[(0,x.jsx)("h3",{children:"Search error"}),(0,x.jsx)("pre",{children:t.toString()})]})}function k(e){let{times:t}=e;return(0,x.jsx)("div",{className:"search-times",children:(0,x.jsxs)("p",{children:["Time to find all documents ",function(e){if(e>1e3){return"".concat((e/1e3).toFixed(1)," seconds")}return"".concat(Math.trunc(e)," milliseconds")}(t.took)]})})}function O(e){let{estimate:t}=e;const n=new Date,[r]=s.useState(new Date(n.getTime()+t)),[,i]=s.useState(0);s.useEffect((()=>{const e=setInterval((()=>{i((e=>e+1))}),1e3);return()=>clearInterval(e)}),[]);const o=r.getTime()-n.getTime(),l=(new Date).getTime()-n.getTime(),a=100*l/o;return(0,x.jsxs)("div",{className:"loading",children:[(0,x.jsxs)("progress",{id:"progress",max:"100",value:a,style:{margin:20},children:[a,"%"]}),(0,x.jsx)("br",{}),(0,x.jsxs)("small",{children:["Estimated time to finish: ",((o-l)/1e3).toFixed(0),"s"," ",l>o?(0,x.jsx)("span",{"aria-label":"weird",role:"img",children:"\ud83d\ude43"}):null]})]})}function F(){const[e,t]=(0,i.lr)(),[n,r]=s.useState(e.get("title")||""),[o,l]=s.useState(e.get("url")||"");function a(){let s=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const r=(0,i.fW)(e);for(const[e,t]of[["url",o],["title",n]])!s&&t?r.set(e,t):r.delete(e);r.delete("page"),t(r)}return(0,x.jsxs)("div",{className:"filters",children:[(0,x.jsx)("h3",{children:"Filters"}),(0,x.jsxs)("form",{onSubmit:e=>{e.preventDefault(),a()},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("h4",{children:"Document"}),(0,x.jsx)("input",{type:"search",placeholder:"Filter by document URI",value:o,onChange:e=>{l(e.target.value)},onBlur:()=>a()}),(0,x.jsx)("input",{type:"search",placeholder:"Filter by document title",value:n,onChange:e=>{r(e.target.value)},onBlur:()=>a()})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("h4",{children:"\xa0"}),(0,x.jsx)("button",{type:"submit",children:"Filter now"})," ",(o||n)&&(0,x.jsx)("button",{type:"button",onClick:function(){l(""),r(""),a(!0)},children:"Reset filters"})]})]})]})}function P(e){let{counts:t,documents:n,sort:s,sortReverse:r}=e;const[o,l]=(0,i.lr)(),a=parseInt(o.get("page")||"1",10),c=parseInt(o.get("pageSize")||"20",10),d=o.get("title")||"",u=o.get("url")||"",h=function(e){function t(e){if(!e)throw new Error("Can't be empty");const t=parseInt(e,10);if(isNaN(t))throw new Error("'".concat(e,"' not a valid number"));return t}try{return e.startsWith(">=")?{operation:"gte",value:t(e.replace(">=",""))}:e.startsWith(">")?{operation:"gt",value:t(e.replace(">",""))}:e.startsWith("<=")?{operation:"lte",value:t(e.replace("<=",""))}:e.startsWith("<")?{operation:"lt",value:t(e.replace("<",""))}:e.startsWith("==")||e.startsWith("=")?{operation:"eq",value:t(e.replace(/=/g,""))}:e?{operation:"eq",value:t(e)}:null}catch(n){return console.warn(n),null}}(o.get("differences")||"");function f(e){let{id:t,title:n}=e;return(0,x.jsx)("th",{onClick:()=>{l(s===t?(0,i.fW)({sort:t,sortReverse:JSON.stringify(!r)}):(0,i.fW)({sort:t}))},className:"sortable ".concat(s===t?"active":""," ").concat(s===t&&r?"reverse":""),children:n})}const m=n.filter((e=>!(d&&!e.title.toLowerCase().includes(d.toLowerCase()))&&(!(u&&!e.mdn_url.toLowerCase().includes(u.toLowerCase()))&&!(h&&!function(e,t){if("eq"===t.operation){if(e!==t.value)return!1}else if("gt"===t.operation){if(!(e>t.value))return!1}else if("gte"===t.operation){if(!(e>=t.value))return!1}else if("lt"===t.operation){if(!(e<t.value))return!1}else{if("lte"!==t.operation)throw new Error("Not implemented operation '".concat(t.operation,"'"));if(!(e<=t.value))return!1}return!0}(e.differences.total,h))))).sort(((e,t)=>{let n=r?-1:1;if("modified"===s){const s=new Date(e.edits.modified);return n*(new Date(t.edits.modified).getTime()-s.getTime())}if("popularity"===s){const s=e.popularity.value;return n*(t.popularity.value-s)}if("differences"===s){const s=e.differences.total;return n*(t.differences.total-s)}if("title"===s){const s=e.title,r=t.title;return n*s.localeCompare(r)}if("mdn_url"===s){const s=e.mdn_url,r=t.mdn_url;return n*s.localeCompare(r)}throw new Error("Unrecognized sort '".concat(s,"'"))})),j=Math.ceil(t.total/c);return(0,x.jsxs)("div",{className:"documents",children:[(0,x.jsxs)("h3",{children:[t.missing.toLocaleString()," missing translations (of"," ",t.total.toLocaleString()," possible)"]}),(0,x.jsxs)("table",{children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)(f,{id:"title",title:"Document"}),(0,x.jsx)(f,{id:"popularity",title:"Popularity"}),(0,x.jsx)(f,{id:"modified",title:"Last modified"})]})}),(0,x.jsx)("tbody",{children:m.slice((a-1)*c,a*c).map((e=>(0,x.jsxs)("tr",{children:[(0,x.jsxs)("td",{children:[(0,x.jsx)("span",{className:"document-title-preview",children:d?(0,x.jsx)(W,{text:e.title,highlight:d}):e.title}),(0,x.jsx)("br",{}),(0,x.jsx)(i.rU,{to:"".concat(e.mdn_url,"#_flaws"),title:e.title,target:"_blank",children:(0,x.jsx)(J,{uri:e.mdn_url,filterURL:u})})]}),(0,x.jsxs)("td",{title:e.popularity.ranking?"Meaning there are ".concat(e.popularity.ranking-1," more popular pages than this"):"Meaning it has no ranking. Most likely a very rare (or new) document",children:[e.popularity.ranking?"".concat(K(e.popularity.ranking)):"n/a"," "]}),(0,x.jsx)("td",{children:(0,x.jsx)(M,{edits:e.edits})})]},e.mdn_url)))})]}),j>1&&(0,x.jsxs)("p",{className:"pagination",children:[(0,x.jsx)(V,{number:1,disabled:1===a,children:"First page"})," ",a>2&&(0,x.jsxs)(V,{number:a-1,children:["Previous page (",a-1,")"]})," ",(0,x.jsxs)(V,{number:a+1,disabled:a+1>j,children:["Next page (",a+1,")"]})]})]})}function M(e){let{edits:t}=e;const n=d()(t.modified);return(0,x.jsx)("span",{className:"last_modified",children:(0,x.jsx)("a",{href:t.commitURL,target:"_blank",rel:"noreferrer",children:(0,x.jsx)("time",{dateTime:n.toISOString(),title:n.toISOString(),children:n.fromNow()})})})}function W(e){let{text:t,highlight:n}=e;const s=t.split(new RegExp("(".concat(n,")"),"gi"));return(0,x.jsxs)("span",{children:[" ",s.map(((e,t)=>(0,x.jsx)("span",{style:e.toLowerCase()===n.toLowerCase()?{fontWeight:"bold"}:{},children:e},t)))," "]})}function J(e){let{uri:t,filterURL:n}=e;const[s,r]=t.split(/\/docs\//,2);return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("span",{className:"url-prefix",children:[s,"/docs/"]}),(0,x.jsx)("span",{className:"url-slug",children:n?(0,x.jsx)(W,{text:r,highlight:n}):r})]})}function K(e){const t=["th","st","nd","rd"],n=e%100;return e.toLocaleString()+(t[(n-20)%10]||t[n]||t[0])}function V(e){let{number:t,disabled:n,children:s}=e;const[r]=(0,i.lr)(),o=(0,i.fW)(r);return t>1?o.set("page","".concat(t)):o.delete("page"),(0,x.jsx)(i.rU,{to:"?"+o.toString(),className:n?"disabled":"",onClick:e=>{n&&e.preventDefault();const t=document.querySelector("div.all-translations");t&&t.scrollIntoView({behavior:"smooth"})},children:s})}const z="translations-dashboard-sections";function A(){const e=(0,f.bU)(),[t]=(0,i.lr)(),n=(0,r.s0)(),[l,a]=s.useState(null),c=t.get("section")||"";s.useEffect((()=>{"en-us"===e.toLowerCase()&&n("/".concat(e,"/_translations"))}),[e,n]),s.useEffect((()=>{let t="Translation dashboard ";"en-us"!==e.toLowerCase()&&(t+=" for ".concat(e)),""!==c&&(t+=" - section ".concat(c)),document.title=t}),[l,e,c]);let{data:d,error:u,isValidating:h}=(0,o.ZP)("en-us"!==e.toLowerCase()?"/_translations/dashboard/?locale=".concat(e,"&section=").concat(c):null,(async e=>{const t=await fetch(e);if(!t.ok)throw new Error("".concat(t.status," (").concat(await t.text(),")"));if(!(t.headers.get("content-type")||"").includes("application/json"))throw new Error("Response is not JSON (".concat(t.headers.get("content-type"),")"));return t.json()}),{revalidateOnFocus:!1});s.useEffect((()=>{d&&a(d)}),[d]);const m=function(e){try{const t=JSON.parse(localStorage.getItem(z)||"{}");if(t)return t[e]}catch(t){console.warn("Unable to retrieve from localStorage",t)}return null}(e),j=(null===m||void 0===m?void 0:m.defaultSort)||"url",p=(null===m||void 0===m?void 0:m.defaultSortReverse)||"false",g=t.get("sort")||j,v=JSON.parse(t.get("sortReverse")||p);if(s.useEffect((()=>{!function(e,t){try{const n=JSON.parse(localStorage.getItem(z)||"{}");n[e]=Object.assign({},n[e]||{},t),localStorage.setItem(z,JSON.stringify(n))}catch(n){console.warn("Unable to save to localStorage",n)}}(e,Object.assign({},m,{defaultSort:g,defaultSortReverse:v}))}),[e,g,v,m]),"en-us"===e.toLowerCase())return null;let b="/";if(c.split("/").length>2){const e=c.split("/");e.pop(),b=e.join("/")}return(0,x.jsxs)(G,{children:[l&&!u&&h&&(0,x.jsx)("p",{style:{float:"right"},children:"Reloading..."}),!d&&!u&&!l&&(0,x.jsx)(q,{}),l&&(0,x.jsxs)("p",{style:{textAlign:"right"},children:["Go to"," ",(0,x.jsxs)(i.rU,{to:"/".concat(e,"/_translations/differences"),children:["Translation differences for ",(0,x.jsx)("b",{children:e})]})," / ",(0,x.jsxs)(i.rU,{to:"/".concat(e,"/_translations/missing"),children:["Missing translations for ",(0,x.jsx)("b",{children:e})]})]}),u&&(0,x.jsx)(Z,{error:u}),l&&(0,x.jsxs)("div",{className:"filter-documents",children:[(0,x.jsx)(Y,{l10nKPIs:l.l10nKPIs,section:c,parentSection:b}),(0,x.jsx)(H,{sections:l.sections,currentSection:c}),(0,x.jsx)(B,{documents:l.detailDocuments,sort:g,sortReverse:v,locale:e})]})]})}function G(e){let{children:t}=e;return(0,x.jsx)("div",{className:"dashboard-section-translations",children:(0,x.jsx)(a.Z,{standalone:!0,children:t})})}function Z(e){let{error:t}=e;return(0,x.jsxs)("div",{className:"error-message",children:[(0,x.jsx)("h3",{children:"Error"}),(0,x.jsx)("pre",{children:t.toString()})]})}function q(){return(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{htmlFor:"progress",children:"Loading"}),(0,x.jsx)("progress",{id:"progress",max:"100",style:{margin:20}})]})}function Y(e){let{l10nKPIs:t,section:n,parentSection:s}=e;const r=100*(t.total-t.missing)/t.total,i=r.toFixed(1)+"%",o=100*t.upToDate/t.total,l=o.toFixed(1)+"%";return(0,x.jsxs)("div",{className:"documents",children:[(0,x.jsxs)("h2",{children:["Localization dashboard for: ",n||"/"]}),(0,x.jsxs)("p",{children:["Parent section:"," ",(0,x.jsx)("a",{href:"dashboard?section=".concat(s),children:s})]}),(0,x.jsx)("h3",{children:"Summary"}),(0,x.jsxs)("dl",{children:[(0,x.jsx)("dt",{children:"Total number of pages"}),(0,x.jsx)("dd",{children:t.total}),(0,x.jsx)("dt",{children:"Number of untranslated pages"}),(0,x.jsx)("dd",{children:t.missing}),(0,x.jsx)("dt",{children:"Number of outdated pages (older than English in Git) "}),(0,x.jsx)("dd",{children:t.outOfDate}),(0,x.jsx)("dt",{children:"Number of up-to-date pages"}),(0,x.jsx)("dd",{children:t.upToDate}),(0,x.jsx)("dt",{children:(0,x.jsx)("label",{htmlFor:"completeness",children:"Localization completeness"})}),(0,x.jsxs)("dd",{children:[(0,x.jsx)("progress",{id:"completeness",max:"100",value:r,children:i})," ",i]}),(0,x.jsx)("dt",{children:(0,x.jsx)("label",{htmlFor:"freshness",children:"Localization freshness"})}),(0,x.jsxs)("dd",{children:[(0,x.jsx)("progress",{id:"freshness",max:"100",value:o,children:l})," ",l]})]})]})}function H(e){let{sections:t,currentSection:n}=e;return t.length>0?(0,x.jsxs)("section",{id:"subsection-table",children:[(0,x.jsx)("h3",{children:"Subsections"}),(0,x.jsxs)("table",{children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Section"}),(0,x.jsx)("th",{children:"Total / Untranslated / Out of date"}),(0,x.jsx)("th",{children:"Completeness"}),(0,x.jsx)("th",{children:"Freshness"})]})}),(0,x.jsx)("tbody",{children:t.sort(((e,t)=>t.l10nKPIs.total-e.l10nKPIs.total)).map((e=>{const t=100*(e.l10nKPIs.total-e.l10nKPIs.missing)/e.l10nKPIs.total,s=t.toFixed(1)+"%",r=100*e.l10nKPIs.upToDate/e.l10nKPIs.total,i=r.toFixed(1)+"%",o="dashboard?section=%2F"+encodeURIComponent(e.name);return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:(0,x.jsx)("a",{href:o,children:e.name.replace(n.slice(1),"").replace("/","")})}),(0,x.jsxs)("td",{children:[e.l10nKPIs.total," / ",e.l10nKPIs.missing," /"," ",e.l10nKPIs.outOfDate]}),(0,x.jsxs)("td",{children:[(0,x.jsx)("progress",{max:"100",value:t,children:s})," ",s]}),(0,x.jsxs)("td",{children:[(0,x.jsx)("progress",{max:"100",value:r,children:i})," ",i]})]},e.name)}))})]})]}):null}function B(e){let{documents:t,sort:n,sortReverse:s,locale:r}=e;const[o,l]=(0,i.lr)(),a=o.get("section")||"";function c(e){let{id:t,title:r}=e;return(0,x.jsx)("th",{onClick:()=>{l(n===t?(0,i.fW)({sort:t,sortReverse:JSON.stringify(!s),section:a}):(0,i.fW)({sort:t,section:a}))},className:"sortable ".concat(n===t?"active":""," ").concat(n===t&&s?"reverse":""),children:r})}return t.map((e=>{if(e.info.localeInfo){const t=new Date(e.info.localeInfo.modified),n=new Date(e.info.defaultLocaleInfo.modified),s=t.getTime()-n.getTime();e.info.dateDiff=s}else e.info.dateDiff=Number.POSITIVE_INFINITY;return e})),(0,x.jsxs)("section",{id:"documents-table",children:[(0,x.jsx)("h3",{children:"List of direct subpages"}),(0,x.jsxs)("table",{children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)(c,{id:"url",title:"Slug"}),(0,x.jsx)(c,{id:"enMDNURL",title:"English doc on MDN"}),(0,x.jsx)(c,{id:"enCommitGHURL",title:"English doc commit on GitHub"}),(0,x.jsx)(c,{id:"localURL",title:"Local localized doc"}),(0,x.jsx)(c,{id:"localMDNURL",title:"Localized doc on MDN"}),(0,x.jsx)(c,{id:"localCommitGHURL",title:"Localized doc commit on GitHub"}),(0,x.jsx)(c,{id:"popularityEn",title:"Popularity rank (en-US)"}),(0,x.jsx)(c,{id:"popularityLocale",title:"Popularity rank (".concat(r,")")}),(0,x.jsx)(c,{id:"dateDiff",title:"Date delta"})]})}),(0,x.jsx)("tbody",{children:t.sort(((e,t)=>{let r=s?-1:1;if("dateDiff"===n){const n=e.info.dateDiff||Number.POSITIVE_INFINITY;return r*((t.info.dateDiff||Number.POSITIVE_INFINITY)-n)}if("popularityLocale"===n){var i,o;return r*(((null===(i=e.info.localePopularity)||void 0===i?void 0:i.ranking)||Number.POSITIVE_INFINITY)-((null===(o=t.info.localePopularity)||void 0===o?void 0:o.ranking)||Number.POSITIVE_INFINITY))}if("popularityEn"===n){return r*((e.info.popularity.ranking||Number.POSITIVE_INFINITY)-(t.info.popularity.ranking||Number.POSITIVE_INFINITY))}if("url"===n){const n=e.url,s=t.url;return r*n.localeCompare(s)}throw new Error("Unrecognized sort '".concat(n,"'"))})).map((e=>{var t;const n="https://developer.mozilla.org"+e.url,s=e.info.defaultLocaleInfo.commitURL.split("commit/")[1].substring(0,7),i=null===(t=e.info.localeInfo)||void 0===t?void 0:t.commitURL.split("commit/")[1].substring(0,7);let o="Untranslated";if(e.info.localeInfo){var l;let t=null!==(l=e.info.dateDiff)&&void 0!==l?l:Number.POSITIVE_INFINITY;if(o="Out of date",t>0)o="Fresher than English";else if(t>-26784e5){const e=Math.round(-t/864e5);o=e+" day"+(e>1?"s":"")}else{const e=Math.round(-t/2592e6);o=e+" month"+(e>1?"s":"")}}return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:(0,x.jsx)("a",{href:e.url,children:e.url})}),(0,x.jsx)("td",{children:(0,x.jsx)("a",{href:n,children:"English current MDN page"})}),(0,x.jsx)("td",{children:(0,x.jsxs)("a",{href:e.info.defaultLocaleInfo.commitURL,children:["GitHub link for ",(0,x.jsx)("code",{children:s})]})}),(0,x.jsx)("td",{children:e.info.localeInfo&&(0,x.jsxs)("a",{href:e.url.replace("/en-US/","/"+r+"/"),children:["Local ",r," page"]})}),(0,x.jsx)("td",{children:e.info.localeInfo&&(0,x.jsx)("a",{href:n.replace("/en-US/","/"+r+"/"),children:"Locale current MDN page"})}),(0,x.jsx)("td",{children:e.info.localeInfo&&(0,x.jsxs)("a",{href:e.info.localeInfo.commitURL,children:["GitHub link for ",(0,x.jsx)("code",{children:i})]})}),(0,x.jsx)("td",{children:e.info.popularity.ranking}),(0,x.jsx)("td",{children:e.info.localePopularity&&e.info.localePopularity.ranking}),(0,x.jsx)("td",{children:o})]},e.url)}))})]})]})}function Q(){return(0,x.jsx)($,{children:(0,x.jsxs)(r.Z5,{children:[(0,x.jsx)(r.AW,{path:"/",element:(0,x.jsx)(X,{})}),(0,x.jsx)(r.AW,{path:"differences",element:(0,x.jsx)(p,{})}),(0,x.jsx)(r.AW,{path:"missing",element:(0,x.jsx)(R,{})}),(0,x.jsx)(r.AW,{path:"dashboard",element:(0,x.jsx)(A,{})})]})})}function X(){const e=(0,f.bU)();s.useEffect((()=>{let t="All translations";"en-us"!==e.toLowerCase()&&(t+=" for ".concat(e)),document.title=t}),[e]);const{data:t,error:n}=(0,o.ZP)("en-us"===e.toLowerCase()?"/_translations/":null,(async e=>{const t=await fetch(e);if(!t.ok)throw new Error("".concat(t.status," (").concat(await t.text(),")"));return t.json()}));return"en-us"===e.toLowerCase()?(0,x.jsxs)(x.Fragment,{children:[!t&&!n&&(0,x.jsx)(l.g,{}),n&&(0,x.jsxs)("div",{className:"error-message",children:[(0,x.jsx)("h3",{children:"Server error"}),(0,x.jsx)("pre",{children:n.toString()})]}),t&&(0,x.jsx)(ee,{locales:t.locales})]}):(0,x.jsxs)("div",{className:"translation-choices",children:[(0,x.jsx)(i.rU,{to:"/".concat(e,"/_translations/differences"),className:"button",children:"Translation differences"})," ",(0,x.jsx)(i.rU,{to:"/".concat(e,"/_translations/missing"),className:"button",children:"Missing translations"})," ",(0,x.jsx)(i.rU,{to:"/".concat(e,"/_translations/dashboard"),className:"button",children:"Dashboard"})]})}function $(e){let{children:t}=e;return(0,x.jsx)(a.Z,{className:"all-translations",standalone:!0,children:t})}function ee(e){let{locales:t}=e;return(0,x.jsxs)("div",{children:[(0,x.jsx)("h2",{children:"Select locale"}),(0,x.jsx)("table",{children:(0,x.jsx)("tbody",{children:t.map((e=>(0,x.jsxs)("tr",{children:[(0,x.jsxs)("td",{children:[(0,x.jsxs)("b",{children:[e.language.English," (",e.locale,")"]})," ",!e.isActive&&(0,x.jsx)("small",{children:"not active"})]}),(0,x.jsxs)("td",{children:[e.count.toLocaleString()," documents"]}),(0,x.jsxs)("td",{children:[(0,x.jsx)(i.rU,{to:"/".concat(e.locale,"/_translations/differences"),children:"Translation differences"})," "]}),(0,x.jsxs)("td",{children:[(0,x.jsx)(i.rU,{to:"/".concat(e.locale,"/_translations/missing"),children:"Missing translations"})," "]}),(0,x.jsxs)("td",{children:[(0,x.jsx)(i.rU,{to:"/".concat(e.locale,"/_translations/dashboard"),children:"Dashboard"})," "]})]},e.locale)))})})]})}}}]);
//# sourceMappingURL=768.982e1ef1.chunk.js.map