"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[606],{606:(e,n,t)=>{t.r(n),t.d(n,{default:()=>$});var r=t(6167),s=t(5523),l=t(2437),a=t(1381),o=t(9348),c=t(2427),i=t(2221),d=t(778),u=t(358),v=t(6986),h=t(175),p=t(8591),f=t(9520),g=t(5049),m=t(7800),j=t(5902),x=t(6848),y=t(7318),w=t(9301),C=t(7690),k=t(91),b=t(7878);function S(e){switch(e){case"javascript":return[(0,x.eJ)()];case"html":return[(0,w.dy)()];case"css":return[(0,y.iv)()];default:return[]}}function N(e,n){return[j.w9,(0,v.Eu)(),(0,p.nY)(),(0,p.n$)(),(0,g.vQ)(),(0,g.ys)(),(0,v.ZO)(),v.$f.of([...g.GA,...f.wQ,...g.B1,...m.Fv,f.oc]),v.tk.lineWrapping,..."dark"===e?[C.vk]:[],...S(n)]}self.MonacoEnvironment={getWorkerUrl:function(e,n){return"json"===n?"./json.worker.js":"css"===n||"scss"===n||"less"===n?"./css.worker.js":"html"===n||"handlebars"===n||"razor"===n?"./html.worker.js":"typescript"===n||"javascript"===n?"./ts.worker.js":"./editor.worker.js"}};const R=(0,r.forwardRef)((function(e,n){let{language:t,callback:s=(()=>{})}=e;const{colorScheme:l}=(0,k.QR)(),a=(0,r.useRef)(null),o=(0,r.useRef)(null);let c=(0,r.useRef)(null);const i=(0,r.useRef)(v.tk.updateListener.of((e=>{var n;e.docChanged&&(null!==a.current&&-1!==a.current&&clearTimeout(a.current),a.current=null===(n=window)||void 0===n?void 0:n.setTimeout((()=>{a.current=-1,s()}),1e3))})));return(0,r.useEffect)((()=>{const e=[...N(l,t),i.current];if(o.current&&null===c.current){let n=h.yy.create({extensions:e});c.current=new v.tk({state:n,parent:o.current})}else{var n;null===(n=c.current)||void 0===n||n.dispatch({effects:h.Py.reconfigure.of(e)})}return()=>{}}),[t,l]),(0,r.useImperativeHandle)(n,(()=>({getContent(){var e;return null===(e=c.current)||void 0===e?void 0:e.state.doc.toString()},setContent(e){var n;let r=h.yy.create({doc:e,extensions:[...N(l,t),i.current]});null===(n=c.current)||void 0===n||n.setState(r)}})),[t,l]),(0,b.jsxs)("details",{className:"editor-container",open:!0,children:[(0,b.jsx)("summary",{children:t.toUpperCase()}),(0,b.jsx)("div",{className:"editor",ref:o})]})})),P=R;var E=t(722),U=t(1615),T=t(5965),Z=t(7557),z=t(6441),I=t(3493),H=t(7579),L=t(119);function O(e){let{gistId:n}=e;return(0,b.jsxs)("form",{className:"flag",children:[(0,b.jsx)("span",{children:"Report this malicious or inappropriate shared playground. Can you please share some details on what's wrong with this content:"}),(0,b.jsx)("textarea",{id:"flagReason"}),(0,b.jsxs)("div",{className:"buttons",children:[(0,b.jsx)(u.z,{id:"flag-cancel",value:"cancel",type:"secondary",buttonType:"submit",formMethod:"dialog",children:"Cancel"}),(0,b.jsx)(u.z,{id:"flag-send",onClickHandler:async e=>{var t,r;e.preventDefault(),await fetch("/api/v1/play/flag",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:n,reason:document.getElementById("flagReason").value})}),null===(t=document.getElementById("flag-send"))||void 0===t||null===(r=t.closest("dialog"))||void 0===r||r.close()},value:"default",children:"Report"})]})]})}function M(e){let{url:n,share:t,code:s}=e,l=(0,z.v$)();const a=(0,I.dY)();let[o,c]=(0,r.useState)(!1);return(0,b.jsxs)("form",{className:"share",children:[(0,b.jsx)(u.z,{id:"share-cancel",title:"Cancel",extraClasses:"action",value:"cancel",icon:"cancel",buttonType:"submit",formMethod:"dialog"}),(0,b.jsxs)("section",{children:[(0,b.jsx)("span",{children:"Share Markdown"}),(0,b.jsx)(u.z,{type:"secondary",onClickHandler:async()=>{a("".concat(H.N1,": share-markdown")),s&&await navigator.clipboard.writeText((0,U.LY)(s()))},children:"Copy markdown to clipboard"})]}),(0,b.jsxs)("section",{id:"share-link",children:[(0,b.jsx)("span",{children:"Share your code via Permalink"}),null!==l&&void 0!==l&&l.isAuthenticated?(0,b.jsx)(b.Fragment,{children:n?o?(0,b.jsx)(Z.g,{}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("input",{value:n.toString()}),(0,b.jsx)(u.z,{type:"secondary",onClickHandler:async()=>{n&&await navigator.clipboard.writeText(n.toString())},children:"Copy to clipboard"})]}):(0,b.jsx)(u.z,{onClickHandler:async()=>{c(!0),a("".concat(H.N1,": share-permalink")),await(null===t||void 0===t?void 0:t()),c(!1)},children:"Create link"})}):(0,b.jsxs)(L.U,{className:"share-get-plus",gleanPrefix:H.N1,children:["Want to share this playground via link?",(0,b.jsx)("br",{})]})]})]})}function Y(e){let{vConsole:n}=e;const t=(0,r.useRef)(null);return(0,r.useEffect)((()=>{(()=>{var e,n;null===(e=t.current)||void 0===e||e.scrollTo({top:null===(n=t.current)||void 0===n?void 0:n.scrollHeight})})()}),[n]),(0,b.jsxs)("div",{id:"play-console",children:[(0,b.jsx)("span",{children:"Console"}),(0,b.jsx)("ul",{ref:t,children:n.map(((e,n)=>{let{prop:t,message:r}=e;return(0,b.jsx)("li",{children:(0,b.jsx)("code",{children:r})},n)}))})]})}const D="",J="",B="";var W=function(e){return e[e.initial=0]="initial",e[e.ready=1]="ready",e[e.remote=2]="remote",e}(W||{}),F=function(e){return e[e.none=0]="none",e[e.share=1]="share",e[e.flag=2]="flag",e}(F||{});function G(e,n){sessionStorage.setItem(e,JSON.stringify(n))}function Q(e){let n=JSON.parse(sessionStorage.getItem(e)||"{}");return{html:(null===n||void 0===n?void 0:n.html)||D,css:(null===n||void 0===n?void 0:n.css)||J,js:(null===n||void 0===n?void 0:n.js)||B,src:null===n||void 0===n?void 0:n.src}}function $(){const e=(0,I.dY)();let[n,t]=(0,s.lr)();const v=n.get("id");let[h,p]=(0,r.useState)(F.none),[f,g]=(0,r.useState)(!1),[m,j]=(0,r.useState)(null),[x,y]=(0,r.useState)([]),[w,C]=(0,r.useState)(W.initial),[k,S]=(0,r.useState)();const N=(0,r.useRef)(crypto.randomUUID());let{data:R}=(0,l.Z)(!f&&v?"/api/v1/play/".concat(encodeURIComponent(v)):null,(async n=>{const t=await fetch(n);if(!t.ok)throw Error(t.statusText);e("".concat(H.N1,": load-shared"));const r=await t.json();return r?(C(W.remote),r):null}),{fallbackData:!v&&w===W.initial&&Q(U.Y5)||void 0});const Z=(0,r.useRef)(null),z=(0,r.useRef)(null),L=(0,r.useRef)(null),$=(0,r.useRef)(null),A=(0,r.useRef)(null);(0,r.useEffect)((()=>{R&&G(U.Y5,R)}),[R]);const _=(0,r.useCallback)((()=>{var e,n,t;const r={html:(null===(e=Z.current)||void 0===e?void 0:e.getContent())||D,css:(null===(n=z.current)||void 0===n?void 0:n.getContent())||J,js:(null===(t=L.current)||void 0===t?void 0:t.getContent())||B,src:null===R||void 0===R?void 0:R.src};return G(U.Y5,r),r}),[null===R||void 0===R?void 0:R.src]);let q=(0,r.useCallback)((e=>{let{data:{typ:n,prop:t,message:r}}=e;"console"===n?y("clear"===t?[]:e=>[...e,{prop:t,message:r}]):"ready"===n&&(0,U._L)($.current,_())}),[_]);(0,r.useEffect)((()=>{if(w===W.initial||w===W.remote){var e,n,t,r,s,l;if(R&&Object.values(R).some(Boolean))null===(e=Z.current)||void 0===e||e.setContent(null===R||void 0===R?void 0:R.html),null===(n=z.current)||void 0===n||n.setContent(null===R||void 0===R?void 0:R.css),null===(t=L.current)||void 0===t||t.setContent(null===R||void 0===R?void 0:R.js),R.src&&S((null===R||void 0===R?void 0:R.src)&&"".concat(R.src.split("/").slice(0,-1).join("/")));else null===(r=Z.current)||void 0===r||r.setContent(D),null===(s=z.current)||void 0===s||s.setContent(J),null===(l=L.current)||void 0===l||l.setContent(B);C(W.ready)}}),[R,w]),(0,r.useEffect)((()=>(window.addEventListener("message",q),()=>{window.removeEventListener("message",q)})),[q]);const K=()=>{var e,n,t,r;null===(e=document.getElementById("run"))||void 0===e||null===(n=e.firstElementChild)||void 0===n||n.animate([{},{backgroundColor:"var(--background-mark-green)"},{}],{duration:1e3,iterations:1}),null===(t=$.current)||void 0===t||null===(r=t.contentWindow)||void 0===r||r.postMessage({typ:"reload"},{targetOrigin:"*"})},V=(0,r.useCallback)((async()=>{const{url:e,id:n}=await async function(e){const n=await fetch("/api/v1/play/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});let{id:t}=await n.json(),r=new URL(document.URL);return r.search=new URLSearchParams([["id",t]]).toString(),{url:r,id:t}}(_());t([["id",n]],{replace:!0}),g(!0),j(e)}),[t,j,g,_]),X=new URL("".concat(window.location.protocol,"//").concat(T.vP.startsWith("localhost")?"":"".concat(N.current,".")).concat(T.vP));X.pathname="".concat(k||"","/runner.html");return(0,b.jsx)(b.Fragment,{children:(0,b.jsxs)("main",{className:"play container",children:[(0,b.jsxs)("dialog",{id:"playDialog",ref:A,onClose:()=>{h===F.share&&j(null)},children:[h===F.flag&&(0,b.jsx)(O,{gistId:v}),h===F.share&&(0,b.jsx)(M,{url:m,code:_,share:V})]}),(0,b.jsxs)("section",{className:"editors",children:[(0,b.jsxs)("aside",{children:[(0,b.jsx)("h1",{children:"Playground"}),(0,b.jsxs)("menu",{children:[(0,b.jsx)(u.z,{type:"secondary",id:"format",onClickHandler:async()=>{const{html:e,css:n,js:t}=_();try{var r,s,l;const u={html:await a.ZP.format(e,{parser:"html",plugins:[d.ZP,c.ZP,o.Z,i.ZP]}),css:await a.ZP.format(n,{parser:"css",plugins:[c.ZP]}),js:await a.ZP.format(t,{parser:"babel",plugins:[o.Z,i.ZP]})};null===(r=Z.current)||void 0===r||r.setContent(u.html),null===(s=z.current)||void 0===s||s.setContent(u.css),null===(l=L.current)||void 0===l||l.setContent(u.js)}catch(u){console.error(u)}},children:"format"}),(0,b.jsx)(u.z,{type:"secondary",id:"run",onClickHandler:K,children:"run"}),(0,b.jsx)(u.z,{type:"secondary",id:"share",onClickHandler:()=>{var n;e("".concat(H.N1,": share-click")),p(F.share),null===(n=A.current)||void 0===n||n.showModal()},children:"share"}),(0,b.jsx)(u.z,{type:"secondary",id:"reset",extraClasses:"red",onClickHandler:async()=>{window.confirm("Do you really want to reset everything?")&&(e("".concat(H.N1,": reset-click")),await(async()=>{var e,n,r;t([],{replace:!0}),S(void 0),null===(e=Z.current)||void 0===e||e.setContent(D),null===(n=z.current)||void 0===n||n.setContent(J),null===(r=L.current)||void 0===r||r.setContent(B),K()})())},children:"reset"})]})]}),(0,b.jsx)(P,{ref:Z,language:"html",callback:K}),(0,b.jsx)(P,{ref:z,language:"css",callback:K}),(0,b.jsx)(P,{ref:L,language:"javascript",callback:K})]}),(0,b.jsxs)("section",{className:"preview",children:[v&&(0,b.jsx)("button",{className:"flag-example",onClick:n=>{var t;n.preventDefault(),e("".concat(H.N1,": flag-click")),p(F.flag),null===(t=A.current)||void 0===t||t.showModal()},children:"Seeing something inappropriate?"}),(0,b.jsx)("iframe",{title:"runner",ref:$,src:X.toString(),sandbox:"allow-scripts allow-same-origin"}),(0,b.jsx)(Y,{vConsole:x}),(0,b.jsx)(E.Pk,{})]})]})})}},119:(e,n,t)=>{t.d(n,{U:()=>o});var r=t(3493),s=t(8229),l=t(6509),a=t(7878);function o(e){let{children:n,className:t="login-banner",gleanPrefix:o}=e;const c=(0,l.J)(),i=(0,r.dY)();return(0,a.jsxs)("div",{className:t,children:[(0,a.jsxs)("span",{children:[(0,a.jsx)("span",{children:n})," ",(0,a.jsxs)("strong",{children:["Upgrade to"," ",(0,a.jsx)("a",{className:"plus-link",href:c,onClick:()=>i("".concat(o,": banner-link")),children:"MDN Plus"})," ","for free."]})]}),(0,a.jsx)(s.P,{logInGleanContext:"".concat(o,": banner-login"),signUpGleanContext:"".concat(o,": banner-signup")})]})}}}]);
//# sourceMappingURL=606.3eb6d98d.chunk.js.map