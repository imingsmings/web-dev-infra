{"doc":{"isMarkdown":true,"isTranslated":false,"isActive":true,"flaws":{},"title":"Author list page and Genre list page challenge","mdn_url":"/en-US/docs/Learn/Server-side/Express_Nodejs/Displaying_data/Author_list_page","locale":"en-US","native":"English (US)","sidebarHTML":"","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p>The author list page needs to display a list of all authors in the database, with each author name linked to its associated author detail page. The date of birth and date of death should be listed after the name on the same line.</p>"}},{"type":"prose","value":{"id":"controller","title":"Controller","isH3":false,"content":"<p>The author list controller function needs to get a list of all <code>Author</code> instances, and then pass these to the template for rendering.</p>\n<p>Open <strong>/controllers/authorController.js</strong>. Find the exported <code>author_list()</code> controller method near the top of the file and replace it with the following code.</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// Display list of all Authors.</span>\nexports<span class=\"token punctuation\">.</span>author_list <span class=\"token operator\">=</span> <span class=\"token function\">asyncHandler</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res<span class=\"token punctuation\">,</span> next</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> allAuthors <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> Author<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">sort</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">family_name</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">exec</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  res<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"author_list\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">title</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Author List\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">author_list</span><span class=\"token operator\">:</span> allAuthors<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>\n  The route controller function follows the same pattern as for the other list pages.\n  It defines a query on the <code>Author</code> model, using the <code>find()</code> function to get all authors, and the <code>sort()</code> method to sort them by <code>family_name</code> in alphabetic order.\n  <code>exec()</code> is daisy-chained on the end in order to execute the query and return a promise that the function can <code>await</code>.\n</p>\n<p>Once the promise is fulfilled the route handler renders the <strong>author_list</strong>(.pug) template, passing the page <code>title</code> and the list of authors (<code>allAuthors</code>) using template keys.</p>"}},{"type":"prose","value":{"id":"view","title":"View","isH3":false,"content":"<p>Create <strong>/views/author_list.pug</strong> and replace its content with the text below.</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">pug</span></p><pre class=\"brush: pug notranslate\"><code><span class=\"token keyword\">extends layout</span>\n\n<span class=\"token keyword\">block content</span>\n  <span class=\"token tag\">h1</span><span class=\"token punctuation\">=</span><span class=\"token code\"> title</span>\n\n  <span class=\"token tag\">ul</span>\n    <span class=\"token flow-control\"><span class=\"token each\"><span class=\"token keyword\">each</span> author <span class=\"token keyword\">in</span></span> author_list</span>\n      <span class=\"token tag\">li</span>\n        <span class=\"token tag\">a<span class=\"token attributes\"><span class=\"token punctuation\">(</span><span class=\"token attr-name\">href</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\">author<span class=\"token punctuation\">.</span>url</span><span class=\"token punctuation\">)</span></span></span> <span class=\"token plain-text\">#{author.name}</span>\n        <span class=\"token punctuation\">|</span>  (#{author<span class=\"token punctuation\">.</span>date_of_birth} <span class=\"token punctuation\">-</span> #{author<span class=\"token punctuation\">.</span>date_of_death})\n\n    <span class=\"token flow-control\"><span class=\"token branch keyword\">else</span></span>\n      <span class=\"token tag\">li</span> <span class=\"token plain-text\">There are no authors.</span>\n</code></pre></div>\n<p>Run the application and open your browser to <code>http://localhost:3000/</code>. Then select the <em>All authors</em> link. If everything is set up correctly, the page should look something like the following screenshot.</p>\n<p>\n  <img src=\"/en-US/docs/Learn/Server-side/Express_Nodejs/Displaying_data/Author_list_page/locallibary_express_author_list.png\" alt=\"Author List Page - Express Local Library site\" width=\"1474\" height=\"557\" loading=\"lazy\">\n</p>\n<div class=\"notecard note\" id=\"sect1\">\n  <p><strong>Note:</strong> The appearance of the author <em>lifespan</em> dates is ugly! You can improve this using the <a href=\"/en-US/docs/Learn/Server-side/Express_Nodejs/Displaying_data/Date_formatting_using_moment\">same approach</a> as we used for the <code>BookInstance</code> list (adding the virtual property for the lifespan to the <code>Author</code> model).</p>\n  <p>However, as the author may not be dead or may have missing birth/death data, in this case we need to ignore missing dates or references to nonexistent properties. One way to deal with this is to return either a formatted date, or a blank string, depending on whether the property is defined. For example:</p>\n  <p><code>return this.date_of_birth ? DateTime.fromJSDate(this.date_of_birth).toLocaleString(DateTime.DATE_MED) : '';</code></p>\n</div>"}},{"type":"prose","value":{"id":"genre_list_page—challenge!","title":"Genre list page—challenge!","isH3":false,"content":"<p>In this section you should implement your own genre list page. The page should display a list of all genres in the database, with each genre linked to its associated detail page. A screenshot of the expected result is shown below.</p>\n<p>\n  <img src=\"/en-US/docs/Learn/Server-side/Express_Nodejs/Displaying_data/Author_list_page/locallibary_express_genre_list.png\" alt=\"Genre List - Express Local Library site\" width=\"657\" height=\"379\" loading=\"lazy\">\n</p>\n<p>The genre list controller function needs to get a list of all <code>Genre</code> instances, and then pass these to the template for rendering.</p>\n<ol>\n  <li>You will need to edit <code>genre_list()</code> in <strong>/controllers/genreController.js</strong>.</li>\n  <li>The implementation is almost exactly the same as the <code>author_list()</code> controller.\n    <ul>\n      <li>Sort the results by name, in ascending order.</li>\n    </ul>\n  </li>\n  <li>The template to be rendered should be named <strong>genre_list.pug</strong>.</li>\n  <li>The template to be rendered should be passed the variables <code>title</code> ('Genre List') and <code>genre_list</code> (the list of genres returned from your <code>Genre.find()</code> callback).</li>\n  <li>The view should match the screenshot/requirements above (this should have a very similar structure/format to the Author list view, except for the fact that genres do not have dates).</li>\n</ol>"}},{"type":"prose","value":{"id":"next_steps","title":"Next steps","isH3":false,"content":"<p>Return to <a href=\"/en-US/docs/Learn/Server-side/Express_Nodejs/Displaying_data\">Express Tutorial Part 5: Displaying library data</a>.</p>\n<p>Proceed to the next subarticle of part 5: <a href=\"/en-US/docs/Learn/Server-side/Express_Nodejs/Displaying_data/Genre_detail_page\">Genre detail page</a>.</p>"}}],"toc":[{"text":"Controller","id":"controller"},{"text":"View","id":"view"},{"text":"Genre list page—challenge!","id":"genre_list_page—challenge!"},{"text":"Next steps","id":"next_steps"}],"summary":"The author list page needs to display a list of all authors in the database, with each author name linked to its associated author detail page. The date of birth and date of death should be listed after the name on the same line.","popularity":0.0019,"modified":"2023-07-03T10:12:35.000Z","source":{"folder":"en-us/learn/server-side/express_nodejs/displaying_data/author_list_page","github_url":"https://github.com/mdn/content/blob/main/files/en-us/learn/server-side/express_nodejs/displaying_data/author_list_page/index.md","last_commit_url":"https://github.com/mdn/content/commit/bb026bcb88b7f45374d602301b7b0db5a49ff303","filename":"index.md"},"short_title":"Author list page and Genre list page challenge","parents":[{"uri":"/en-US/docs/Learn","title":"Guides"},{"uri":"/en-US/docs/Learn/Server-side","title":"Server-side website programming"},{"uri":"/en-US/docs/Learn/Server-side/Express_Nodejs","title":"Express web framework (Node.js/JavaScript)"},{"uri":"/en-US/docs/Learn/Server-side/Express_Nodejs/Displaying_data","title":"Express Tutorial Part 5: Displaying library data"},{"uri":"/en-US/docs/Learn/Server-side/Express_Nodejs/Displaying_data/Author_list_page","title":"Author list page and Genre list page challenge"}],"pageTitle":"Author list page and Genre list page challenge - Learn web development | MDN","noIndexing":false}}