<!doctype html><html lang="en-US" prefix="og: https://ogp.me/ns#"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><link rel="icon" href="/favicon-48x48.cbbd161b.png"/><link rel="apple-touch-icon" href="/apple-touch-icon.6803c6f0.png"/><meta name="theme-color" content="#ffffff"/><link rel="manifest" href="/manifest.56b1cedc.json"/><link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="MDN Web Docs"/><title>Offline and background operation - Progressive web apps | MDN</title><link rel="alternate" type="application/rss+xml" title="MDN Blog RSS Feed" href="https://developer.mozilla.org/en-US/blog/rss.xml" hreflang="en" /><meta name="robots" content="noindex, nofollow"><meta name="description" content="Usually, websites are very dependent on both reliable network connectivity and on the user having their pages open in a browser. Without network connectivity, most websites are just unusable, and if the user does not have the site open in a browser tab, most websites are unable to do anything."/><meta property="og:url" content="https://developer.mozilla.org/en-US/docs/Web/Progressive_web_apps/Guides/Offline_and_background_operation"/><meta property="og:title" content="Offline and background operation - Progressive web apps | MDN"/><meta property="og:type" content="website"/><meta property="og:locale" content="en_US"/><meta property="og:description" content="Usually, websites are very dependent on both reliable network connectivity and on the user having their pages open in a browser. Without network connectivity, most websites are just unusable, and if the user does not have the site open in a browser tab, most websites are unable to do anything."/><meta property="og:image" content="https://developer.mozilla.org/mdn-social-share.cd6c4a5a.png"/><meta property="og:image:type" content="image/png"/><meta property="og:image:height" content="1080"/><meta property="og:image:width" content="1920"/><meta property="og:image:alt" content="The MDN Web Docs logo, featuring a blue accent color, displayed on a solid black background."/><meta property="og:site_name" content="MDN Web Docs"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:creator" content="MozDevNet"/><link rel="canonical" href="https://developer.mozilla.org/en-US/docs/Web/Progressive_web_apps/Guides/Offline_and_background_operation"/><style media="print">.article-actions-container,.document-toc-container,.language-menu,.main-menu-toggle,.on-github,.page-footer,.place,.sidebar,.top-banner,.top-navigation-main,ul.prev-next{display:none!important}.main-page-content,.main-page-content pre{padding:2px}.main-page-content pre{border-left-width:2px}</style><script defer="defer" src="/static/js/main.8204838d.js"></script><link href="/static/css/main.3551aa81.css" rel="stylesheet"></head><body><script>if(document.body.addEventListener("load",(t=>{t.target.classList.contains("interactive")&&t.target.setAttribute("data-readystate","complete")}),{capture:!0}),window&&document.documentElement){const t={light:"#ffffff",dark:"#1b1b1b"};try{const e=window.localStorage.getItem("theme");e&&(document.documentElement.className=e,document.documentElement.style.backgroundColor=t[e])}catch(t){console.warn("Unable to read theme from localStorage",t)}}</script><div id="root"><ul id="nav-access" class="a11y-nav"><li><a id="skip-main" href="#content">Skip to main content</a></li><li><a id="skip-search" href="#top-nav-search-input">Skip to search</a></li><li><a id="skip-select-language" href="#languages-switcher-button">Skip to select language</a></li></ul><div class="page-wrapper  category-web document-page"><div class="top-banner loading"><section class="place top container"></section></div><div class="sticky-header-container"><header class="top-navigation 
      
      "><div class="container "><div class="top-navigation-wrap"><a href="/en-US/" class="logo" aria-label="MDN homepage"><svg id="mdn-docs-logo" xmlns="http://www.w3.org/2000/svg" x="0" y="0" viewBox="0 0 694.9 104.4" style="enable-background:new 0 0 694.9 104.4" xml:space="preserve" role="img"><title>MDN Web Docs</title><path d="M40.3 0 11.7 92.1H0L28.5 0h11.8zm10.4 0v92.1H40.3V0h10.4zM91 0 62.5 92.1H50.8L79.3 0H91zm10.4 0v92.1H91V0h10.4z" class="logo-m"></path><path d="M627.9 95.6h67v8.8h-67v-8.8z" class="logo-_"></path><path d="M367 42h-4l-10.7 30.8h-5.5l-10.8-26h-.4l-10.5 26h-5.2L308.7 42h-3.8v-5.6H323V42h-6.5l6.8 20.4h.4l10.3-26h4.7l11.2 26h.5l5.7-20.3h-6.2v-5.6H367V42zm34.9 20c-.4 3.2-2 5.9-4.7 8.2-2.8 2.3-6.5 3.4-11.3 3.4-5.4 0-9.7-1.6-13.1-4.7-3.3-3.2-5-7.7-5-13.7 0-5.7 1.6-10.3 4.7-14s7.4-5.5 12.9-5.5c5.1 0 9.1 1.6 11.9 4.7s4.3 6.9 4.3 11.3c0 1.5-.2 3-.5 4.7h-25.6c.3 7.7 4 11.6 10.9 11.6 2.9 0 5.1-.7 6.5-2 1.5-1.4 2.5-3 3-4.9l6 .9zM394 51.3c.2-2.4-.4-4.7-1.8-6.9s-3.8-3.3-7-3.3c-3.1 0-5.3 1-6.9 3-1.5 2-2.5 4.4-2.8 7.2H394zm51 2.4c0 5-1.3 9.5-4 13.7s-6.9 6.2-12.7 6.2c-6 0-10.3-2.2-12.7-6.7-.1.4-.2 1.4-.4 2.9s-.3 2.5-.4 2.9h-7.3c.3-1.7.6-3.5.8-5.3.3-1.8.4-3.7.4-5.5V22.3h-6v-5.6H416v27c1.1-2.2 2.7-4.1 4.7-5.7 2-1.6 4.8-2.4 8.4-2.4 4.6 0 8.4 1.6 11.4 4.7 3 3.2 4.5 7.6 4.5 13.4zm-7.7.6c0-4.2-1-7.4-3-9.5-2-2.2-4.4-3.3-7.4-3.3-3.4 0-6 1.2-8 3.7-1.9 2.4-2.9 5-3 7.7V57c0 3 1 5.6 3 7.7s4.5 3.1 7.6 3.1c3.6 0 6.3-1.3 8.1-3.9 1.8-2.7 2.7-5.9 2.7-9.6zm69.2 18.5h-13.2v-7.2c-1.2 2.2-2.8 4.1-4.9 5.6-2.1 1.6-4.8 2.4-8.3 2.4-4.8 0-8.7-1.6-11.6-4.9-2.9-3.2-4.3-7.7-4.3-13.3 0-5 1.3-9.6 4-13.7 2.6-4.1 6.9-6.2 12.8-6.2 5.7 0 9.8 2.2 12.3 6.5V22.3h-8.6v-5.6h15.8v50.6h6v5.5zM493.2 56v-4.4c-.1-3-1.2-5.5-3.2-7.3s-4.4-2.8-7.2-2.8c-3.6 0-6.3 1.3-8.2 3.9-1.9 2.6-2.8 5.8-2.8 9.6 0 4.1 1 7.3 3 9.5s4.5 3.3 7.4 3.3c3.2 0 5.8-1.3 7.8-3.8 2.1-2.6 3.1-5.3 3.2-8zm53.1-1.4c0 5.6-1.8 10.2-5.3 13.7s-8.2 5.3-13.9 5.3-10.1-1.7-13.4-5.1c-3.3-3.4-5-7.9-5-13.5 0-5.3 1.6-9.9 4.7-13.7 3.2-3.8 7.9-5.7 14.2-5.7s11 1.9 14.1 5.7c3 3.7 4.6 8.1 4.6 13.3zm-7.7-.2c0-4-1-7.2-3-9.5s-4.8-3.5-8.2-3.5c-3.6 0-6.4 1.2-8.3 3.7s-2.9 5.6-2.9 9.5c0 3.7.9 6.8 2.8 9.4 1.9 2.6 4.6 3.9 8.3 3.9 3.6 0 6.4-1.3 8.4-3.8 1.9-2.6 2.9-5.8 2.9-9.7zm45 5.8c-.4 3.2-1.9 6.3-4.4 9.1-2.5 2.9-6.4 4.3-11.8 4.3-5.2 0-9.4-1.6-12.6-4.8-3.2-3.2-4.8-7.7-4.8-13.7 0-5.5 1.6-10.1 4.7-13.9 3.2-3.8 7.6-5.7 13.2-5.7 2.3 0 4.6.3 6.7.8 2.2.5 4.2 1.5 6.2 2.9l1.5 9.5-5.9.7-1.3-6.1c-2.1-1.2-4.5-1.8-7.2-1.8-3.5 0-6.1 1.2-7.7 3.7-1.7 2.5-2.5 5.7-2.5 9.6 0 4.1.9 7.3 2.7 9.5 1.8 2.3 4.4 3.4 7.8 3.4 5.2 0 8.2-2.9 9.2-8.8l6.2 1.3zm34.7 1.9c0 3.6-1.5 6.5-4.6 8.5s-7 3-11.7 3c-5.7 0-10.6-1.2-14.6-3.6l1.2-8.8 5.7.6-.2 4.7c1.1.5 2.3.9 3.6 1.1s2.6.3 3.9.3c2.4 0 4.5-.4 6.5-1.3 1.9-.9 2.9-2.2 2.9-4.1 0-1.8-.8-3.1-2.3-3.8s-3.5-1.3-5.8-1.7-4.6-.9-6.9-1.4c-2.3-.6-4.2-1.6-5.7-2.9-1.6-1.4-2.3-3.5-2.3-6.3 0-4.1 1.5-6.9 4.6-8.5s6.4-2.4 9.9-2.4c2.6 0 5 .3 7.2.9 2.2.6 4.3 1.4 6.1 2.4l.8 8.8-5.8.7-.8-5.7c-2.3-1-4.7-1.6-7.2-1.6-2.1 0-3.7.4-5.1 1.1-1.3.8-2 2-2 3.8 0 1.7.8 2.9 2.3 3.6 1.5.7 3.4 1.2 5.7 1.6 2.2.4 4.5.8 6.7 1.4 2.2.6 4.1 1.6 5.7 3 1.4 1.6 2.2 3.7 2.2 6.6zM197.6 73.2h-17.1v-5.5h3.8V51.9c0-3.7-.7-6.3-2.1-7.9-1.4-1.6-3.3-2.3-5.7-2.3-3.2 0-5.6 1.1-7.2 3.4s-2.4 4.6-2.5 6.9v15.6h6v5.5h-17.1v-5.5h3.8V51.9c0-3.8-.7-6.4-2.1-7.9-1.4-1.5-3.3-2.3-5.6-2.3-3.2 0-5.5 1.1-7.2 3.3-1.6 2.2-2.4 4.5-2.5 6.9v15.8h6.9v5.5h-20.2v-5.5h6V42.4h-6.1v-5.6h13.4v6.4c1.2-2.1 2.7-3.8 4.7-5.2 2-1.3 4.4-2 7.3-2s5.3.7 7.5 2.1c2.2 1.4 3.7 3.5 4.5 6.4 1.1-2.5 2.7-4.5 4.9-6.1s4.8-2.4 7.9-2.4c3.5 0 6.5 1.1 8.9 3.3s3.7 5.6 3.7 10.2v18.2h6.1v5.5zm42.5 0h-13.2V66c-1.2 2.2-2.8 4.1-4.9 5.6-2.1 1.6-4.8 2.4-8.3 2.4-4.8 0-8.7-1.6-11.6-4.9-2.9-3.2-4.3-7.7-4.3-13.3 0-5 1.3-9.6 4-13.7 2.6-4.1 6.9-6.2 12.8-6.2s9.8 2.2 12.3 6.5V22.7h-8.6v-5.6h15.8v50.6h6v5.5zm-13.3-16.8V52c-.1-3-1.2-5.5-3.2-7.3s-4.4-2.8-7.2-2.8c-3.6 0-6.3 1.3-8.2 3.9-1.9 2.6-2.8 5.8-2.8 9.6 0 4.1 1 7.3 3 9.5s4.5 3.3 7.4 3.3c3.2 0 5.8-1.3 7.8-3.8 2.1-2.6 3.1-5.3 3.2-8zm61.5 16.8H269v-5.5h6V51.9c0-3.7-.7-6.3-2.2-7.9-1.4-1.6-3.4-2.3-5.7-2.3-3.1 0-5.6 1-7.4 3s-2.8 4.4-2.9 7v15.9h6v5.5h-19.3v-5.5h6V42.4h-6.2v-5.6h13.6V43c2.6-4.6 6.8-6.9 12.7-6.9 3.6 0 6.7 1.1 9.2 3.3s3.7 5.6 3.7 10.2v18.2h6v5.4h-.2z" class="logo-text"></path></svg></a><button title="Open main menu" type="button" class="button action has-icon main-menu-toggle" aria-haspopup="menu" aria-label="Open main menu" aria-expanded="false"><span class="button-wrap"><span class="icon icon-menu "></span><span class="visually-hidden">Open main menu</span></span></button></div><div class="top-navigation-main"><nav class="main-nav" aria-label="Main menu"><ul class="main-menu nojs"><li class="top-level-entry-container active"><button type="button" id="references-button" class="top-level-entry menu-toggle" aria-controls="references-menu" aria-expanded="false">References</button><a href="/en-US/docs/Web" class="top-level-entry">References</a><ul id="references-menu" class="submenu references hidden inline-submenu-lg" aria-labelledby="references-button"><li class="apis-link-container mobile-only "><a href="/en-US/docs/Web" class="submenu-item "><div class="submenu-icon"></div><div class="submenu-content-container"><div class="submenu-item-heading">Overview / Web Technology</div><p class="submenu-item-description">Web technology reference for developers</p></div></a></li><li class="html-link-container "><a href="/en-US/docs/Web/HTML" class="submenu-item "><div class="submenu-icon html"></div><div class="submenu-content-container"><div class="submenu-item-heading">HTML</div><p class="submenu-item-description">Structure of content on the web</p></div></a></li><li class="css-link-container "><a href="/en-US/docs/Web/CSS" class="submenu-item "><div class="submenu-icon css"></div><div class="submenu-content-container"><div class="submenu-item-heading">CSS</div><p class="submenu-item-description">Code used to describe document style</p></div></a></li><li class="javascript-link-container "><a href="/en-US/docs/Web/JavaScript" class="submenu-item "><div class="submenu-icon javascript"></div><div class="submenu-content-container"><div class="submenu-item-heading">JavaScript</div><p class="submenu-item-description">General-purpose scripting language</p></div></a></li><li class="http-link-container "><a href="/en-US/docs/Web/HTTP" class="submenu-item "><div class="submenu-icon http"></div><div class="submenu-content-container"><div class="submenu-item-heading">HTTP</div><p class="submenu-item-description">Protocol for transmitting web resources</p></div></a></li><li class="apis-link-container "><a href="/en-US/docs/Web/API" class="submenu-item "><div class="submenu-icon apis"></div><div class="submenu-content-container"><div class="submenu-item-heading">Web APIs</div><p class="submenu-item-description">Interfaces for building web applications</p></div></a></li><li class="apis-link-container "><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions" class="submenu-item "><div class="submenu-icon"></div><div class="submenu-content-container"><div class="submenu-item-heading">Web Extensions</div><p class="submenu-item-description">Developing extensions for web browsers</p></div></a></li><li class="apis-link-container desktop-only "><a href="/en-US/docs/Web" class="submenu-item "><div class="submenu-icon"></div><div class="submenu-content-container"><div class="submenu-item-heading">Web Technology</div><p class="submenu-item-description">Web technology reference for developers</p></div></a></li></ul></li><li class="top-level-entry-container "><button type="button" id="guides-button" class="top-level-entry menu-toggle" aria-controls="guides-menu" aria-expanded="false">Guides</button><a href="/en-US/docs/Learn" class="top-level-entry">Guides</a><ul id="guides-menu" class="submenu guides hidden inline-submenu-lg" aria-labelledby="guides-button"><li class="apis-link-container mobile-only "><a href="/en-US/docs/Learn" class="submenu-item "><div class="submenu-icon learn"></div><div class="submenu-content-container"><div class="submenu-item-heading">Overview / MDN Learning Area</div><p class="submenu-item-description">Learn web development</p></div></a></li><li class="apis-link-container desktop-only "><a href="/en-US/docs/Learn" class="submenu-item "><div class="submenu-icon learn"></div><div class="submenu-content-container"><div class="submenu-item-heading">MDN Learning Area</div><p class="submenu-item-description">Learn web development</p></div></a></li><li class="html-link-container "><a href="/en-US/docs/Learn/HTML" class="submenu-item "><div class="submenu-icon html"></div><div class="submenu-content-container"><div class="submenu-item-heading">HTML</div><p class="submenu-item-description">Learn to structure web content with HTML</p></div></a></li><li class="css-link-container "><a href="/en-US/docs/Learn/CSS" class="submenu-item "><div class="submenu-icon css"></div><div class="submenu-content-container"><div class="submenu-item-heading">CSS</div><p class="submenu-item-description">Learn to style content using CSS</p></div></a></li><li class="javascript-link-container "><a href="/en-US/docs/Learn/JavaScript" class="submenu-item "><div class="submenu-icon javascript"></div><div class="submenu-content-container"><div class="submenu-item-heading">JavaScript</div><p class="submenu-item-description">Learn to run scripts in the browser</p></div></a></li><li class=" "><a href="/en-US/docs/Web/Accessibility" class="submenu-item "><div class="submenu-icon"></div><div class="submenu-content-container"><div class="submenu-item-heading">Accessibility</div><p class="submenu-item-description">Learn to make the web accessible to all</p></div></a></li></ul></li><li class="top-level-entry-container "><a class="top-level-entry menu-link" href="/en-US/blog/">Blog</a></li><li class="top-level-entry-container "><a class="top-level-entry menu-link" href="/en-US/play">Play</a></li><li class="top-level-entry-container "><a class="top-level-entry menu-link" href="/en-US/plus/ai-help">AI Help <sup class="new beta">Beta</sup></a></li></ul></nav><div class="header-search"><form action="/en-US/search" class="search-form search-widget" id="top-nav-search-form" role="search"><label id="top-nav-search-label" for="top-nav-search-input" class="visually-hidden">Search MDN</label><input aria-activedescendant="" aria-autocomplete="list" aria-controls="top-nav-search-menu" aria-expanded="false" aria-labelledby="top-nav-search-label" autoComplete="off" id="top-nav-search-input" role="combobox" type="search" class="search-input-field" name="q" placeholder="   " required="" value=""/><button type="button" class="button action has-icon clear-search-button"><span class="button-wrap"><span class="icon icon-cancel "></span><span class="visually-hidden">Clear search input</span></span></button><button type="submit" class="button action has-icon search-button"><span class="button-wrap"><span class="icon icon-search "></span><span class="visually-hidden">Search</span></span></button><div id="top-nav-search-menu" role="listbox" aria-labelledby="top-nav-search-label"></div></form></div><div class="theme-switcher-menu"><button type="button" class="button action has-icon theme-switcher-menu small" aria-haspopup="menu"><span class="button-wrap"><span class="icon icon-theme-os-default "></span>Theme</span></button></div><ul class="auth-container"><li><a href="?next=%2Fen-US%2Fdocs%2FWeb%2FProgressive_web_apps%2FGuides%2FOffline_and_background_operation" class="login-link" rel="nofollow">Log in</a></li><li><a href="?next=%2Fen-US%2Fdocs%2FWeb%2FProgressive_web_apps%2FGuides%2FOffline_and_background_operation" target="_self" class="button primary mdn-plus-subscribe-link"><span class="button-wrap">Sign up for free</span></a></li></ul></div></div></header><div class="article-actions-container"><div class="container"><button type="button" class="button action has-icon sidebar-button" aria-label="Expand sidebar" aria-expanded="false" aria-controls="sidebar-quicklinks"><span class="button-wrap"><span class="icon icon-sidebar "></span></span></button><nav class="breadcrumbs-container" aria-label="Breadcrumb"><ol typeof="BreadcrumbList" vocab="https://schema.org/" aria-label="breadcrumbs"><li property="itemListElement" typeof="ListItem"><a class="breadcrumb" property="item" typeof="WebPage" href="/en-US/docs/Web"><span property="name">References</span></a><meta property="position" content="1"/></li><li property="itemListElement" typeof="ListItem"><a class="breadcrumb" property="item" typeof="WebPage" href="/en-US/docs/Web/Progressive_web_apps"><span property="name">Progressive web apps</span></a><meta property="position" content="2"/></li><li property="itemListElement" typeof="ListItem"><a class="breadcrumb" property="item" typeof="WebPage" href="/en-US/docs/Web/Progressive_web_apps/Guides"><span property="name">Guides</span></a><meta property="position" content="3"/></li><li property="itemListElement" typeof="ListItem"><a class="breadcrumb-current-page" property="item" typeof="WebPage" href="/en-US/docs/Web/Progressive_web_apps/Guides/Offline_and_background_operation"><span property="name">Offline and background operation</span></a><meta property="position" content="4"/></li></ol></nav></div></div></div><div class="main-wrapper"><div class="sidebar-container"><aside id="sidebar-quicklinks" class="sidebar" data-macro="PWASidebar"><button type="button" class="button action backdrop" aria-label="Collapse sidebar"><span class="button-wrap"></span></button><nav aria-label="Related Topics" class="sidebar-inner"><header class="sidebar-actions"><section class="sidebar-filter-container"><div class="sidebar-filter "><label id="sidebar-filter-label" class="sidebar-filter-label" for="sidebar-filter-input"><span class="icon icon-filter"></span><span class="visually-hidden">Filter sidebar</span></label><input id="sidebar-filter-input" autoComplete="off" class="sidebar-filter-input-field false" type="text" placeholder="Filter" value=""/><button type="button" class="button action has-icon clear-sidebar-filter-button"><span class="button-wrap"><span class="icon icon-cancel "></span><span class="visually-hidden">Clear filter input</span></span></button></div></section></header><div class="sidebar-inner-nav"><div class="in-nav-toc"><div class="document-toc-container"><section class="document-toc"><header><h2 class="document-toc-heading">In this article</h2></header><ul class="document-toc-list"><li class="document-toc-item "><a class="document-toc-link" href="#websites_and_workers">Websites and workers</a></li><li class="document-toc-item "><a class="document-toc-link" href="#offline_operation">Offline operation</a></li><li class="document-toc-item "><a class="document-toc-link" href="#background_operation">Background operation</a></li><li class="document-toc-item "><a class="document-toc-link" href="#background_sync">Background sync</a></li><li class="document-toc-item "><a class="document-toc-link" href="#background_fetch">Background fetch</a></li><li class="document-toc-item "><a class="document-toc-link" href="#periodic_background_sync">Periodic background sync</a></li><li class="document-toc-item "><a class="document-toc-link" href="#push">Push</a></li><li class="document-toc-item "><a class="document-toc-link" href="#permissions_and_restrictions">Permissions and restrictions</a></li><li class="document-toc-item "><a class="document-toc-link" href="#see_also">See also</a></li></ul></section></div></div><div class="sidebar-body"><ol><li><a href="/en-US/docs/Web/Progressive_web_apps"><strong>Progressive web apps</strong></a></li><li><a href="/en-US/docs/Web/Progressive_web_apps/Guides"><strong>Guides</strong></a></li><li><a href="/en-US/docs/Web/Progressive_web_apps/Guides/What_is_a_progressive_web_app">What is a progressive web app?</a></li><li><a href="/en-US/docs/Web/Progressive_web_apps/Guides/Installing">Installing and uninstalling web apps</a></li><li><a href="/en-US/docs/Web/Progressive_web_apps/Guides/Making_PWAs_installable">Making PWAs installable</a></li><li><em><a href="/en-US/docs/Web/Progressive_web_apps/Guides/Offline_and_background_operation" aria-current="page">Offline and background operation</a></em></li><li><a href="/en-US/docs/Web/Progressive_web_apps/Guides/Caching">Caching</a></li><li><a href="/en-US/docs/Web/Progressive_web_apps/Guides/Best_practices">Best practices for PWAs</a></li><li><a href="/en-US/docs/Web/Progressive_web_apps/Tutorials"><strong>Tutorials</strong></a></li><li><ol><li><details><summary>CycleTracker</summary><ol><li><a href="/en-US/docs/Web/Progressive_web_apps/Tutorials/CycleTracker">CycleTracker</a></li><li><a href="/en-US/docs/Web/Progressive_web_apps/Tutorials/CycleTracker/HTML_and_CSS">Base HTML and CSS</a></li><li><a href="/en-US/docs/Web/Progressive_web_apps/Tutorials/CycleTracker/Secure_connection">Secure connection</a></li><li><a href="/en-US/docs/Web/Progressive_web_apps/Tutorials/CycleTracker/JavaScript_functionality">JavaScript functionality</a></li><li><a href="/en-US/docs/Web/Progressive_web_apps/Tutorials/CycleTracker/Manifest_file">Manifest and iconography</a></li><li><a href="/en-US/docs/Web/Progressive_web_apps/Tutorials/CycleTracker/Service_workers">Service workers</a></li></ol></details></li></ol></li><li><ol><li><details><summary>js13kGames</summary><ol><li><a href="/en-US/docs/Web/Progressive_web_apps/Tutorials/js13kGames">js13kGames</a></li><li><a href="/en-US/docs/Web/Progressive_web_apps/Tutorials/js13kGames/App_structure">Progressive web app structure</a></li><li><a href="/en-US/docs/Web/Progressive_web_apps/Tutorials/js13kGames/Offline_Service_workers">Making PWAs work offline with Service workers</a></li><li><a href="/en-US/docs/Web/Progressive_web_apps/Tutorials/js13kGames/Installable_PWAs">How to make PWAs installable</a></li><li><a href="/en-US/docs/Web/Progressive_web_apps/Tutorials/js13kGames/Re-engageable_Notifications_Push">How to make PWAs re-engageable using Notifications and Push</a></li><li><a href="/en-US/docs/Web/Progressive_web_apps/Tutorials/js13kGames/Loading">Progressive loading</a></li></ol></details></li></ol></li><li><a href="/en-US/docs/Web/Progressive_web_apps/How_to"><strong>How to</strong></a></li><li><a href="/en-US/docs/Web/Progressive_web_apps/How_to/Trigger_install_prompt">Trigger installation from your PWA</a></li><li><a href="/en-US/docs/Web/Progressive_web_apps/How_to/Define_app_icons">Define your app icons</a></li><li><a href="/en-US/docs/Web/Progressive_web_apps/How_to/Create_a_standalone_app">Create a standalone app</a></li><li><a href="/en-US/docs/Web/Progressive_web_apps/How_to/Customize_your_app_colors">Customize your app's theme and background colors</a></li><li><a href="/en-US/docs/Web/Progressive_web_apps/How_to/Display_badge_on_app_icon">Display a badge on the app icon</a></li><li><a href="/en-US/docs/Web/Progressive_web_apps/How_to/Expose_common_actions_as_shortcuts">Expose common app actions as shortcuts</a></li><li><a href="/en-US/docs/Web/Progressive_web_apps/How_to/Share_data_between_apps">Share data between apps</a></li><li><a href="/en-US/docs/Web/Progressive_web_apps/How_to/Associate_files_with_your_PWA">Associate files with your PWA</a></li><li><a href="/en-US/docs/Web/Progressive_web_apps/Reference"><strong>Reference</strong></a></li></ol></div></div></nav></aside><div class="toc-container"><aside class="toc"><nav><div class="document-toc-container"><section class="document-toc"><header><h2 class="document-toc-heading">In this article</h2></header><ul class="document-toc-list"><li class="document-toc-item "><a class="document-toc-link" href="#websites_and_workers">Websites and workers</a></li><li class="document-toc-item "><a class="document-toc-link" href="#offline_operation">Offline operation</a></li><li class="document-toc-item "><a class="document-toc-link" href="#background_operation">Background operation</a></li><li class="document-toc-item "><a class="document-toc-link" href="#background_sync">Background sync</a></li><li class="document-toc-item "><a class="document-toc-link" href="#background_fetch">Background fetch</a></li><li class="document-toc-item "><a class="document-toc-link" href="#periodic_background_sync">Periodic background sync</a></li><li class="document-toc-item "><a class="document-toc-link" href="#push">Push</a></li><li class="document-toc-item "><a class="document-toc-link" href="#permissions_and_restrictions">Permissions and restrictions</a></li><li class="document-toc-item "><a class="document-toc-link" href="#see_also">See also</a></li></ul></section></div></nav></aside></div></div><main id="content" class="main-content  "><article class="main-page-content" lang="en-US"><header><h1>Offline and background operation</h1></header><div class="section-content"><p>Usually, websites are very dependent on both reliable network connectivity and on the user having their pages open in a browser. Without network connectivity, most websites are just unusable, and if the user does not have the site open in a browser tab, most websites are unable to do anything.</p>
<p>However, consider the following scenarios:</p>
<ul>
  <li>A music app enables the user to stream music while online, but can download tracks in the background and then continue to play while the user is offline.</li>
  <li>The user composes a long email, presses "Send", and then loses network connectivity. The device sends the email in the background, as soon as the network is available again.</li>
  <li>The user's chat app receives a message from one of their contacts, and although the app is not open, it displays a badge on the app icon to let the user know they have a new message.</li>
</ul>
<p>These are the kinds of features that users expect from installed apps. In this guide, we'll introduce a set of technologies that enable a PWA to:</p>
<ul>
  <li>Provide a good user experience even when the device has intermittent network connectivity</li>
  <li>Update its state when the app is not running</li>
  <li>Notify the user about important events that have happened while the app was not running</li>
</ul>
<p>The technologies introduced in this guide are:</p>
<ul>
  <li><a href="/en-US/docs/Web/API/Service_Worker_API">Service Worker API</a></li>
  <li><a href="/en-US/docs/Web/API/Background_Synchronization_API">Background Synchronization API</a></li>
  <li><a href="/en-US/docs/Web/API/Background_Fetch_API">Background Fetch API</a></li>
  <li><a href="/en-US/docs/Web/API/Web_Periodic_Background_Synchronization_API">Periodic Background Synchronization API</a></li>
  <li><a href="/en-US/docs/Web/API/Push_API">Push API</a></li>
  <li><a href="/en-US/docs/Web/API/Notifications_API">Notifications API</a></li>
</ul></div><section aria-labelledby="websites_and_workers"><h2 id="websites_and_workers"><a href="#websites_and_workers">Websites and workers</a></h2><div class="section-content"><p>The foundation of all the technologies we'll discuss in this guide is the <em>service worker</em>. In this section we'll provide a little background about workers and how they change the architecture of a web app.</p>
<p>Normally, an entire website runs in a single thread. This includes the website's own JavaScript, and all the work to render the website's UI. One consequence of this is that if your JavaScript runs some long-running operation, the website's main UI is blocked, and the website appears unresponsive to the user.</p>
<p>A <a href="/en-US/docs/Web/API/Service_Worker_API">service worker</a> is a specific type of <a href="/en-US/docs/Web/API/Web_Workers_API">web worker</a> that's used to implement PWAs. Like all web workers, a service worker runs in a separate thread to the main JavaScript code. The main code creates the worker, passing in a URL to the worker's script. The worker and the main code can't directly access each other's state, but can communicate by sending each other messages. Workers can be used to run computationally expensive tasks in the background: because they run in a separate thread, the main JavaScript code in the app, that implements the app's UI, can stay responsive to the user.</p>
<p>So a PWA always has a high level architecture split between:</p>
<ul>
  <li>The <em>main app</em>, with the HTML, CSS, and the part of the JavaScript that implements the app's UI (by handling user events, for example)</li>
  <li>The <em>service worker</em>, which handles offline and background tasks</li>
</ul>
<p>In this guide, when we show code samples, we'll indicate which part of the app the code belongs in with a comment like <code>// main.js</code> or <code>// service-worker.js</code>.</p></div></section><section aria-labelledby="offline_operation"><h2 id="offline_operation"><a href="#offline_operation">Offline operation</a></h2><div class="section-content"><p>Offline operation allows a PWA to provide a good user experience even when the device does not have network connectivity. This is enabled by adding a service worker to an app.</p>
<p>A service worker <em>controls</em> some or all of the app's pages. When the service worker is installed, it can fetch the resources from the server for the pages it controls (including pages, styles, scripts, and images, for example) and add them to a local cache. The <a href="/en-US/docs/Web/API/Cache"><code>Cache</code></a> interface is used to add resources to the cache. <code>Cache</code> instances are accessible through the <a href="/en-US/docs/Web/API/caches"><code>caches</code></a> property in the service worker global scope.</p>
<p>Then whenever the app requests a resource (for example, because the user opened the app or clicked an internal link), the browser fires an event called <a href="/en-US/docs/Web/API/ServiceWorkerGlobalScope/fetch_event" title="fetch"><code>fetch</code></a> in the service worker's global scope. By listening for this event, the service worker can intercept the request.</p>
<p>The event handler for the <code>fetch</code> event is passed a <a href="/en-US/docs/Web/API/FetchEvent"><code>FetchEvent</code></a> object, which:</p>
<ul>
  <li>Provides access to the request as a <a href="/en-US/docs/Web/API/Request"><code>Request</code></a> instance</li>
  <li>Provides a <a href="/en-US/docs/Web/API/FetchEvent/respondWith" title="respondWith()"><code>respondWith()</code></a> method to send a response to the request.</li>
</ul>
<p>One way a service worker can handle requests is a "cache-first" strategy. In this strategy:</p>
<ol>
  <li>If the requested resource exists in the cache, get the resource from the cache and return the resource to the app.</li>
  <li>If the requested resource does not exist in the cache, try to fetch the resource from the network.
    <ol>
      <li>If the resource could be fetched, add the resource to the cache for next time, and return the resource to the app.</li>
      <li>If the resource could not be fetched, return some default fallback resource.</li>
    </ol>
  </li>
</ol>
<p>The following code sample shows an implementation of this:</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code><span class="token comment">// service-worker.js</span>

<span class="token keyword">const</span> <span class="token function-variable function">putInCache</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> response</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> cache <span class="token operator">=</span> <span class="token keyword">await</span> caches<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"v1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> cache<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">cacheFirst</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> request<span class="token punctuation">,</span> fallbackUrl <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// First try to get the resource from the cache.</span>
  <span class="token keyword">const</span> responseFromCache <span class="token operator">=</span> <span class="token keyword">await</span> caches<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>responseFromCache<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> responseFromCache<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// If the response was not found in the cache,</span>
  <span class="token comment">// try to get the resource from the network.</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> responseFromNetwork <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// If the network request succeeded, clone the response:</span>
    <span class="token comment">// - put one copy in the cache, for the next time</span>
    <span class="token comment">// - return the original to the app</span>
    <span class="token comment">// Cloning is needed because a response can only be consumed once.</span>
    <span class="token function">putInCache</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> responseFromNetwork<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> responseFromNetwork<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// If the network request failed,</span>
    <span class="token comment">// get the fallback response from the cache.</span>
    <span class="token keyword">const</span> fallbackResponse <span class="token operator">=</span> <span class="token keyword">await</span> caches<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>fallbackUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>fallbackResponse<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> fallbackResponse<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// When even the fallback response is not available,</span>
    <span class="token comment">// there is nothing we can do, but we must always</span>
    <span class="token comment">// return a Response object.</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Response</span><span class="token punctuation">(</span><span class="token string">"Network error happened"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token number">408</span><span class="token punctuation">,</span>
      <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">"Content-Type"</span><span class="token operator">:</span> <span class="token string">"text/plain"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"fetch"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  event<span class="token punctuation">.</span><span class="token function">respondWith</span><span class="token punctuation">(</span>
    <span class="token function">cacheFirst</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">request</span><span class="token operator">:</span> event<span class="token punctuation">.</span>request<span class="token punctuation">,</span>
      <span class="token literal-property property">fallbackUrl</span><span class="token operator">:</span> <span class="token string">"/fallback.html"</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>This means that in many situations, the web app will function well even if network connectivity is intermittent. From the point of view of the main app code, it is completely transparent: the app just makes network requests and gets responses. Also, because the service worker is in a separate thread, the main app code can stay responsive to user input while resources are fetched and cached.</p>
<div class="notecard note" id="sect1">
  <p><strong>Note:</strong> The strategy described here is just one way a service worker could implement caching. Specifically, in a cache first strategy, we check the cache first before the network, meaning that we are more likely to return a quick response without incurring a network cost, but are more likely to return a stale response.</p>
  <p>An alternative would be a <em>network first</em> strategy, in which we try to fetch the resource from the server first, and fall back to the cache if the device is offline.</p>
  <p>The optimal caching strategy is dependent on the particular web app and how it is used.</p>
</div>
<p>For much more detail about setting up service workers and using them to add offline functionality, see our <a href="/en-US/docs/Web/API/Service_Worker_API/Using_Service_Workers">guide to using service workers</a>.</p></div></section><section aria-labelledby="background_operation"><h2 id="background_operation"><a href="#background_operation">Background operation</a></h2><div class="section-content"><p>While offline operations are the most common use for service workers, they also enable a PWA to operate even while the main app is closed. This is possible because the service worker can run while the main app is not running.</p>
<p>This doesn't mean service workers run all the time: browsers may stop service workers when they think it is appropriate. For example, if a service worker has been inactive for a while, it will be stopped. However, the browser will restart the service worker when an event has happened that it needs to take care of. This enables a PWA to implement background operations in the following way:</p>
<ul>
  <li>In the main app, register a request for the service worker to perform some operation</li>
  <li>At the appropriate time, the service worker will be restarted if necessary, and an event will fire in the service worker's scope</li>
  <li>The service worker will perform the operation</li>
</ul>
<p>In the next sections, we'll discuss a few different features that use this pattern to enable a PWA to work while the main app isn't open.</p></div></section><section aria-labelledby="background_sync"><h2 id="background_sync"><a href="#background_sync">Background sync</a></h2><div class="section-content"><p>Suppose a user composes an email and presses "Send". In a traditional website, they must keep the tab open until the app has sent the email: if they close the tab, or the device loses connectivity, then the message will not be sent. Background sync, defined in the <a href="/en-US/docs/Web/API/Background_Synchronization_API">Background Synchronization API</a>, is the solution to this problem for PWAs.</p>
<p>Background sync enables the app to ask its service worker to perform a task on its behalf. As soon as the device has network connectivity, the browser will restart the service worker, if necessary, and fire an event named <a href="/en-US/docs/Web/API/ServiceWorkerGlobalScope/sync_event"><code>sync</code></a> in the service worker's scope. The service worker can then attempt to execute the task. If the task can't be completed, then the browser may retry a limited number of times by firing the event again.</p></div></section><section aria-labelledby="registering_a_sync_event"><h3 id="registering_a_sync_event"><a href="#registering_a_sync_event">Registering a sync event</a></h3><div class="section-content"><p>To ask the service worker to perform a task, the main app can access <a href="/en-US/docs/Web/API/ServiceWorkerContainer/ready" title="navigator.serviceWorker.ready"><code>navigator.serviceWorker.ready</code></a>, which resolves with a <a href="/en-US/docs/Web/API/ServiceWorkerRegistration"><code>ServiceWorkerRegistration</code></a> object. The app then calls <a href="/en-US/docs/Web/API/SyncManager/register" title="sync.register()"><code>sync.register()</code></a> on the <code>ServiceWorkerRegistration</code> object, like this:</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code><span class="token comment">// main.js</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">registerSync</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> swRegistration <span class="token operator">=</span> <span class="token keyword">await</span> navigator<span class="token punctuation">.</span>serviceWorker<span class="token punctuation">.</span>ready<span class="token punctuation">;</span>
  swRegistration<span class="token punctuation">.</span>sync<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">"send-message"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p>Note that the app passes a name for the task: <code>"send-message"</code> in this case.</p></div></section><section aria-labelledby="handling_a_sync_event"><h3 id="handling_a_sync_event"><a href="#handling_a_sync_event">Handling a sync event</a></h3><div class="section-content"><p>As soon as the device has network connectivity, the <code>sync</code> event fires in the service worker scope. The service worker checks the name of the task and runs the appropriate function, <code>sendMessage()</code> in this case:</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code><span class="token comment">// service-worker.js</span>

self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"sync"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>tag <span class="token operator">==</span> <span class="token string">"send-message"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    event<span class="token punctuation">.</span><span class="token function">waitUntil</span><span class="token punctuation">(</span><span class="token function">sendMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>Note that we pass the result of the <code>sendMessage()</code> function into the event's <a href="/en-US/docs/Web/API/ExtendableEvent/waitUntil" title="waitUntil()"><code>waitUntil()</code></a> method. The <code>waitUntil()</code> method takes a <a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise"><code>Promise</code></a> as a parameter and asks the browser not to stop the service worker until the promise has settled. This is also how the browser knows whether the operation succeeded or not: if the promise rejects, then the browser may retry by firing the <code>sync</code> event again.</p>
<p>The <code>waitUntil()</code> method is not a guarantee that the browser will not stop the service worker: if the operation takes too long, the service worker will be stopped anyway. If this happens, then the operation is aborted, and next time a <code>sync</code> event is fired, then the handler runs again from the start - it does not resume from where it left off.</p>
<p>How long is "too long" is browser-specific. For Chrome, the service worker is likely to be closed if:</p>
<ul>
  <li>It has been idle for 30 seconds</li>
  <li>It has been running synchronous JavaScript for 30 seconds</li>
  <li>The promise passed to <code>waitUntil()</code> has taken more than 5 minutes to settle</li>
</ul></div></section><section aria-labelledby="background_fetch"><h2 id="background_fetch"><a href="#background_fetch">Background fetch</a></h2><div class="section-content"><p>Background sync is useful for relatively short background operations, but as we just saw: if a service worker doesn't finish handling a sync event in a relatively short time, the browser will stop the service worker. This is an intentional measure to conserve battery life and protect the user's privacy by minimizing the time for which the user's IP address is exposed to the server while the app is in the background.</p>
<p>This makes background sync unsuitable for longer operations - downloading a movie, for example. For this scenario, you need the <a href="/en-US/docs/Web/API/Background_Fetch_API">Background Fetch API</a>. With background fetch, network requests can be performed while both the main app UI and the service worker are closed.</p>
<p>With background fetch:</p>
<ul>
  <li>The request is initiated from the main app UI</li>
  <li>Whether or not the main app is open, the browser displays a persistent UI element that notifies the user about the ongoing request, and enables them to cancel it or check its progress</li>
  <li>When the request is completed with success or failure, or the user has asked to check the request's progress, then the browser starts the service worker (if necessary) and fires the appropriate event in the service worker's scope.</li>
</ul></div></section><section aria-labelledby="making_a_background_fetch_request"><h3 id="making_a_background_fetch_request"><a href="#making_a_background_fetch_request">Making a background fetch request</a></h3><div class="section-content"><p>A background fetch request is initiated in the main app code, by calling <a href="/en-US/docs/Web/API/BackgroundFetchManager/fetch" title="backgroundFetch.fetch()"><code>backgroundFetch.fetch()</code></a> on the <code>ServiceWorkerRegistration</code> object, like this:</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code><span class="token comment">// main.js</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">requestBackgroundFetch</span><span class="token punctuation">(</span><span class="token parameter">movieData</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> swRegistration <span class="token operator">=</span> <span class="token keyword">await</span> navigator<span class="token punctuation">.</span>serviceWorker<span class="token punctuation">.</span>ready<span class="token punctuation">;</span>
  <span class="token keyword">const</span> fetchRegistration <span class="token operator">=</span> <span class="token keyword">await</span> swRegistration<span class="token punctuation">.</span>backgroundFetch<span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span>
    <span class="token string">"download-movie"</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">"/my-movie-part-1.webm"</span><span class="token punctuation">,</span> <span class="token string">"/my-movie-part-2.webm"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">icons</span><span class="token operator">:</span> movieIcons<span class="token punctuation">,</span>
      <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">"Downloading my movie"</span><span class="token punctuation">,</span>
      <span class="token literal-property property">downloadTotal</span><span class="token operator">:</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//...</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p>We're passing three arguments into <code>backgroundFetch.fetch()</code>:</p>
<ol>
  <li>An identifier for this fetch request</li>
  <li>An array of <a href="/en-US/docs/Web/API/Request"><code>Request</code></a> objects or URLs. A single background fetch request can include multiple network requests.</li>
  <li>An object containing data for the UI that the browser uses to show the existence and progress of the request.</li>
</ol>
<p>The <code>backgroundFetch.fetch()</code> call returns a <a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise"><code>Promise</code></a> that resolves to a <a href="/en-US/docs/Web/API/BackgroundFetchRegistration"><code>BackgroundFetchRegistration</code></a> object. This enables the main app to update its own UI as the request progresses. However, if the main app is closed, the fetch will continue in the background.</p>
<p>The browser will display a persistent UI element reminding the user that the request is ongoing, giving them the chance to find out more about the request and cancel it if they wish. The UI will include an icon and title taken from the <code>icons</code> and <code>title</code> arguments, and uses <code>downloadTotal</code> as an estimate of the total download size, to show the request's progress.</p></div></section><section aria-labelledby="handling_request_outcomes"><h3 id="handling_request_outcomes"><a href="#handling_request_outcomes">Handling request outcomes</a></h3><div class="section-content"><p>When the fetch has finished with success or failure, or the user has clicked the progress UI, then the browser starts the app's service worker, if necessary, and fires an event in the service worker's scope. The following events can be fired:</p>
<ul>
  <li><code>backgroundfetchsuccess</code>: all requests were successful</li>
  <li><code>backgroundfetchfail</code>: at least one request failed</li>
  <li><code>backgroundfetchabort</code>: the fetch was canceled by the user or by the main app</li>
  <li><code>backgroundfetchclick</code>: the user clicked on the progress UI element that the browser is showing</li>
</ul>
<h4 id="retrieving_response_data">Retrieving response data</h4>
<p>In the handlers for the <code>backgroundfetchsuccess</code>, <code>backgroundfetchfail</code>, and <code>backgroundfetchabort</code> events, the service worker can retrieve the request and response data.</p>
<p>To get the response, the event handler accesses the event's <a href="/en-US/docs/Web/API/BackgroundFetchEvent/registration" title="registration"><code>registration</code></a> property. This is a <a href="/en-US/docs/Web/API/BackgroundFetchRegistration"><code>BackgroundFetchRegistration</code></a> object, which has <a href="/en-US/docs/Web/API/BackgroundFetchRegistration/matchAll" title="matchAll()"><code>matchAll()</code></a> and <a href="/en-US/docs/Web/API/BackgroundFetchRegistration/match" title="match()"><code>match()</code></a> methods that return <a href="/en-US/docs/Web/API/BackgroundFetchRecord"><code>BackgroundFetchRecord</code></a> objects matching the given URL (or, in the case of <code>matchAll()</code> all records if no URL is given).</p>
<p>Each <code>BackgroundFetchRecord</code> has a <a href="/en-US/docs/Web/API/BackgroundFetchRecord/responseReady" title="responseReady"><code>responseReady</code></a> property that is a <code>Promise</code> which resolves with the <a href="/en-US/docs/Web/API/Response"><code>Response</code></a>, once the response is available.</p>
<p>So to access response data, the handler could do something like:</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code><span class="token comment">// service-worker.js</span>

self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"backgroundfetchsuccess"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> registration <span class="token operator">=</span> event<span class="token punctuation">.</span>registration<span class="token punctuation">;</span>

  event<span class="token punctuation">.</span><span class="token function">waitUntil</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> registration <span class="token operator">=</span> event<span class="token punctuation">.</span>registration<span class="token punctuation">;</span>
    <span class="token keyword">const</span> records <span class="token operator">=</span> <span class="token keyword">await</span> registration<span class="token punctuation">.</span><span class="token function">matchAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> responsePromises <span class="token operator">=</span> records<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>
      <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">record</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">await</span> record<span class="token punctuation">.</span>responseReady<span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> responses <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span>responsePromises<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// do something with the responses</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>Since the response data won't be available after the handler exits, the handler should store the data (for example, in the <a href="/en-US/docs/Web/API/Cache"><code>Cache</code></a>) if the app still wants it.</p>
<h4 id="updating_the_browsers_ui">Updating the browser's UI</h4>
<p>The event object passed into <code>backgroundfetchsuccess</code> and <code>backgroundfetchfail</code> also has an <a href="/en-US/docs/Web/API/BackgroundFetchUpdateUIEvent/updateUI" title="updateUI()"><code>updateUI()</code></a> method, which can be used to update the UI that the browser shows to keep the user informed about the fetch operation. With <code>updateUI()</code>, the handler can update the UI element's title and icon:</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code><span class="token comment">// service-worker.js</span>

self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"backgroundfetchsuccess"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// retrieve and store response data</span>
  <span class="token comment">// ...</span>

  event<span class="token punctuation">.</span><span class="token function">updateUI</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">"Finished your download!"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"backgroundfetchfail"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  event<span class="token punctuation">.</span><span class="token function">updateUI</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">"Could not complete download"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<h4 id="responding_to_user_interaction">Responding to user interaction</h4>
<p>The <code>backgroundfetchclick</code> event is fired when the user has clicked on the UI element that the browser shows while the fetch is ongoing.</p>
<p>The expected response here is to open a window giving the user more information about the fetch operation, which can be done from the service worker using <a href="/en-US/docs/Web/API/Clients/openWindow" title="clients.openWindow()"><code>clients.openWindow()</code></a>. For example:</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code><span class="token comment">// service-worker.js</span>

self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"backgroundfetchclick"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> registration <span class="token operator">=</span> event<span class="token punctuation">.</span>registration<span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>registration<span class="token punctuation">.</span>result <span class="token operator">===</span> <span class="token string">"success"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    clients<span class="token punctuation">.</span><span class="token function">openWindow</span><span class="token punctuation">(</span><span class="token string">"/play-movie"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    clients<span class="token punctuation">.</span><span class="token function">openWindow</span><span class="token punctuation">(</span><span class="token string">"/movie-download-progress"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div></section><section aria-labelledby="periodic_background_sync"><h2 id="periodic_background_sync"><a href="#periodic_background_sync">Periodic background sync</a></h2><div class="section-content"><p>The <a href="/en-US/docs/Web/API/Web_Periodic_Background_Synchronization_API">Periodic Background Synchronization API</a> enables a PWA to periodically update its data in the background, while the main app is closed.</p>
<p>This can greatly improve the offline experience offered by a PWA. Consider an app that depends on reasonably fresh content, like a news app. If the device is offline when the user opens the app, then even with service worker-based caching the stories will only be as fresh as the last time the app was opened. With periodic background sync, the app could have refreshed its stories in the background, when the device had connectivity, and so could be able to show relatively fresh content to the user.</p>
<p>This takes advantage of the fact that on a mobile device especially, connectivity is not poor so much as <em>intermittent</em>: by taking advantage of the times that the device has connectivity, the app can smooth over the connectivity gaps.</p></div></section><section aria-labelledby="registering_a_periodic_sync_event"><h3 id="registering_a_periodic_sync_event"><a href="#registering_a_periodic_sync_event">Registering a periodic sync event</a></h3><div class="section-content"><p>The code for registering a periodic sync event follows the same pattern as that for <a href="#registering_a_sync_event">registering a sync event</a>. The <a href="/en-US/docs/Web/API/ServiceWorkerRegistration"><code>ServiceWorkerRegistration</code></a> has a <a href="/en-US/docs/Web/API/ServiceWorkerRegistration/periodicSync" title="periodicSync"><code>periodicSync</code></a> property, which has a <a href="/en-US/docs/Web/API/PeriodicSyncManager/register" title="register()"><code>register()</code></a> method taking the name of the periodic sync as a parameter.</p>
<p>However, <code>periodicSync.register()</code> takes an extra argument, which is an object with a <code>minInterval</code> property. This represents the minimum interval, in milliseconds, between synchronization attempts:</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code><span class="token comment">// main.js</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">registerPeriodicSync</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> swRegistration <span class="token operator">=</span> <span class="token keyword">await</span> navigator<span class="token punctuation">.</span>serviceWorker<span class="token punctuation">.</span>ready<span class="token punctuation">;</span>
  swRegistration<span class="token punctuation">.</span>periodicSync<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">"update-news"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token comment">// try to update every 24 hours</span>
    <span class="token literal-property property">minInterval</span><span class="token operator">:</span> <span class="token number">24</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div></section><section aria-labelledby="handling_a_periodic_sync_event"><h3 id="handling_a_periodic_sync_event"><a href="#handling_a_periodic_sync_event">Handling a periodic sync event</a></h3><div class="section-content"><p>Although the PWA asks for a particular interval in the <code>register()</code> call, it's up to the browser how often to generate periodic sync events. Apps that users open and interact with often will be more likely to receive periodic sync events, and will receive them more often, than apps which the user rarely or never interacts with.</p>
<p>When the browser has decided to generate a periodic sync event, the pattern is the following: it starts the service worker, if necessary, and fires a <a href="/en-US/docs/Web/API/ServiceWorkerGlobalScope/periodicsync_event" title="periodicSync"><code>periodicSync</code></a> event in the service worker's global scope.</p>
<p>The service worker's event handler checks the name of the event, and calls the appropriate function inside the event's <a href="/en-US/docs/Web/API/ExtendableEvent/waitUntil" title="waitUntil()"><code>waitUntil()</code></a> method:</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code><span class="token comment">// service-worker.js</span>

self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"periodicsync"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>tag <span class="token operator">===</span> <span class="token string">"update-news"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    event<span class="token punctuation">.</span><span class="token function">waitUntil</span><span class="token punctuation">(</span><span class="token function">updateNews</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>Inside <code>updateNews()</code>, the service worker can fetch and cache the latest stories. The <code>updateNews()</code> function should complete relatively quickly: if the service worker takes too long updating its content, the browser will stop it.</p></div></section><section aria-labelledby="unregistering_a_periodic_sync"><h3 id="unregistering_a_periodic_sync"><a href="#unregistering_a_periodic_sync">Unregistering a periodic sync</a></h3><div class="section-content"><p>When the PWA no longer needs periodic background updates, (for example, because the user has switched them off in the app's settings) then the PWA should ask the browser to stop generating periodic sync events, by calling the <a href="/en-US/docs/Web/API/PeriodicSyncManager/unregister" title="unregister()"><code>unregister()</code></a> method of <a href="/en-US/docs/Web/API/ServiceWorkerRegistration/periodicSync" title="periodicSync"><code>periodicSync</code></a>:</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code><span class="token comment">// main.js</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">registerPeriodicSync</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> swRegistration <span class="token operator">=</span> <span class="token keyword">await</span> navigator<span class="token punctuation">.</span>serviceWorker<span class="token punctuation">.</span>ready<span class="token punctuation">;</span>
  swRegistration<span class="token punctuation">.</span>periodicSync<span class="token punctuation">.</span><span class="token function">unregister</span><span class="token punctuation">(</span><span class="token string">"update-news"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div></section><section aria-labelledby="push"><h2 id="push"><a href="#push">Push</a></h2><div class="section-content"><p>The <a href="/en-US/docs/Web/API/Push_API">Push API</a> enables a PWA to receive messages pushed from the server, whether the app is running or not. When the message is received by the device, the app's service worker is started and handles the message, and a <a href="/en-US/docs/Web/API/Notifications_API">notification</a> is shown to the user. The specification allows for "silent push" in which no notification is shown, but no browsers support this, because of privacy concerns (for example, that push could then be used to track a user's location).</p>
<p>Displaying a notification to the user distracts them from whatever they were doing and has the potential to be very annoying, so use push messages with care. In general, they are suitable for situations in which you need to alert the user about something, and can't wait until the next time they open your app.</p>
<p>A common use case for push notifications is chat apps: when the user receives a message from one of their contacts, it is delivered as a push message and the app shows a notification.</p>
<p>Push messages are not sent directly from the app server to the device. Instead, your app server sends messages to a push service, from which the device can retrieve them and deliver them to the app.</p>
<p>This also means that messages from your server to the push service need to be <a href="/en-US/docs/Glossary/Encryption">encrypted</a> (so the push service can't read them) and <a href="/en-US/docs/Glossary/Signature/Security">signed</a> (so the push service knows that the messages are really from your server, and not from someone impersonating your server).</p>
<p>The push service is operated by the browser vendor or by a third party, and the app server communicates with it using the <a href="https://datatracker.ietf.org/doc/html/rfc8030" class="external" target="_blank">HTTP Push</a> protocol. The app server can use a third-party library such as <a href="https://github.com/web-push-libs/web-push" class="external" target="_blank">web-push</a> to take care of the protocol details.</p></div></section><section aria-labelledby="subscribing_to_push_messages"><h3 id="subscribing_to_push_messages"><a href="#subscribing_to_push_messages">Subscribing to push messages</a></h3><div class="section-content"><p>The pattern for subscribing to push messages looks like this:</p>
<p>
  <img src="/en-US/docs/Web/Progressive_web_apps/Guides/Offline_and_background_operation/push-messaging-1.svg" alt="Diagram showing push message subscription steps" width="600" height="500" loading="lazy">
</p>
<ol>
  <li>As a prerequisite, the app server needs to be provisioned with a <a href="/en-US/docs/Glossary/Public-key_cryptography">public/private key pair</a>, so it can sign push messages. Signing messages needs to follow the <a href="https://datatracker.ietf.org/doc/html/draft-thomson-webpush-vapid-02" class="external" target="_blank">VAPID</a> specification.</li>
  <li>On the device, the app uses the <a href="/en-US/docs/Web/API/PushManager/subscribe"><code>PushManager.subscribe()</code></a> method to subscribe to messages from the server. The <code>subscribe()</code> method:
    <ul>
      <li>Takes the app server's public key as an argument: this is what the push service will use to verify the signature on messages from the app server.</li>
      <li>Returns a <code>Promise</code> that resolves to a <a href="/en-US/docs/Web/API/PushSubscription"><code>PushSubscription</code></a> object. This object includes:
        <ul>
          <li>The <a href="/en-US/docs/Web/API/PushSubscription/endpoint">endpoint</a> for the push service: this is how the app server knows where to send push messages.</li>
          <li>The <a href="/en-US/docs/Web/API/PushSubscription/getKey">public encryption key</a> that your server will use to encrypt messages to the push service.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>The app sends the endpoint and public encryption key to your server (for example, using <a href="/en-US/docs/Web/API/fetch"><code>fetch()</code></a>).</li>
</ol>
<p>After this, the app server is able to start sending push messages.</p></div></section><section aria-labelledby="sending_delivering_and_handling_push_messages"><h3 id="sending_delivering_and_handling_push_messages"><a href="#sending_delivering_and_handling_push_messages">Sending, delivering, and handling push messages</a></h3><div class="section-content"><p>When an event happens on the server that the server wants the app to handle, the server can send messages, and the sequence of steps is like this:</p>
<p>
  <img src="/en-US/docs/Web/Progressive_web_apps/Guides/Offline_and_background_operation/push-messaging-2.svg" alt="Diagram showing push message sending and delivery steps" width="700" height="600" loading="lazy">
</p>
<ol>
  <li>The app server signs the message using its private signing key and encrypts the message using the public encryption key for the push service. The app server can use a library such as <a href="https://github.com/web-push-libs/web-push" class="external" target="_blank">web-push</a> to simplify this.</li>
  <li>The app server sends the message to the endpoint for the push service, using the <a href="https://datatracker.ietf.org/doc/html/rfc8030" class="external" target="_blank">HTTP Push</a> protocol, and again optionally using a library, like web-push.</li>
  <li>The push service checks the signature on the message, and if the signature is valid, the push service queues the message for delivery.</li>
  <li>When the device has network connectivity, the push service delivers the encrypted message to the browser.</li>
  <li>When the browser receives the encrypted message, it decrypts the message.</li>
  <li>The browser starts the service worker if necessary, and fires an event called <a href="/en-US/docs/Web/API/ServiceWorkerGlobalScope/push_event" title="push"><code>push</code></a> in the service worker's global scope. The event handler is passed a <a href="/en-US/docs/Web/API/PushEvent"><code>PushEvent</code></a> object, which contains the message data.</li>
  <li>In its event handler, the service worker does any processing of the message. As usual, the event handler calls <code>event.waitUntil()</code> to ask the browser to keep the service worker running.</li>
  <li>In its event handler, the service worker creates a notification using <a href="/en-US/docs/Web/API/ServiceWorkerRegistration/showNotification" title="registration.showNotification()"><code>registration.showNotification()</code></a>.</li>
  <li>If the user clicks the notification or closes it, the <a href="/en-US/docs/Web/API/ServiceWorkerGlobalScope/notificationclick_event" title="notificationclick"><code>notificationclick</code></a> and <a href="/en-US/docs/Web/API/ServiceWorkerGlobalScope/notificationclose_event" title="notificationclose"><code>notificationclose</code></a>, respectively, are fired in the service worker's global scope. These enable the app to handle the user's response to the notification.</li>
</ol></div></section><section aria-labelledby="permissions_and_restrictions"><h2 id="permissions_and_restrictions"><a href="#permissions_and_restrictions">Permissions and restrictions</a></h2><div class="section-content"><p>Browsers have to find a balance in which they can provide powerful APIs to web developers while protecting users from malicious, exploitative, or poorly-written websites. One of the main protections they offer is that users can close the website's pages, and it's then not active on their device any more. The APIs described in this article tend to violate that assurance, so browsers have to take extra steps to help ensure that users are aware of this, and that the APIs are used in ways that align with the interests of users.</p>
<p>In this section we'll outline these steps. Several of these APIs require explicit <a href="/en-US/docs/Web/API/Permissions_API">user permission</a>, and various other restrictions and design choices to help protect users.</p>
<ul>
  <li>The Background Sync API does not need an explicit user permission, but issuing a background sync request may only be made while the main app is open, and browsers limit the number of retries and the length of time background sync operations can take.</li>
  <li>The Background Fetch API requires the <code>"background-fetch"</code> user permission, and the browser displays the ongoing progress of the fetch operation, enabling the user to cancel it.</li>
  <li>The Periodic Background Sync API requires the <code>"periodic-background-sync"</code> user permission, and browsers should allow users to disable periodic background sync completely. Also, browsers may tie the frequency of sync events to the extent to which the user chooses to interact with the app: so an app that the user rarely uses may receive few events (or even no events at all).</li>
  <li>The Push API requires the <code>"push"</code> user permission, and all browsers require push events to be user visible, meaning that they generate a user-visible notification.</li>
</ul></div></section><section aria-labelledby="see_also"><h2 id="see_also"><a href="#see_also">See also</a></h2><div class="section-content"></div></section><section aria-labelledby="reference"><h3 id="reference"><a href="#reference">Reference</a></h3><div class="section-content"><ul>
  <li><a href="/en-US/docs/Web/API/Service_Worker_API">Service Worker API</a></li>
  <li><a href="/en-US/docs/Web/API/Background_Synchronization_API">Background Synchronization API</a></li>
  <li><a href="/en-US/docs/Web/API/Background_Fetch_API">Background Fetch API</a></li>
  <li><a href="/en-US/docs/Web/API/Web_Periodic_Background_Synchronization_API">Periodic Background Synchronization API</a></li>
  <li><a href="/en-US/docs/Web/API/Push_API">Push API</a></li>
  <li><a href="/en-US/docs/Web/API/Notifications_API">Notifications API</a></li>
</ul></div></section><section aria-labelledby="guides"><h3 id="guides"><a href="#guides">Guides</a></h3><div class="section-content"><ul>
  <li><a href="https://developer.chrome.com/blog/background-sync/" class="external" target="_blank">Introducing Background Sync</a> on web.dev (2017)</li>
  <li><a href="https://developer.chrome.com/blog/background-fetch/" class="external" target="_blank">Introducing Background Fetch</a> on web.dev (2022)</li>
  <li><a href="https://developer.chrome.com/articles/periodic-background-sync/" class="external" target="_blank">The Periodic Background Sync API</a> on web.dev (2020)</li>
  <li><a href="https://web.dev/explore/notifications" class="external" target="_blank">Notifications</a> on web.dev</li>
  <li><a href="https://web.dev/articles/pwa-with-offline-streaming" class="external" target="_blank">PWA with offline streaming</a> on web.dev (2021)</li>
</ul></div></section><aside class="metadata"><div class="metadata-content-container"><div id="on-github" class="on-github"><h3>Found a content problem with this page?</h3><ul><li><a href="https://github.com/mdn/content/edit/main/files/en-us/web/progressive_web_apps/guides/offline_and_background_operation/index.md" title="This will take you to GitHub, where you&#x27;ll need to sign in first." target="_blank" rel="noopener noreferrer">Edit the page on GitHub</a>.</li><li><a href="https://github.com/mdn/content/issues/new?template=page-report.yml&amp;mdn-url=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FProgressive_web_apps%2FGuides%2FOffline_and_background_operation&amp;metadata=%3C%21--+Do+not+make+changes+below+this+line+--%3E%0A%3Cdetails%3E%0A%3Csummary%3EPage+report+details%3C%2Fsummary%3E%0A%0A*+Folder%3A+%60en-us%2Fweb%2Fprogressive_web_apps%2Fguides%2Foffline_and_background_operation%60%0A*+MDN+URL%3A+https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FProgressive_web_apps%2FGuides%2FOffline_and_background_operation%0A*+GitHub+URL%3A+https%3A%2F%2Fgithub.com%2Fmdn%2Fcontent%2Fblob%2Fmain%2Ffiles%2Fen-us%2Fweb%2Fprogressive_web_apps%2Fguides%2Foffline_and_background_operation%2Findex.md%0A*+Last+commit%3A+https%3A%2F%2Fgithub.com%2Fmdn%2Fcontent%2Fcommit%2F835d6632d59993861a0458510402787f8a2c3cb3%0A*+Document+last+modified%3A+2023-10-25T17%3A27%3A32.000Z%0A%0A%3C%2Fdetails%3E" title="This will take you to GitHub to file a new issue." target="_blank" rel="noopener noreferrer">Report the content issue</a>.</li><li><a href="https://github.com/mdn/content/blob/main/files/en-us/web/progressive_web_apps/guides/offline_and_background_operation/index.md?plain=1" title="Folder: en-us/web/progressive_web_apps/guides/offline_and_background_operation (Opens in a new tab)" target="_blank" rel="noopener noreferrer">View the source on GitHub</a>.</li></ul>Want to get more involved?<!-- --> <a href="https://github.com/mdn/content/blob/main/CONTRIBUTING.md" title="This will take you to our contribution guidelines on GitHub." target="_blank" rel="noopener noreferrer">Learn how to contribute</a>.</div><p class="last-modified-date">This page was last modified on<!-- --> <time dateTime="2023-10-25T17:27:32.000Z">Oct 26, 2023</time> by<!-- --> <a href="/en-US/docs/Web/Progressive_web_apps/Guides/Offline_and_background_operation/contributors.txt">MDN contributors</a>.</p></div></aside></article></main></div></div><footer id="nav-footer" class="page-footer"><div class="page-footer-grid"><div class="page-footer-logo-col"><a href="/" class="mdn-footer-logo" aria-label="MDN homepage"><svg width="48" height="17" viewBox="0 0 48 17" fill="none" xmlns="http://www.w3.org/2000/svg"><title id="mdn-footer-logo-svg">MDN logo</title><path d="M20.04 16.512H15.504V10.416C15.504 9.488 15.344 8.824 15.024 8.424C14.72 8.024 14.264 7.824 13.656 7.824C12.92 7.824 12.384 8.064 12.048 8.544C11.728 9.024 11.568 9.64 11.568 10.392V14.184H13.008V16.512H8.472V10.416C8.472 9.488 8.312 8.824 7.992 8.424C7.688 8.024 7.232 7.824 6.624 7.824C5.872 7.824 5.336 8.064 5.016 8.544C4.696 9.024 4.536 9.64 4.536 10.392V14.184H6.6V16.512H0V14.184H1.44V8.04H0.024V5.688H4.536V7.32C5.224 6.088 6.32 5.472 7.824 5.472C8.608 5.472 9.328 5.664 9.984 6.048C10.64 6.432 11.096 7.016 11.352 7.8C11.992 6.248 13.168 5.472 14.88 5.472C15.856 5.472 16.72 5.776 17.472 6.384C18.224 6.992 18.6 7.936 18.6 9.216V14.184H20.04V16.512Z" fill="currentColor"></path><path d="M33.6714 16.512H29.1354V14.496C28.8314 15.12 28.3834 15.656 27.7914 16.104C27.1994 16.536 26.4154 16.752 25.4394 16.752C24.0154 16.752 22.8954 16.264 22.0794 15.288C21.2634 14.312 20.8554 12.984 20.8554 11.304C20.8554 9.688 21.2554 8.312 22.0554 7.176C22.8554 6.04 24.0634 5.472 25.6794 5.472C26.5594 5.472 27.2794 5.648 27.8394 6C28.3994 6.352 28.8314 6.8 29.1354 7.344V2.352H26.9754V0H32.2314V14.184H33.6714V16.512ZM29.1354 11.04V10.776C29.1354 9.88 28.8954 9.184 28.4154 8.688C27.9514 8.176 27.3674 7.92 26.6634 7.92C25.9754 7.92 25.3674 8.176 24.8394 8.688C24.3274 9.2 24.0714 10.008 24.0714 11.112C24.0714 12.152 24.3114 12.944 24.7914 13.488C25.2714 14.032 25.8394 14.304 26.4954 14.304C27.3114 14.304 27.9514 13.96 28.4154 13.272C28.8954 12.584 29.1354 11.84 29.1354 11.04Z" fill="currentColor"></path><path d="M47.9589 16.512H41.9829V14.184H43.4229V10.416C43.4229 9.488 43.2629 8.824 42.9429 8.424C42.6389 8.024 42.1829 7.824 41.5749 7.824C40.8389 7.824 40.2709 8.056 39.8709 8.52C39.4709 8.968 39.2629 9.56 39.2469 10.296V14.184H40.6869V16.512H34.7109V14.184H36.1509V8.04H34.5909V5.688H39.2469V7.344C39.9669 6.096 41.1269 5.472 42.7269 5.472C43.7509 5.472 44.6389 5.776 45.3909 6.384C46.1429 6.992 46.5189 7.936 46.5189 9.216V14.184H47.9589V16.512Z" fill="currentColor"></path></svg></a><p>Your blueprint for a better internet.</p><ul class="social-icons"><li><a class="icon icon-mastodon" href="https://mozilla.social/@mdn" target="_blank" rel="me noopener noreferrer"><span class="visually-hidden">MDN on Mastodon</span></a></li><li><a class="icon icon-twitter" href="https://twitter.com/mozdevnet" target="_blank" rel="noopener noreferrer"><span class="visually-hidden">MDN on Twitter</span></a></li><li><a class="icon icon-github-mark-small" href="https://github.com/mdn/" target="_blank" rel="noopener noreferrer"><span class="visually-hidden">MDN on GitHub</span></a></li><li><a class="icon icon-feed" href="/en-US/blog/rss.xml" target="_blank"><span class="visually-hidden">MDN Blog RSS Feed</span></a></li></ul></div><div class="page-footer-nav-col-1"><h2 class="footer-nav-heading">MDN</h2><ul class="footer-nav-list"><li class="footer-nav-item"><a href="/en-US/about">About</a></li><li class="footer-nav-item"><a href="/en-US/blog/">Blog</a></li><li class="footer-nav-item"><a href="https://www.mozilla.org/en-US/careers/listings/?team=ProdOps" target="_blank" rel="noopener noreferrer">Careers</a></li><li class="footer-nav-item"><a href="/en-US/advertising">Advertise with us</a></li></ul></div><div class="page-footer-nav-col-2"><h2 class="footer-nav-heading">Support</h2><ul class="footer-nav-list"><li class="footer-nav-item"><a class="footer-nav-link" href="/en-US/docs/MDN/Community/Issues">Report an issue</a></li></ul></div><div class="page-footer-nav-col-3"><h2 class="footer-nav-heading">Our communities</h2><ul class="footer-nav-list"><li class="footer-nav-item"><a class="footer-nav-link" href="/en-US/community">MDN Community</a></li><li class="footer-nav-item"><a class="footer-nav-link" href="https://discourse.mozilla.org/c/mdn/236" target="_blank" rel="noopener noreferrer">MDN Forum</a></li><li class="footer-nav-item"><a class="footer-nav-link" href="/discord" target="_blank" rel="noopener noreferrer">MDN Chat</a></li></ul></div><div class="page-footer-nav-col-4"><h2 class="footer-nav-heading">Developers</h2><ul class="footer-nav-list"><li class="footer-nav-item"><a class="footer-nav-link" href="/en-US/docs/Web">Web Technologies</a></li><li class="footer-nav-item"><a class="footer-nav-link" href="/en-US/docs/Learn">Learn Web Development</a></li><li class="footer-nav-item"><a href="https://hacks.mozilla.org/" target="_blank" rel="noopener noreferrer">Hacks Blog</a></li></ul></div><div class="page-footer-moz"><a href="https://www.mozilla.org/" class="footer-moz-logo-link" target="_blank" rel="noopener noreferrer"><svg width="112" height="32" fill="none" xmlns="http://www.w3.org/2000/svg"><title id="mozilla-footer-logo-svg">Mozilla logo</title><path d="M41.753 14.218c-2.048 0-3.324 1.522-3.324 4.157 0 2.423 1.119 4.286 3.29 4.286 2.082 0 3.447-1.678 3.447-4.347 0-2.826-1.522-4.096-3.413-4.096Zm54.89 7.044c0 .901.437 1.618 1.645 1.618 1.427 0 2.949-1.024 3.044-3.352-.649-.095-1.365-.185-2.02-.185-1.426-.005-2.668.397-2.668 1.92Z" fill="currentColor"></path><path d="M0 0v32h111.908V0H0Zm32.56 25.426h-5.87v-7.884c0-2.423-.806-3.352-2.39-3.352-1.924 0-2.702 1.365-2.702 3.324v4.868h1.864v3.044h-5.864v-7.884c0-2.423-.806-3.352-2.39-3.352-1.924 0-2.702 1.365-2.702 3.324v4.868h2.669v3.044H6.642v-3.044h1.863v-7.918H6.642V11.42h5.864v2.11c.839-1.489 2.3-2.39 4.252-2.39 2.02 0 3.878.963 4.566 3.01.778-1.862 2.361-3.01 4.566-3.01 2.512 0 4.812 1.522 4.812 4.84v6.402h1.863v3.044h-.005Zm9.036.307c-4.314 0-7.296-2.635-7.296-7.106 0-4.096 2.484-7.481 7.514-7.481s7.481 3.38 7.481 7.29c0 4.472-3.228 7.297-7.699 7.297Zm22.578-.307H51.942l-.403-2.11 7.7-8.846h-4.376l-.621 2.17-2.888-.313.498-4.907h12.294l.313 2.11-7.767 8.852h4.533l.654-2.172 3.167.308-.872 4.908Zm7.99 0h-4.191v-5.03h4.19v5.03Zm0-8.976h-4.191v-5.03h4.19v5.03Zm2.618 8.976 6.054-21.358h3.945l-6.054 21.358h-3.945Zm8.136 0 6.048-21.358h3.945l-6.054 21.358h-3.939Zm21.486.307c-1.863 0-2.887-1.085-3.072-2.792-.805 1.427-2.232 2.792-4.498 2.792-2.02 0-4.314-1.085-4.314-4.006 0-3.447 3.323-4.253 6.518-4.253.778 0 1.584.034 2.3.124v-.465c0-1.427-.034-3.133-2.3-3.133-.84 0-1.488.061-2.143.402l-.453 1.578-3.195-.34.549-3.224c2.45-.996 3.692-1.27 5.992-1.27 3.01 0 5.556 1.55 5.556 4.75v6.083c0 .805.314 1.085.963 1.085.184 0 .375-.034.587-.095l.034 2.11a5.432 5.432 0 0 1-2.524.654Z" fill="currentColor"></path></svg></a><ul class="footer-moz-list"><li class="footer-moz-item"><a href="https://www.mozilla.org/privacy/websites/" class="footer-moz-link" target="_blank" rel="noopener noreferrer">Website Privacy Notice</a></li><li class="footer-moz-item"><a href="https://www.mozilla.org/privacy/websites/#cookies" class="footer-moz-link" target="_blank" rel="noopener noreferrer">Cookies</a></li><li class="footer-moz-item"><a href="https://www.mozilla.org/about/legal/terms/mozilla" class="footer-moz-link" target="_blank" rel="noopener noreferrer">Legal</a></li><li class="footer-moz-item"><a href="https://www.mozilla.org/about/governance/policies/participation/" class="footer-moz-link" target="_blank" rel="noopener noreferrer">Community Participation Guidelines</a></li></ul></div><div class="page-footer-legal"><p id="license" class="page-footer-legal-text">Visit<!-- --> <a href="https://www.mozilla.org" target="_blank" rel="noopener noreferrer">Mozilla Corporation’s</a> <!-- -->not-for-profit parent, the<!-- --> <a target="_blank" rel="noopener noreferrer" href="https://foundation.mozilla.org/">Mozilla Foundation</a>.<br/>Portions of this content are ©1998–<!-- -->2023<!-- --> by individual mozilla.org contributors. Content available under<!-- --> <a href="/en-US/docs/MDN/Writing_guidelines/Attrib_copyright_license">a Creative Commons license</a>.</p></div></div></footer></div><script type="application/json" id="hydration">{"doc":{"isMarkdown":true,"isTranslated":false,"isActive":true,"flaws":{},"title":"Offline and background operation","mdn_url":"/en-US/docs/Web/Progressive_web_apps/Guides/Offline_and_background_operation","locale":"en-US","native":"English (US)","sidebarHTML":"<ol><li><a href=\"/en-US/docs/Web/Progressive_web_apps\"><strong>Progressive web apps</strong></a></li><li><a href=\"/en-US/docs/Web/Progressive_web_apps/Guides\"><strong>Guides</strong></a></li><li><a href=\"/en-US/docs/Web/Progressive_web_apps/Guides/What_is_a_progressive_web_app\">What is a progressive web app?</a></li><li><a href=\"/en-US/docs/Web/Progressive_web_apps/Guides/Installing\">Installing and uninstalling web apps</a></li><li><a href=\"/en-US/docs/Web/Progressive_web_apps/Guides/Making_PWAs_installable\">Making PWAs installable</a></li><li><em><a href=\"/en-US/docs/Web/Progressive_web_apps/Guides/Offline_and_background_operation\" aria-current=\"page\">Offline and background operation</a></em></li><li><a href=\"/en-US/docs/Web/Progressive_web_apps/Guides/Caching\">Caching</a></li><li><a href=\"/en-US/docs/Web/Progressive_web_apps/Guides/Best_practices\">Best practices for PWAs</a></li><li><a href=\"/en-US/docs/Web/Progressive_web_apps/Tutorials\"><strong>Tutorials</strong></a></li><li><ol><li><details><summary>CycleTracker</summary><ol><li><a href=\"/en-US/docs/Web/Progressive_web_apps/Tutorials/CycleTracker\">CycleTracker</a></li><li><a href=\"/en-US/docs/Web/Progressive_web_apps/Tutorials/CycleTracker/HTML_and_CSS\">Base HTML and CSS</a></li><li><a href=\"/en-US/docs/Web/Progressive_web_apps/Tutorials/CycleTracker/Secure_connection\">Secure connection</a></li><li><a href=\"/en-US/docs/Web/Progressive_web_apps/Tutorials/CycleTracker/JavaScript_functionality\">JavaScript functionality</a></li><li><a href=\"/en-US/docs/Web/Progressive_web_apps/Tutorials/CycleTracker/Manifest_file\">Manifest and iconography</a></li><li><a href=\"/en-US/docs/Web/Progressive_web_apps/Tutorials/CycleTracker/Service_workers\">Service workers</a></li></ol></details></li></ol></li><li><ol><li><details><summary>js13kGames</summary><ol><li><a href=\"/en-US/docs/Web/Progressive_web_apps/Tutorials/js13kGames\">js13kGames</a></li><li><a href=\"/en-US/docs/Web/Progressive_web_apps/Tutorials/js13kGames/App_structure\">Progressive web app structure</a></li><li><a href=\"/en-US/docs/Web/Progressive_web_apps/Tutorials/js13kGames/Offline_Service_workers\">Making PWAs work offline with Service workers</a></li><li><a href=\"/en-US/docs/Web/Progressive_web_apps/Tutorials/js13kGames/Installable_PWAs\">How to make PWAs installable</a></li><li><a href=\"/en-US/docs/Web/Progressive_web_apps/Tutorials/js13kGames/Re-engageable_Notifications_Push\">How to make PWAs re-engageable using Notifications and Push</a></li><li><a href=\"/en-US/docs/Web/Progressive_web_apps/Tutorials/js13kGames/Loading\">Progressive loading</a></li></ol></details></li></ol></li><li><a href=\"/en-US/docs/Web/Progressive_web_apps/How_to\"><strong>How to</strong></a></li><li><a href=\"/en-US/docs/Web/Progressive_web_apps/How_to/Trigger_install_prompt\">Trigger installation from your PWA</a></li><li><a href=\"/en-US/docs/Web/Progressive_web_apps/How_to/Define_app_icons\">Define your app icons</a></li><li><a href=\"/en-US/docs/Web/Progressive_web_apps/How_to/Create_a_standalone_app\">Create a standalone app</a></li><li><a href=\"/en-US/docs/Web/Progressive_web_apps/How_to/Customize_your_app_colors\">Customize your app's theme and background colors</a></li><li><a href=\"/en-US/docs/Web/Progressive_web_apps/How_to/Display_badge_on_app_icon\">Display a badge on the app icon</a></li><li><a href=\"/en-US/docs/Web/Progressive_web_apps/How_to/Expose_common_actions_as_shortcuts\">Expose common app actions as shortcuts</a></li><li><a href=\"/en-US/docs/Web/Progressive_web_apps/How_to/Share_data_between_apps\">Share data between apps</a></li><li><a href=\"/en-US/docs/Web/Progressive_web_apps/How_to/Associate_files_with_your_PWA\">Associate files with your PWA</a></li><li><a href=\"/en-US/docs/Web/Progressive_web_apps/Reference\"><strong>Reference</strong></a></li></ol>","sidebarMacro":"PWASidebar","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p>Usually, websites are very dependent on both reliable network connectivity and on the user having their pages open in a browser. Without network connectivity, most websites are just unusable, and if the user does not have the site open in a browser tab, most websites are unable to do anything.</p>\n<p>However, consider the following scenarios:</p>\n<ul>\n  <li>A music app enables the user to stream music while online, but can download tracks in the background and then continue to play while the user is offline.</li>\n  <li>The user composes a long email, presses \"Send\", and then loses network connectivity. The device sends the email in the background, as soon as the network is available again.</li>\n  <li>The user's chat app receives a message from one of their contacts, and although the app is not open, it displays a badge on the app icon to let the user know they have a new message.</li>\n</ul>\n<p>These are the kinds of features that users expect from installed apps. In this guide, we'll introduce a set of technologies that enable a PWA to:</p>\n<ul>\n  <li>Provide a good user experience even when the device has intermittent network connectivity</li>\n  <li>Update its state when the app is not running</li>\n  <li>Notify the user about important events that have happened while the app was not running</li>\n</ul>\n<p>The technologies introduced in this guide are:</p>\n<ul>\n  <li><a href=\"/en-US/docs/Web/API/Service_Worker_API\">Service Worker API</a></li>\n  <li><a href=\"/en-US/docs/Web/API/Background_Synchronization_API\">Background Synchronization API</a></li>\n  <li><a href=\"/en-US/docs/Web/API/Background_Fetch_API\">Background Fetch API</a></li>\n  <li><a href=\"/en-US/docs/Web/API/Web_Periodic_Background_Synchronization_API\">Periodic Background Synchronization API</a></li>\n  <li><a href=\"/en-US/docs/Web/API/Push_API\">Push API</a></li>\n  <li><a href=\"/en-US/docs/Web/API/Notifications_API\">Notifications API</a></li>\n</ul>"}},{"type":"prose","value":{"id":"websites_and_workers","title":"Websites and workers","isH3":false,"content":"<p>The foundation of all the technologies we'll discuss in this guide is the <em>service worker</em>. In this section we'll provide a little background about workers and how they change the architecture of a web app.</p>\n<p>Normally, an entire website runs in a single thread. This includes the website's own JavaScript, and all the work to render the website's UI. One consequence of this is that if your JavaScript runs some long-running operation, the website's main UI is blocked, and the website appears unresponsive to the user.</p>\n<p>A <a href=\"/en-US/docs/Web/API/Service_Worker_API\">service worker</a> is a specific type of <a href=\"/en-US/docs/Web/API/Web_Workers_API\">web worker</a> that's used to implement PWAs. Like all web workers, a service worker runs in a separate thread to the main JavaScript code. The main code creates the worker, passing in a URL to the worker's script. The worker and the main code can't directly access each other's state, but can communicate by sending each other messages. Workers can be used to run computationally expensive tasks in the background: because they run in a separate thread, the main JavaScript code in the app, that implements the app's UI, can stay responsive to the user.</p>\n<p>So a PWA always has a high level architecture split between:</p>\n<ul>\n  <li>The <em>main app</em>, with the HTML, CSS, and the part of the JavaScript that implements the app's UI (by handling user events, for example)</li>\n  <li>The <em>service worker</em>, which handles offline and background tasks</li>\n</ul>\n<p>In this guide, when we show code samples, we'll indicate which part of the app the code belongs in with a comment like <code>// main.js</code> or <code>// service-worker.js</code>.</p>"}},{"type":"prose","value":{"id":"offline_operation","title":"Offline operation","isH3":false,"content":"<p>Offline operation allows a PWA to provide a good user experience even when the device does not have network connectivity. This is enabled by adding a service worker to an app.</p>\n<p>A service worker <em>controls</em> some or all of the app's pages. When the service worker is installed, it can fetch the resources from the server for the pages it controls (including pages, styles, scripts, and images, for example) and add them to a local cache. The <a href=\"/en-US/docs/Web/API/Cache\"><code>Cache</code></a> interface is used to add resources to the cache. <code>Cache</code> instances are accessible through the <a href=\"/en-US/docs/Web/API/caches\"><code>caches</code></a> property in the service worker global scope.</p>\n<p>Then whenever the app requests a resource (for example, because the user opened the app or clicked an internal link), the browser fires an event called <a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope/fetch_event\" title=\"fetch\"><code>fetch</code></a> in the service worker's global scope. By listening for this event, the service worker can intercept the request.</p>\n<p>The event handler for the <code>fetch</code> event is passed a <a href=\"/en-US/docs/Web/API/FetchEvent\"><code>FetchEvent</code></a> object, which:</p>\n<ul>\n  <li>Provides access to the request as a <a href=\"/en-US/docs/Web/API/Request\"><code>Request</code></a> instance</li>\n  <li>Provides a <a href=\"/en-US/docs/Web/API/FetchEvent/respondWith\" title=\"respondWith()\"><code>respondWith()</code></a> method to send a response to the request.</li>\n</ul>\n<p>One way a service worker can handle requests is a \"cache-first\" strategy. In this strategy:</p>\n<ol>\n  <li>If the requested resource exists in the cache, get the resource from the cache and return the resource to the app.</li>\n  <li>If the requested resource does not exist in the cache, try to fetch the resource from the network.\n    <ol>\n      <li>If the resource could be fetched, add the resource to the cache for next time, and return the resource to the app.</li>\n      <li>If the resource could not be fetched, return some default fallback resource.</li>\n    </ol>\n  </li>\n</ol>\n<p>The following code sample shows an implementation of this:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// service-worker.js</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">putInCache</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">request<span class=\"token punctuation\">,</span> response</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> cache <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> caches<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"v1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">await</span> cache<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> response<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">cacheFirst</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> request<span class=\"token punctuation\">,</span> fallbackUrl <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// First try to get the resource from the cache.</span>\n  <span class=\"token keyword\">const</span> responseFromCache <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> caches<span class=\"token punctuation\">.</span><span class=\"token function\">match</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>responseFromCache<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> responseFromCache<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// If the response was not found in the cache,</span>\n  <span class=\"token comment\">// try to get the resource from the network.</span>\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> responseFromNetwork <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// If the network request succeeded, clone the response:</span>\n    <span class=\"token comment\">// - put one copy in the cache, for the next time</span>\n    <span class=\"token comment\">// - return the original to the app</span>\n    <span class=\"token comment\">// Cloning is needed because a response can only be consumed once.</span>\n    <span class=\"token function\">putInCache</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> responseFromNetwork<span class=\"token punctuation\">.</span><span class=\"token function\">clone</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> responseFromNetwork<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// If the network request failed,</span>\n    <span class=\"token comment\">// get the fallback response from the cache.</span>\n    <span class=\"token keyword\">const</span> fallbackResponse <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> caches<span class=\"token punctuation\">.</span><span class=\"token function\">match</span><span class=\"token punctuation\">(</span>fallbackUrl<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>fallbackResponse<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> fallbackResponse<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">// When even the fallback response is not available,</span>\n    <span class=\"token comment\">// there is nothing we can do, but we must always</span>\n    <span class=\"token comment\">// return a Response object.</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Response</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Network error happened\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">status</span><span class=\"token operator\">:</span> <span class=\"token number\">408</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">headers</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token string-property property\">\"Content-Type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"text/plain\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\nself<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"fetch\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  event<span class=\"token punctuation\">.</span><span class=\"token function\">respondWith</span><span class=\"token punctuation\">(</span>\n    <span class=\"token function\">cacheFirst</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">request</span><span class=\"token operator\">:</span> event<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">fallbackUrl</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/fallback.html\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>This means that in many situations, the web app will function well even if network connectivity is intermittent. From the point of view of the main app code, it is completely transparent: the app just makes network requests and gets responses. Also, because the service worker is in a separate thread, the main app code can stay responsive to user input while resources are fetched and cached.</p>\n<div class=\"notecard note\" id=\"sect1\">\n  <p><strong>Note:</strong> The strategy described here is just one way a service worker could implement caching. Specifically, in a cache first strategy, we check the cache first before the network, meaning that we are more likely to return a quick response without incurring a network cost, but are more likely to return a stale response.</p>\n  <p>An alternative would be a <em>network first</em> strategy, in which we try to fetch the resource from the server first, and fall back to the cache if the device is offline.</p>\n  <p>The optimal caching strategy is dependent on the particular web app and how it is used.</p>\n</div>\n<p>For much more detail about setting up service workers and using them to add offline functionality, see our <a href=\"/en-US/docs/Web/API/Service_Worker_API/Using_Service_Workers\">guide to using service workers</a>.</p>"}},{"type":"prose","value":{"id":"background_operation","title":"Background operation","isH3":false,"content":"<p>While offline operations are the most common use for service workers, they also enable a PWA to operate even while the main app is closed. This is possible because the service worker can run while the main app is not running.</p>\n<p>This doesn't mean service workers run all the time: browsers may stop service workers when they think it is appropriate. For example, if a service worker has been inactive for a while, it will be stopped. However, the browser will restart the service worker when an event has happened that it needs to take care of. This enables a PWA to implement background operations in the following way:</p>\n<ul>\n  <li>In the main app, register a request for the service worker to perform some operation</li>\n  <li>At the appropriate time, the service worker will be restarted if necessary, and an event will fire in the service worker's scope</li>\n  <li>The service worker will perform the operation</li>\n</ul>\n<p>In the next sections, we'll discuss a few different features that use this pattern to enable a PWA to work while the main app isn't open.</p>"}},{"type":"prose","value":{"id":"background_sync","title":"Background sync","isH3":false,"content":"<p>Suppose a user composes an email and presses \"Send\". In a traditional website, they must keep the tab open until the app has sent the email: if they close the tab, or the device loses connectivity, then the message will not be sent. Background sync, defined in the <a href=\"/en-US/docs/Web/API/Background_Synchronization_API\">Background Synchronization API</a>, is the solution to this problem for PWAs.</p>\n<p>Background sync enables the app to ask its service worker to perform a task on its behalf. As soon as the device has network connectivity, the browser will restart the service worker, if necessary, and fire an event named <a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope/sync_event\"><code>sync</code></a> in the service worker's scope. The service worker can then attempt to execute the task. If the task can't be completed, then the browser may retry a limited number of times by firing the event again.</p>"}},{"type":"prose","value":{"id":"registering_a_sync_event","title":"Registering a sync event","isH3":true,"content":"<p>To ask the service worker to perform a task, the main app can access <a href=\"/en-US/docs/Web/API/ServiceWorkerContainer/ready\" title=\"navigator.serviceWorker.ready\"><code>navigator.serviceWorker.ready</code></a>, which resolves with a <a href=\"/en-US/docs/Web/API/ServiceWorkerRegistration\"><code>ServiceWorkerRegistration</code></a> object. The app then calls <a href=\"/en-US/docs/Web/API/SyncManager/register\" title=\"sync.register()\"><code>sync.register()</code></a> on the <code>ServiceWorkerRegistration</code> object, like this:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// main.js</span>\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">registerSync</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> swRegistration <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> navigator<span class=\"token punctuation\">.</span>serviceWorker<span class=\"token punctuation\">.</span>ready<span class=\"token punctuation\">;</span>\n  swRegistration<span class=\"token punctuation\">.</span>sync<span class=\"token punctuation\">.</span><span class=\"token function\">register</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"send-message\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>Note that the app passes a name for the task: <code>\"send-message\"</code> in this case.</p>"}},{"type":"prose","value":{"id":"handling_a_sync_event","title":"Handling a sync event","isH3":true,"content":"<p>As soon as the device has network connectivity, the <code>sync</code> event fires in the service worker scope. The service worker checks the name of the task and runs the appropriate function, <code>sendMessage()</code> in this case:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// service-worker.js</span>\n\nself<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"sync\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>tag <span class=\"token operator\">==</span> <span class=\"token string\">\"send-message\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    event<span class=\"token punctuation\">.</span><span class=\"token function\">waitUntil</span><span class=\"token punctuation\">(</span><span class=\"token function\">sendMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Note that we pass the result of the <code>sendMessage()</code> function into the event's <a href=\"/en-US/docs/Web/API/ExtendableEvent/waitUntil\" title=\"waitUntil()\"><code>waitUntil()</code></a> method. The <code>waitUntil()</code> method takes a <a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise\"><code>Promise</code></a> as a parameter and asks the browser not to stop the service worker until the promise has settled. This is also how the browser knows whether the operation succeeded or not: if the promise rejects, then the browser may retry by firing the <code>sync</code> event again.</p>\n<p>The <code>waitUntil()</code> method is not a guarantee that the browser will not stop the service worker: if the operation takes too long, the service worker will be stopped anyway. If this happens, then the operation is aborted, and next time a <code>sync</code> event is fired, then the handler runs again from the start - it does not resume from where it left off.</p>\n<p>How long is \"too long\" is browser-specific. For Chrome, the service worker is likely to be closed if:</p>\n<ul>\n  <li>It has been idle for 30 seconds</li>\n  <li>It has been running synchronous JavaScript for 30 seconds</li>\n  <li>The promise passed to <code>waitUntil()</code> has taken more than 5 minutes to settle</li>\n</ul>"}},{"type":"prose","value":{"id":"background_fetch","title":"Background fetch","isH3":false,"content":"<p>Background sync is useful for relatively short background operations, but as we just saw: if a service worker doesn't finish handling a sync event in a relatively short time, the browser will stop the service worker. This is an intentional measure to conserve battery life and protect the user's privacy by minimizing the time for which the user's IP address is exposed to the server while the app is in the background.</p>\n<p>This makes background sync unsuitable for longer operations - downloading a movie, for example. For this scenario, you need the <a href=\"/en-US/docs/Web/API/Background_Fetch_API\">Background Fetch API</a>. With background fetch, network requests can be performed while both the main app UI and the service worker are closed.</p>\n<p>With background fetch:</p>\n<ul>\n  <li>The request is initiated from the main app UI</li>\n  <li>Whether or not the main app is open, the browser displays a persistent UI element that notifies the user about the ongoing request, and enables them to cancel it or check its progress</li>\n  <li>When the request is completed with success or failure, or the user has asked to check the request's progress, then the browser starts the service worker (if necessary) and fires the appropriate event in the service worker's scope.</li>\n</ul>"}},{"type":"prose","value":{"id":"making_a_background_fetch_request","title":"Making a background fetch request","isH3":true,"content":"<p>A background fetch request is initiated in the main app code, by calling <a href=\"/en-US/docs/Web/API/BackgroundFetchManager/fetch\" title=\"backgroundFetch.fetch()\"><code>backgroundFetch.fetch()</code></a> on the <code>ServiceWorkerRegistration</code> object, like this:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// main.js</span>\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">requestBackgroundFetch</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">movieData</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> swRegistration <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> navigator<span class=\"token punctuation\">.</span>serviceWorker<span class=\"token punctuation\">.</span>ready<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> fetchRegistration <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> swRegistration<span class=\"token punctuation\">.</span>backgroundFetch<span class=\"token punctuation\">.</span><span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span>\n    <span class=\"token string\">\"download-movie\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token string\">\"/my-movie-part-1.webm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"/my-movie-part-2.webm\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">icons</span><span class=\"token operator\">:</span> movieIcons<span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">title</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Downloading my movie\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">downloadTotal</span><span class=\"token operator\">:</span> <span class=\"token number\">60</span> <span class=\"token operator\">*</span> <span class=\"token number\">1024</span> <span class=\"token operator\">*</span> <span class=\"token number\">1024</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">//...</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>We're passing three arguments into <code>backgroundFetch.fetch()</code>:</p>\n<ol>\n  <li>An identifier for this fetch request</li>\n  <li>An array of <a href=\"/en-US/docs/Web/API/Request\"><code>Request</code></a> objects or URLs. A single background fetch request can include multiple network requests.</li>\n  <li>An object containing data for the UI that the browser uses to show the existence and progress of the request.</li>\n</ol>\n<p>The <code>backgroundFetch.fetch()</code> call returns a <a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise\"><code>Promise</code></a> that resolves to a <a href=\"/en-US/docs/Web/API/BackgroundFetchRegistration\"><code>BackgroundFetchRegistration</code></a> object. This enables the main app to update its own UI as the request progresses. However, if the main app is closed, the fetch will continue in the background.</p>\n<p>The browser will display a persistent UI element reminding the user that the request is ongoing, giving them the chance to find out more about the request and cancel it if they wish. The UI will include an icon and title taken from the <code>icons</code> and <code>title</code> arguments, and uses <code>downloadTotal</code> as an estimate of the total download size, to show the request's progress.</p>"}},{"type":"prose","value":{"id":"handling_request_outcomes","title":"Handling request outcomes","isH3":true,"content":"<p>When the fetch has finished with success or failure, or the user has clicked the progress UI, then the browser starts the app's service worker, if necessary, and fires an event in the service worker's scope. The following events can be fired:</p>\n<ul>\n  <li><code>backgroundfetchsuccess</code>: all requests were successful</li>\n  <li><code>backgroundfetchfail</code>: at least one request failed</li>\n  <li><code>backgroundfetchabort</code>: the fetch was canceled by the user or by the main app</li>\n  <li><code>backgroundfetchclick</code>: the user clicked on the progress UI element that the browser is showing</li>\n</ul>\n<h4 id=\"retrieving_response_data\">Retrieving response data</h4>\n<p>In the handlers for the <code>backgroundfetchsuccess</code>, <code>backgroundfetchfail</code>, and <code>backgroundfetchabort</code> events, the service worker can retrieve the request and response data.</p>\n<p>To get the response, the event handler accesses the event's <a href=\"/en-US/docs/Web/API/BackgroundFetchEvent/registration\" title=\"registration\"><code>registration</code></a> property. This is a <a href=\"/en-US/docs/Web/API/BackgroundFetchRegistration\"><code>BackgroundFetchRegistration</code></a> object, which has <a href=\"/en-US/docs/Web/API/BackgroundFetchRegistration/matchAll\" title=\"matchAll()\"><code>matchAll()</code></a> and <a href=\"/en-US/docs/Web/API/BackgroundFetchRegistration/match\" title=\"match()\"><code>match()</code></a> methods that return <a href=\"/en-US/docs/Web/API/BackgroundFetchRecord\"><code>BackgroundFetchRecord</code></a> objects matching the given URL (or, in the case of <code>matchAll()</code> all records if no URL is given).</p>\n<p>Each <code>BackgroundFetchRecord</code> has a <a href=\"/en-US/docs/Web/API/BackgroundFetchRecord/responseReady\" title=\"responseReady\"><code>responseReady</code></a> property that is a <code>Promise</code> which resolves with the <a href=\"/en-US/docs/Web/API/Response\"><code>Response</code></a>, once the response is available.</p>\n<p>So to access response data, the handler could do something like:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// service-worker.js</span>\n\nself<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"backgroundfetchsuccess\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> registration <span class=\"token operator\">=</span> event<span class=\"token punctuation\">.</span>registration<span class=\"token punctuation\">;</span>\n\n  event<span class=\"token punctuation\">.</span><span class=\"token function\">waitUntil</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> registration <span class=\"token operator\">=</span> event<span class=\"token punctuation\">.</span>registration<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> records <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> registration<span class=\"token punctuation\">.</span><span class=\"token function\">matchAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> responsePromises <span class=\"token operator\">=</span> records<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>\n      <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">record</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token keyword\">await</span> record<span class=\"token punctuation\">.</span>responseReady<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">const</span> responses <span class=\"token operator\">=</span> Promise<span class=\"token punctuation\">.</span><span class=\"token function\">all</span><span class=\"token punctuation\">(</span>responsePromises<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// do something with the responses</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Since the response data won't be available after the handler exits, the handler should store the data (for example, in the <a href=\"/en-US/docs/Web/API/Cache\"><code>Cache</code></a>) if the app still wants it.</p>\n<h4 id=\"updating_the_browsers_ui\">Updating the browser's UI</h4>\n<p>The event object passed into <code>backgroundfetchsuccess</code> and <code>backgroundfetchfail</code> also has an <a href=\"/en-US/docs/Web/API/BackgroundFetchUpdateUIEvent/updateUI\" title=\"updateUI()\"><code>updateUI()</code></a> method, which can be used to update the UI that the browser shows to keep the user informed about the fetch operation. With <code>updateUI()</code>, the handler can update the UI element's title and icon:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// service-worker.js</span>\n\nself<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"backgroundfetchsuccess\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// retrieve and store response data</span>\n  <span class=\"token comment\">// ...</span>\n\n  event<span class=\"token punctuation\">.</span><span class=\"token function\">updateUI</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">title</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Finished your download!\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nself<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"backgroundfetchfail\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  event<span class=\"token punctuation\">.</span><span class=\"token function\">updateUI</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">title</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Could not complete download\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<h4 id=\"responding_to_user_interaction\">Responding to user interaction</h4>\n<p>The <code>backgroundfetchclick</code> event is fired when the user has clicked on the UI element that the browser shows while the fetch is ongoing.</p>\n<p>The expected response here is to open a window giving the user more information about the fetch operation, which can be done from the service worker using <a href=\"/en-US/docs/Web/API/Clients/openWindow\" title=\"clients.openWindow()\"><code>clients.openWindow()</code></a>. For example:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// service-worker.js</span>\n\nself<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"backgroundfetchclick\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> registration <span class=\"token operator\">=</span> event<span class=\"token punctuation\">.</span>registration<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>registration<span class=\"token punctuation\">.</span>result <span class=\"token operator\">===</span> <span class=\"token string\">\"success\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    clients<span class=\"token punctuation\">.</span><span class=\"token function\">openWindow</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/play-movie\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    clients<span class=\"token punctuation\">.</span><span class=\"token function\">openWindow</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/movie-download-progress\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"periodic_background_sync","title":"Periodic background sync","isH3":false,"content":"<p>The <a href=\"/en-US/docs/Web/API/Web_Periodic_Background_Synchronization_API\">Periodic Background Synchronization API</a> enables a PWA to periodically update its data in the background, while the main app is closed.</p>\n<p>This can greatly improve the offline experience offered by a PWA. Consider an app that depends on reasonably fresh content, like a news app. If the device is offline when the user opens the app, then even with service worker-based caching the stories will only be as fresh as the last time the app was opened. With periodic background sync, the app could have refreshed its stories in the background, when the device had connectivity, and so could be able to show relatively fresh content to the user.</p>\n<p>This takes advantage of the fact that on a mobile device especially, connectivity is not poor so much as <em>intermittent</em>: by taking advantage of the times that the device has connectivity, the app can smooth over the connectivity gaps.</p>"}},{"type":"prose","value":{"id":"registering_a_periodic_sync_event","title":"Registering a periodic sync event","isH3":true,"content":"<p>The code for registering a periodic sync event follows the same pattern as that for <a href=\"#registering_a_sync_event\">registering a sync event</a>. The <a href=\"/en-US/docs/Web/API/ServiceWorkerRegistration\"><code>ServiceWorkerRegistration</code></a> has a <a href=\"/en-US/docs/Web/API/ServiceWorkerRegistration/periodicSync\" title=\"periodicSync\"><code>periodicSync</code></a> property, which has a <a href=\"/en-US/docs/Web/API/PeriodicSyncManager/register\" title=\"register()\"><code>register()</code></a> method taking the name of the periodic sync as a parameter.</p>\n<p>However, <code>periodicSync.register()</code> takes an extra argument, which is an object with a <code>minInterval</code> property. This represents the minimum interval, in milliseconds, between synchronization attempts:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// main.js</span>\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">registerPeriodicSync</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> swRegistration <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> navigator<span class=\"token punctuation\">.</span>serviceWorker<span class=\"token punctuation\">.</span>ready<span class=\"token punctuation\">;</span>\n  swRegistration<span class=\"token punctuation\">.</span>periodicSync<span class=\"token punctuation\">.</span><span class=\"token function\">register</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"update-news\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// try to update every 24 hours</span>\n    <span class=\"token literal-property property\">minInterval</span><span class=\"token operator\">:</span> <span class=\"token number\">24</span> <span class=\"token operator\">*</span> <span class=\"token number\">60</span> <span class=\"token operator\">*</span> <span class=\"token number\">60</span> <span class=\"token operator\">*</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"handling_a_periodic_sync_event","title":"Handling a periodic sync event","isH3":true,"content":"<p>Although the PWA asks for a particular interval in the <code>register()</code> call, it's up to the browser how often to generate periodic sync events. Apps that users open and interact with often will be more likely to receive periodic sync events, and will receive them more often, than apps which the user rarely or never interacts with.</p>\n<p>When the browser has decided to generate a periodic sync event, the pattern is the following: it starts the service worker, if necessary, and fires a <a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope/periodicsync_event\" title=\"periodicSync\"><code>periodicSync</code></a> event in the service worker's global scope.</p>\n<p>The service worker's event handler checks the name of the event, and calls the appropriate function inside the event's <a href=\"/en-US/docs/Web/API/ExtendableEvent/waitUntil\" title=\"waitUntil()\"><code>waitUntil()</code></a> method:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// service-worker.js</span>\n\nself<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"periodicsync\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>tag <span class=\"token operator\">===</span> <span class=\"token string\">\"update-news\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    event<span class=\"token punctuation\">.</span><span class=\"token function\">waitUntil</span><span class=\"token punctuation\">(</span><span class=\"token function\">updateNews</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Inside <code>updateNews()</code>, the service worker can fetch and cache the latest stories. The <code>updateNews()</code> function should complete relatively quickly: if the service worker takes too long updating its content, the browser will stop it.</p>"}},{"type":"prose","value":{"id":"unregistering_a_periodic_sync","title":"Unregistering a periodic sync","isH3":true,"content":"<p>When the PWA no longer needs periodic background updates, (for example, because the user has switched them off in the app's settings) then the PWA should ask the browser to stop generating periodic sync events, by calling the <a href=\"/en-US/docs/Web/API/PeriodicSyncManager/unregister\" title=\"unregister()\"><code>unregister()</code></a> method of <a href=\"/en-US/docs/Web/API/ServiceWorkerRegistration/periodicSync\" title=\"periodicSync\"><code>periodicSync</code></a>:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// main.js</span>\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">registerPeriodicSync</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> swRegistration <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> navigator<span class=\"token punctuation\">.</span>serviceWorker<span class=\"token punctuation\">.</span>ready<span class=\"token punctuation\">;</span>\n  swRegistration<span class=\"token punctuation\">.</span>periodicSync<span class=\"token punctuation\">.</span><span class=\"token function\">unregister</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"update-news\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"push","title":"Push","isH3":false,"content":"<p>The <a href=\"/en-US/docs/Web/API/Push_API\">Push API</a> enables a PWA to receive messages pushed from the server, whether the app is running or not. When the message is received by the device, the app's service worker is started and handles the message, and a <a href=\"/en-US/docs/Web/API/Notifications_API\">notification</a> is shown to the user. The specification allows for \"silent push\" in which no notification is shown, but no browsers support this, because of privacy concerns (for example, that push could then be used to track a user's location).</p>\n<p>Displaying a notification to the user distracts them from whatever they were doing and has the potential to be very annoying, so use push messages with care. In general, they are suitable for situations in which you need to alert the user about something, and can't wait until the next time they open your app.</p>\n<p>A common use case for push notifications is chat apps: when the user receives a message from one of their contacts, it is delivered as a push message and the app shows a notification.</p>\n<p>Push messages are not sent directly from the app server to the device. Instead, your app server sends messages to a push service, from which the device can retrieve them and deliver them to the app.</p>\n<p>This also means that messages from your server to the push service need to be <a href=\"/en-US/docs/Glossary/Encryption\">encrypted</a> (so the push service can't read them) and <a href=\"/en-US/docs/Glossary/Signature/Security\">signed</a> (so the push service knows that the messages are really from your server, and not from someone impersonating your server).</p>\n<p>The push service is operated by the browser vendor or by a third party, and the app server communicates with it using the <a href=\"https://datatracker.ietf.org/doc/html/rfc8030\" class=\"external\" target=\"_blank\">HTTP Push</a> protocol. The app server can use a third-party library such as <a href=\"https://github.com/web-push-libs/web-push\" class=\"external\" target=\"_blank\">web-push</a> to take care of the protocol details.</p>"}},{"type":"prose","value":{"id":"subscribing_to_push_messages","title":"Subscribing to push messages","isH3":true,"content":"<p>The pattern for subscribing to push messages looks like this:</p>\n<p>\n  <img src=\"/en-US/docs/Web/Progressive_web_apps/Guides/Offline_and_background_operation/push-messaging-1.svg\" alt=\"Diagram showing push message subscription steps\" width=\"600\" height=\"500\" loading=\"lazy\">\n</p>\n<ol>\n  <li>As a prerequisite, the app server needs to be provisioned with a <a href=\"/en-US/docs/Glossary/Public-key_cryptography\">public/private key pair</a>, so it can sign push messages. Signing messages needs to follow the <a href=\"https://datatracker.ietf.org/doc/html/draft-thomson-webpush-vapid-02\" class=\"external\" target=\"_blank\">VAPID</a> specification.</li>\n  <li>On the device, the app uses the <a href=\"/en-US/docs/Web/API/PushManager/subscribe\"><code>PushManager.subscribe()</code></a> method to subscribe to messages from the server. The <code>subscribe()</code> method:\n    <ul>\n      <li>Takes the app server's public key as an argument: this is what the push service will use to verify the signature on messages from the app server.</li>\n      <li>Returns a <code>Promise</code> that resolves to a <a href=\"/en-US/docs/Web/API/PushSubscription\"><code>PushSubscription</code></a> object. This object includes:\n        <ul>\n          <li>The <a href=\"/en-US/docs/Web/API/PushSubscription/endpoint\">endpoint</a> for the push service: this is how the app server knows where to send push messages.</li>\n          <li>The <a href=\"/en-US/docs/Web/API/PushSubscription/getKey\">public encryption key</a> that your server will use to encrypt messages to the push service.</li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n  <li>The app sends the endpoint and public encryption key to your server (for example, using <a href=\"/en-US/docs/Web/API/fetch\"><code>fetch()</code></a>).</li>\n</ol>\n<p>After this, the app server is able to start sending push messages.</p>"}},{"type":"prose","value":{"id":"sending_delivering_and_handling_push_messages","title":"Sending, delivering, and handling push messages","isH3":true,"content":"<p>When an event happens on the server that the server wants the app to handle, the server can send messages, and the sequence of steps is like this:</p>\n<p>\n  <img src=\"/en-US/docs/Web/Progressive_web_apps/Guides/Offline_and_background_operation/push-messaging-2.svg\" alt=\"Diagram showing push message sending and delivery steps\" width=\"700\" height=\"600\" loading=\"lazy\">\n</p>\n<ol>\n  <li>The app server signs the message using its private signing key and encrypts the message using the public encryption key for the push service. The app server can use a library such as <a href=\"https://github.com/web-push-libs/web-push\" class=\"external\" target=\"_blank\">web-push</a> to simplify this.</li>\n  <li>The app server sends the message to the endpoint for the push service, using the <a href=\"https://datatracker.ietf.org/doc/html/rfc8030\" class=\"external\" target=\"_blank\">HTTP Push</a> protocol, and again optionally using a library, like web-push.</li>\n  <li>The push service checks the signature on the message, and if the signature is valid, the push service queues the message for delivery.</li>\n  <li>When the device has network connectivity, the push service delivers the encrypted message to the browser.</li>\n  <li>When the browser receives the encrypted message, it decrypts the message.</li>\n  <li>The browser starts the service worker if necessary, and fires an event called <a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope/push_event\" title=\"push\"><code>push</code></a> in the service worker's global scope. The event handler is passed a <a href=\"/en-US/docs/Web/API/PushEvent\"><code>PushEvent</code></a> object, which contains the message data.</li>\n  <li>In its event handler, the service worker does any processing of the message. As usual, the event handler calls <code>event.waitUntil()</code> to ask the browser to keep the service worker running.</li>\n  <li>In its event handler, the service worker creates a notification using <a href=\"/en-US/docs/Web/API/ServiceWorkerRegistration/showNotification\" title=\"registration.showNotification()\"><code>registration.showNotification()</code></a>.</li>\n  <li>If the user clicks the notification or closes it, the <a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope/notificationclick_event\" title=\"notificationclick\"><code>notificationclick</code></a> and <a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope/notificationclose_event\" title=\"notificationclose\"><code>notificationclose</code></a>, respectively, are fired in the service worker's global scope. These enable the app to handle the user's response to the notification.</li>\n</ol>"}},{"type":"prose","value":{"id":"permissions_and_restrictions","title":"Permissions and restrictions","isH3":false,"content":"<p>Browsers have to find a balance in which they can provide powerful APIs to web developers while protecting users from malicious, exploitative, or poorly-written websites. One of the main protections they offer is that users can close the website's pages, and it's then not active on their device any more. The APIs described in this article tend to violate that assurance, so browsers have to take extra steps to help ensure that users are aware of this, and that the APIs are used in ways that align with the interests of users.</p>\n<p>In this section we'll outline these steps. Several of these APIs require explicit <a href=\"/en-US/docs/Web/API/Permissions_API\">user permission</a>, and various other restrictions and design choices to help protect users.</p>\n<ul>\n  <li>The Background Sync API does not need an explicit user permission, but issuing a background sync request may only be made while the main app is open, and browsers limit the number of retries and the length of time background sync operations can take.</li>\n  <li>The Background Fetch API requires the <code>\"background-fetch\"</code> user permission, and the browser displays the ongoing progress of the fetch operation, enabling the user to cancel it.</li>\n  <li>The Periodic Background Sync API requires the <code>\"periodic-background-sync\"</code> user permission, and browsers should allow users to disable periodic background sync completely. Also, browsers may tie the frequency of sync events to the extent to which the user chooses to interact with the app: so an app that the user rarely uses may receive few events (or even no events at all).</li>\n  <li>The Push API requires the <code>\"push\"</code> user permission, and all browsers require push events to be user visible, meaning that they generate a user-visible notification.</li>\n</ul>"}},{"type":"prose","value":{"id":"see_also","title":"See also","isH3":false,"content":""}},{"type":"prose","value":{"id":"reference","title":"Reference","isH3":true,"content":"<ul>\n  <li><a href=\"/en-US/docs/Web/API/Service_Worker_API\">Service Worker API</a></li>\n  <li><a href=\"/en-US/docs/Web/API/Background_Synchronization_API\">Background Synchronization API</a></li>\n  <li><a href=\"/en-US/docs/Web/API/Background_Fetch_API\">Background Fetch API</a></li>\n  <li><a href=\"/en-US/docs/Web/API/Web_Periodic_Background_Synchronization_API\">Periodic Background Synchronization API</a></li>\n  <li><a href=\"/en-US/docs/Web/API/Push_API\">Push API</a></li>\n  <li><a href=\"/en-US/docs/Web/API/Notifications_API\">Notifications API</a></li>\n</ul>"}},{"type":"prose","value":{"id":"guides","title":"Guides","isH3":true,"content":"<ul>\n  <li><a href=\"https://developer.chrome.com/blog/background-sync/\" class=\"external\" target=\"_blank\">Introducing Background Sync</a> on web.dev (2017)</li>\n  <li><a href=\"https://developer.chrome.com/blog/background-fetch/\" class=\"external\" target=\"_blank\">Introducing Background Fetch</a> on web.dev (2022)</li>\n  <li><a href=\"https://developer.chrome.com/articles/periodic-background-sync/\" class=\"external\" target=\"_blank\">The Periodic Background Sync API</a> on web.dev (2020)</li>\n  <li><a href=\"https://web.dev/explore/notifications\" class=\"external\" target=\"_blank\">Notifications</a> on web.dev</li>\n  <li><a href=\"https://web.dev/articles/pwa-with-offline-streaming\" class=\"external\" target=\"_blank\">PWA with offline streaming</a> on web.dev (2021)</li>\n</ul>"}}],"toc":[{"text":"Websites and workers","id":"websites_and_workers"},{"text":"Offline operation","id":"offline_operation"},{"text":"Background operation","id":"background_operation"},{"text":"Background sync","id":"background_sync"},{"text":"Background fetch","id":"background_fetch"},{"text":"Periodic background sync","id":"periodic_background_sync"},{"text":"Push","id":"push"},{"text":"Permissions and restrictions","id":"permissions_and_restrictions"},{"text":"See also","id":"see_also"}],"summary":"Usually, websites are very dependent on both reliable network connectivity and on the user having their pages open in a browser. Without network connectivity, most websites are just unusable, and if the user does not have the site open in a browser tab, most websites are unable to do anything.","popularity":0.0121,"modified":"2023-10-25T17:27:32.000Z","source":{"folder":"en-us/web/progressive_web_apps/guides/offline_and_background_operation","github_url":"https://github.com/mdn/content/blob/main/files/en-us/web/progressive_web_apps/guides/offline_and_background_operation/index.md","last_commit_url":"https://github.com/mdn/content/commit/835d6632d59993861a0458510402787f8a2c3cb3","filename":"index.md"},"short_title":"Offline and background operation","parents":[{"uri":"/en-US/docs/Web","title":"References"},{"uri":"/en-US/docs/Web/Progressive_web_apps","title":"Progressive web apps"},{"uri":"/en-US/docs/Web/Progressive_web_apps/Guides","title":"Guides"},{"uri":"/en-US/docs/Web/Progressive_web_apps/Guides/Offline_and_background_operation","title":"Offline and background operation"}],"pageTitle":"Offline and background operation - Progressive web apps | MDN","noIndexing":false}}</script></body></html>