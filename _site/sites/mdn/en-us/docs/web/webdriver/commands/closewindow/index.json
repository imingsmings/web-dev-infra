{"doc":{"isMarkdown":true,"isTranslated":false,"isActive":true,"flaws":{"broken_links":[{"explanation":"Can't resolve /en-US/docs/Web/WebDriver/Command","id":"link1","href":"/en-US/docs/Web/WebDriver/Command","suggestion":null,"fixable":false,"line":10,"column":20},{"explanation":"Can't resolve /en-US/docs/Web/WebDriver/WebWindow","id":"link2","href":"/en-US/docs/Web/WebDriver/WebWindow","suggestion":null,"fixable":false,"line":10,"column":221},{"explanation":"Can't resolve /en-US/docs/Web/WebDriver/Errors/UnexpectedAlertOpen","id":"link3","href":"/en-US/docs/Web/WebDriver/Errors/UnexpectedAlertOpen","suggestion":null,"fixable":false,"line":27,"column":3},{"explanation":"Can't resolve /en-US/docs/Web/WebDriver/Commands/SwitchToWindow","id":"link4","href":"/en-US/docs/Web/WebDriver/Commands/SwitchToWindow","suggestion":null,"fixable":false,"line":81,"column":3},{"explanation":"Can't resolve /en-US/docs/Web/WebDriver/Commands/GetWindowHandle","id":"link5","href":"/en-US/docs/Web/WebDriver/Commands/GetWindowHandle","suggestion":null,"fixable":false,"line":82,"column":3}]},"title":"Close Window","mdn_url":"/en-US/docs/Web/WebDriver/Commands/CloseWindow","locale":"en-US","native":"English (US)","browserCompat":["webdriver.commands.CloseWindow"],"sidebarHTML":"\n<ol><li><em><a href=\"/en-US/docs/Web/WebDriver/Commands/CloseWindow\" aria-current=\"page\">Close Window</a></em></li><li><a href=\"/en-US/docs/Web/WebDriver/Commands/GetElementAttribute\">Get Element Attribute</a></li><li><a href=\"/en-US/docs/Web/WebDriver/Commands/GetElementProperty\">Get Element Property</a></li><li><a href=\"/en-US/docs/Web/WebDriver/Commands/GetElementTagName\">Get Element Tag Name</a></li><li><a href=\"/en-US/docs/Web/WebDriver/Commands/GetTimeouts\">Get Timeouts</a></li><li><a href=\"/en-US/docs/Web/WebDriver/Commands/GetWindowHandles\">Get Window Handles</a></li><li><a href=\"/en-US/docs/Web/WebDriver/Commands/GetWindowRect\">Get Window Rect</a></li><li><a href=\"/en-US/docs/Web/WebDriver/Commands/New_Window\">New Window</a></li><li><a href=\"/en-US/docs/Web/WebDriver/Commands/SetTimeouts\">Set Timeouts</a></li><li><a href=\"/en-US/docs/Web/WebDriver/Commands/SetWindowRect\">Set Window Rect</a></li></ol>\n","sidebarMacro":"QuickLinksWithSubpages","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p>The <em>Close Window</em> <a href=\"/en-US/docs/Web/WebDriver/Command\" class=\"page-not-created\" title=\"This is a link to an unwritten page\" data-flaw=\"link1\">command</a> of the <a href=\"/en-US/docs/Web/WebDriver\">WebDriver</a> API closes the current top-level browsing context (window or tab) and returns with the list of currently open <a href=\"/en-US/docs/Web/WebDriver/WebWindow\" class=\"page-not-created\" title=\"This is a link to an unwritten page\" data-flaw=\"link2\"><code>WebWindow</code></a>s. If it is the last window that is being closed, the WebDriver session will implicitly be deleted. Subsequent commands after the session is ended will therefore cause <a href=\"/en-US/docs/Web/WebDriver/Errors/InvalidSessionID\">invalid session ID</a> errors.</p>"}},{"type":"prose","value":{"id":"syntax","title":"Syntax","isH3":false,"content":"<figure class=\"table-container\"><table>\n  <thead>\n    <tr>\n      <th>Method</th>\n      <th>URI template</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><a href=\"/en-US/docs/Web/HTTP/Methods/DELETE\"><code>DELETE</code></a></td>\n      <td><code>/session/{session id}/window</code></td>\n    </tr>\n  </tbody>\n</table></figure>"}},{"type":"prose","value":{"id":"url_parameters","title":"URL parameters","isH3":true,"content":"<dl>\n  <dt id=\"session_id\"><a href=\"#session_id\"><code>session id</code></a></dt>\n  <dd>\n    <p>Identifier of the session.</p>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"errors","title":"Errors","isH3":true,"content":"<dl>\n  <dt id=\"invalid_session_id\"><a href=\"/en-US/docs/Web/WebDriver/Errors/InvalidSessionID\">Invalid session ID</a></dt>\n  <dd>\n    <p>Session does not exist.</p>\n  </dd>\n  <dt id=\"unexpected_alert_open\"><a href=\"/en-US/docs/Web/WebDriver/Errors/UnexpectedAlertOpen\" class=\"page-not-created\" title=\"This is a link to an unwritten page\" data-flaw=\"link3\">Unexpected alert open</a></dt>\n  <dd>\n    <p>A user prompt, such as <a href=\"/en-US/docs/Web/API/Window/alert\"><code>window.alert</code></a>, blocks execution of command until it is dealt with.</p>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"example","title":"Example","isH3":false,"content":"<p>Python:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">python</span></p><pre class=\"brush: python notranslate\"><code><span class=\"token keyword\">from</span> selenium <span class=\"token keyword\">import</span> webdriver\n\nsession <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>Firefox<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\noriginal_window <span class=\"token operator\">=</span> session<span class=\"token punctuation\">.</span>window_handle\n\nnew_window <span class=\"token operator\">=</span> session<span class=\"token punctuation\">.</span>execute_script<span class=\"token punctuation\">(</span><span class=\"token string\">\"return window.open()\"</span><span class=\"token punctuation\">)</span>\nsession<span class=\"token punctuation\">.</span>switch_to<span class=\"token punctuation\">.</span>window<span class=\"token punctuation\">(</span>new_window<span class=\"token punctuation\">)</span>\n\nsession<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nsession<span class=\"token punctuation\">.</span>switch_to<span class=\"token punctuation\">.</span>window<span class=\"token punctuation\">(</span>original_window<span class=\"token punctuation\">)</span>\n</code></pre></div>\n<p>C#:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">cpp</span></p><pre class=\"brush: cpp notranslate\"><code><span class=\"token keyword\">using</span> OpenQA<span class=\"token punctuation\">.</span>Selenium<span class=\"token punctuation\">.</span>Firefox<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">namespace</span> MDNWebDriverExamples\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">class</span> <span class=\"token class-name\">Example</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">Main</span><span class=\"token punctuation\">(</span>string<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{</span>\n            FirefoxDriver session <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token function\">FirefoxDriver</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            string original_window <span class=\"token operator\">=</span> session<span class=\"token punctuation\">.</span>CurrentWindowHandle<span class=\"token punctuation\">;</span><span class=\"token comment\">// Optional if you want to store the handle in a variable</span>\n\n            session<span class=\"token punctuation\">.</span><span class=\"token function\">ExecuteScript</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"window.open()\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            session<span class=\"token punctuation\">.</span><span class=\"token function\">SwitchTo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">Window</span><span class=\"token punctuation\">(</span>session<span class=\"token punctuation\">.</span>WindowHandles<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Switch to the second window</span>\n\n            session<span class=\"token punctuation\">.</span><span class=\"token function\">Close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Close current window</span>\n            session<span class=\"token punctuation\">.</span><span class=\"token function\">SwitchTo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">Window</span><span class=\"token punctuation\">(</span>session<span class=\"token punctuation\">.</span>WindowHandles<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Switch back to the first window</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>"}},{"type":"specifications","value":{"title":"Specifications","id":"specifications","isH3":false,"specifications":[{"bcdSpecificationURL":"https://w3c.github.io/webdriver/#dfn-close-window","title":"WebDriver"}],"query":"webdriver.commands.CloseWindow"}},{"type":"browser_compatibility","value":{"title":"Browser compatibility","id":"browser_compatibility","isH3":false,"query":"webdriver.commands.CloseWindow"}},{"type":"prose","value":{"id":"see_also","title":"See also","isH3":false,"content":"<ul>\n  <li><a href=\"/en-US/docs/Web/WebDriver/Commands/SwitchToWindow\" class=\"page-not-created\" title=\"This is a link to an unwritten page\" data-flaw=\"link4\">Switch To Window</a> command</li>\n  <li><a href=\"/en-US/docs/Web/WebDriver/Commands/GetWindowHandle\" class=\"page-not-created\" title=\"This is a link to an unwritten page\" data-flaw=\"link5\">Get Window Handle</a> command</li>\n  <li><a href=\"/en-US/docs/Web/WebDriver/Commands/GetWindowHandles\">Get Window Handles</a> command</li>\n</ul>"}}],"toc":[{"text":"Syntax","id":"syntax"},{"text":"Example","id":"example"},{"text":"Specifications","id":"specifications"},{"text":"Browser compatibility","id":"browser_compatibility"},{"text":"See also","id":"see_also"}],"summary":"The Close Window command of the WebDriver API closes the current top-level browsing context (window or tab) and returns with the list of currently open WebWindows. If it is the last window that is being closed, the WebDriver session will implicitly be deleted. Subsequent commands after the session is ended will therefore cause invalid session ID errors.","popularity":0,"modified":"2023-06-29T21:01:59.000Z","source":{"folder":"en-us/web/webdriver/commands/closewindow","github_url":"https://github.com/mdn/content/blob/main/files/en-us/web/webdriver/commands/closewindow/index.md","last_commit_url":"https://github.com/mdn/content/commit/ac24a64c0ab26d0185c7b768aca130f490ea8487","filename":"index.md"},"short_title":"Close Window","parents":[{"uri":"/en-US/docs/Web","title":"References"},{"uri":"/en-US/docs/Web/WebDriver","title":"WebDriver"},{"uri":"/en-US/docs/Web/WebDriver/Commands","title":"Commands"},{"uri":"/en-US/docs/Web/WebDriver/Commands/CloseWindow","title":"Close Window"}],"pageTitle":"Close Window - WebDriver | MDN","noIndexing":false}}