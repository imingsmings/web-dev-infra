{"doc":{"isMarkdown":true,"isTranslated":false,"isActive":true,"flaws":{},"title":"FileSystemHandle: queryPermission() method","mdn_url":"/en-US/docs/Web/API/FileSystemHandle/queryPermission","locale":"en-US","native":"English (US)","browserCompat":["api.FileSystemHandle.queryPermission"],"sidebarHTML":"<ol><li><strong><a href=\"/en-US/docs/Web/API/File_System_API\">File System API</a></strong></li><li><strong><a href=\"/en-US/docs/Web/API/FileSystemHandle\"><code>FileSystemHandle</code></a></strong></li><li class=\"toggle\"><details open=\"\"><summary>Instance properties</summary><ol><li><a href=\"/en-US/docs/Web/API/FileSystemHandle/kind\"><code>kind</code></a></li><li><a href=\"/en-US/docs/Web/API/FileSystemHandle/name\"><code>name</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Instance methods</summary><ol><li><a href=\"/en-US/docs/Web/API/FileSystemHandle/isSameEntry\"><code>isSameEntry()</code></a></li><li><em><code>queryPermission()</code> <abbr class=\"icon icon-experimental\" title=\"Experimental. Expect behavior to change in the future.\">\n    <span class=\"visually-hidden\">Experimental</span>\n</abbr></em></li><li><a href=\"/en-US/docs/Web/API/FileSystemHandle/remove\"><code>remove()</code></a><abbr class=\"icon icon-experimental\" title=\"Experimental. Expect behavior to change in the future.\">\n    <span class=\"visually-hidden\">Experimental</span>\n</abbr><abbr class=\"icon icon-nonstandard\" title=\"Non-standard. Check cross-browser support before using.\">\n    <span class=\"visually-hidden\">Non-standard</span>\n</abbr></li><li><a href=\"/en-US/docs/Web/API/FileSystemHandle/requestPermission\"><code>requestPermission()</code></a><abbr class=\"icon icon-experimental\" title=\"Experimental. Expect behavior to change in the future.\">\n    <span class=\"visually-hidden\">Experimental</span>\n</abbr></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Related pages for File System API</summary><ol><li><a href=\"/en-US/docs/Web/API/DataTransferItem/getAsFileSystemHandle\"><code>DataTransferItem.getAsFileSystemHandle()</code></a></li><li><a href=\"/en-US/docs/Web/API/FileSystemDirectoryHandle\"><code>FileSystemDirectoryHandle</code></a></li><li><a href=\"/en-US/docs/Web/API/FileSystemFileHandle\"><code>FileSystemFileHandle</code></a></li><li><a href=\"/en-US/docs/Web/API/FileSystemSyncAccessHandle\"><code>FileSystemSyncAccessHandle</code></a></li><li><a href=\"/en-US/docs/Web/API/FileSystemWritableFileStream\"><code>FileSystemWritableFileStream</code></a></li><li><a href=\"/en-US/docs/Web/API/StorageManager/getDirectory\"><code>StorageManager.getDirectory()</code></a></li><li><a href=\"/en-US/docs/Web/API/Window/showDirectoryPicker\"><code>window.showDirectoryPicker()</code></a></li><li><a href=\"/en-US/docs/Web/API/Window/showOpenFilePicker\"><code>window.showOpenFilePicker()</code></a></li><li><a href=\"/en-US/docs/Web/API/Window/showSaveFilePicker\"><code>window.showSaveFilePicker()</code></a></li></ol></details></li></ol>","sidebarMacro":"APIRef","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<div class=\"notecard secure\" id=\"sect1\"><p><strong>Secure context:</strong> This feature is available only in <a href=\"/en-US/docs/Web/Security/Secure_Contexts\">secure contexts</a> (HTTPS), in some or all <a href=\"#browser_compatibility\">supporting browsers</a>.</p></div><div class=\"notecard experimental\" id=\"sect2\"><p><strong>Experimental:</strong> <strong>This is an <a href=\"/en-US/docs/MDN/Writing_guidelines/Experimental_deprecated_obsolete#experimental\">experimental technology</a></strong><br>Check the <a href=\"#browser_compatibility\">Browser compatibility table</a> carefully before using this in production.</p></div>\n<p>\n  The <strong><code>queryPermission()</code></strong> method of the\n  <a href=\"/en-US/docs/Web/API/FileSystemHandle\"><code>FileSystemHandle</code></a> interface queries the current permission state of the\n  current handle.\n</p>"}},{"type":"prose","value":{"id":"syntax","title":"Syntax","isH3":false,"content":"<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token function\">queryPermission</span><span class=\"token punctuation\">(</span>fileSystemHandlePermissionDescriptor<span class=\"token punctuation\">)</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"parameters","title":"Parameters","isH3":true,"content":"<dl>\n  <dt id=\"filesystemhandlepermissiondescriptor\"><a href=\"#filesystemhandlepermissiondescriptor\">FileSystemHandlePermissionDescriptor </a><span class=\"badge inline optional\">Optional</span></dt>\n  <dd>\n    <p>An object which specifies the permission mode to query for. Options are as follows:</p>\n    <ul>\n      <li>\n        <code>'mode'</code>: Can be either <code>'read'</code> or\n        <code>'readwrite'</code>.\n      </li>\n    </ul>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"return_value","title":"Return value","isH3":true,"content":"<p>A <a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise\"><code>Promise</code></a> that resolves to a <a href=\"/en-US/docs/Web/API/PermissionStatus\"><code>PermissionStatus</code></a> object.</p>\n<p>\n  If <a href=\"/en-US/docs/Web/API/PermissionStatus/state\"><code>PermissionStatus.state</code></a> returns \"prompt\" the website will have to call requestPermission() before any\n  operations on the handle can be done. If this returns \"denied\" any operations will\n  reject. Usually handles returned by the local file system handle factories will\n  initially return \"granted\" for their read permission state. However, other than through\n  the user revoking permission, a handle retrieved from IndexedDB is also likely to return\n  \"prompt\".\n</p>"}},{"type":"prose","value":{"id":"exceptions","title":"Exceptions","isH3":true,"content":"<dl>\n  <dt id=\"typeerror\"><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypeError\"><code>TypeError</code></a></dt>\n  <dd>\n    <p>\n      Thrown if <code>mode</code> is specified with a value other than\n      <code>'read'</code> or <code>'readwrite'</code>\n    </p>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"examples","title":"Examples","isH3":false,"content":"<p>\n  The following asynchronous function returns true if user has granted read or readwrite\n  permissions to the file handle. Permission is requested if not.\n</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// fileHandle is a FileSystemFileHandle</span>\n<span class=\"token comment\">// withWrite is a boolean set to true if write</span>\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">verifyPermission</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">fileHandle<span class=\"token punctuation\">,</span> withWrite</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> opts <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>withWrite<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    opts<span class=\"token punctuation\">.</span>mode <span class=\"token operator\">=</span> <span class=\"token string\">\"readwrite\"</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// Check if we already have permission, if so, return true.</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">await</span> fileHandle<span class=\"token punctuation\">.</span><span class=\"token function\">queryPermission</span><span class=\"token punctuation\">(</span>opts<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token string\">\"granted\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// Request permission to the file, if the user grants permission, return true.</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">await</span> fileHandle<span class=\"token punctuation\">.</span><span class=\"token function\">requestPermission</span><span class=\"token punctuation\">(</span>opts<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token string\">\"granted\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// The user did not grant permission, return false.</span>\n  <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>"}},{"type":"specifications","value":{"title":"Specifications","id":"specifications","isH3":false,"specifications":[{"bcdSpecificationURL":"https://wicg.github.io/file-system-access/#api-filesystemhandle-querypermission","title":"File System Access"}],"query":"api.FileSystemHandle.queryPermission"}},{"type":"browser_compatibility","value":{"title":"Browser compatibility","id":"browser_compatibility","isH3":false,"query":"api.FileSystemHandle.queryPermission"}},{"type":"prose","value":{"id":"see_also","title":"See also","isH3":false,"content":"<ul>\n  <li><a href=\"/en-US/docs/Web/API/File_System_API\">File System API</a></li>\n  <li><a href=\"https://developer.chrome.com/articles/file-system-access/\" class=\"external\" target=\"_blank\">The File System Access API: simplifying access to local files</a></li>\n</ul>"}}],"toc":[{"text":"Syntax","id":"syntax"},{"text":"Examples","id":"examples"},{"text":"Specifications","id":"specifications"},{"text":"Browser compatibility","id":"browser_compatibility"},{"text":"See also","id":"see_also"}],"summary":"The queryPermission() method of the\n  FileSystemHandle interface queries the current permission state of the\n  current handle.","popularity":0.0007,"modified":"2023-10-28T09:45:03.000Z","source":{"folder":"en-us/web/api/filesystemhandle/querypermission","github_url":"https://github.com/mdn/content/blob/main/files/en-us/web/api/filesystemhandle/querypermission/index.md","last_commit_url":"https://github.com/mdn/content/commit/d2881ec63594dcad971372110bfa78866991a046","filename":"index.md"},"short_title":"queryPermission()","parents":[{"uri":"/en-US/docs/Web","title":"References"},{"uri":"/en-US/docs/Web/API","title":"Web APIs"},{"uri":"/en-US/docs/Web/API/FileSystemHandle","title":"FileSystemHandle"},{"uri":"/en-US/docs/Web/API/FileSystemHandle/queryPermission","title":"queryPermission()"}],"pageTitle":"FileSystemHandle: queryPermission() method - Web APIs | MDN","noIndexing":false}}