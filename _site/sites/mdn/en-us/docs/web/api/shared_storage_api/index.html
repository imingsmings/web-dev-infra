<!doctype html><html lang="en-US" prefix="og: https://ogp.me/ns#"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><link rel="icon" href="/favicon-48x48.cbbd161b.png"/><link rel="apple-touch-icon" href="/apple-touch-icon.6803c6f0.png"/><meta name="theme-color" content="#ffffff"/><link rel="manifest" href="/manifest.56b1cedc.json"/><link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="MDN Web Docs"/><title>Shared Storage API - Web APIs | MDN</title><link rel="alternate" type="application/rss+xml" title="MDN Blog RSS Feed" href="https://developer.mozilla.org/en-US/blog/rss.xml" hreflang="en" /><meta name="robots" content="noindex, nofollow"><meta name="description" content="The Shared Storage API is a client-side storage mechanism that enables unpartitioned, cross-site data access while preserving privacy (i.e. without relying on tracking cookies)."/><meta property="og:url" content="https://developer.mozilla.org/en-US/docs/Web/API/Shared_Storage_API"/><meta property="og:title" content="Shared Storage API - Web APIs | MDN"/><meta property="og:type" content="website"/><meta property="og:locale" content="en_US"/><meta property="og:description" content="The Shared Storage API is a client-side storage mechanism that enables unpartitioned, cross-site data access while preserving privacy (i.e. without relying on tracking cookies)."/><meta property="og:image" content="https://developer.mozilla.org/mdn-social-share.cd6c4a5a.png"/><meta property="og:image:type" content="image/png"/><meta property="og:image:height" content="1080"/><meta property="og:image:width" content="1920"/><meta property="og:image:alt" content="The MDN Web Docs logo, featuring a blue accent color, displayed on a solid black background."/><meta property="og:site_name" content="MDN Web Docs"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:creator" content="MozDevNet"/><link rel="canonical" href="https://developer.mozilla.org/en-US/docs/Web/API/Shared_Storage_API"/><style media="print">.article-actions-container,.document-toc-container,.language-menu,.main-menu-toggle,.on-github,.page-footer,.place,.sidebar,.top-banner,.top-navigation-main,ul.prev-next{display:none!important}.main-page-content,.main-page-content pre{padding:2px}.main-page-content pre{border-left-width:2px}</style><script defer="defer" src="/static/js/main.8204838d.js"></script><link href="/static/css/main.3551aa81.css" rel="stylesheet"></head><body><script>if(document.body.addEventListener("load",(t=>{t.target.classList.contains("interactive")&&t.target.setAttribute("data-readystate","complete")}),{capture:!0}),window&&document.documentElement){const t={light:"#ffffff",dark:"#1b1b1b"};try{const e=window.localStorage.getItem("theme");e&&(document.documentElement.className=e,document.documentElement.style.backgroundColor=t[e])}catch(t){console.warn("Unable to read theme from localStorage",t)}}</script><div id="root"><ul id="nav-access" class="a11y-nav"><li><a id="skip-main" href="#content">Skip to main content</a></li><li><a id="skip-search" href="#top-nav-search-input">Skip to search</a></li><li><a id="skip-select-language" href="#languages-switcher-button">Skip to select language</a></li></ul><div class="page-wrapper  category-api document-page"><div class="top-banner loading"><section class="place top container"></section></div><div class="sticky-header-container"><header class="top-navigation 
      
      "><div class="container "><div class="top-navigation-wrap"><a href="/en-US/" class="logo" aria-label="MDN homepage"><svg id="mdn-docs-logo" xmlns="http://www.w3.org/2000/svg" x="0" y="0" viewBox="0 0 694.9 104.4" style="enable-background:new 0 0 694.9 104.4" xml:space="preserve" role="img"><title>MDN Web Docs</title><path d="M40.3 0 11.7 92.1H0L28.5 0h11.8zm10.4 0v92.1H40.3V0h10.4zM91 0 62.5 92.1H50.8L79.3 0H91zm10.4 0v92.1H91V0h10.4z" class="logo-m"></path><path d="M627.9 95.6h67v8.8h-67v-8.8z" class="logo-_"></path><path d="M367 42h-4l-10.7 30.8h-5.5l-10.8-26h-.4l-10.5 26h-5.2L308.7 42h-3.8v-5.6H323V42h-6.5l6.8 20.4h.4l10.3-26h4.7l11.2 26h.5l5.7-20.3h-6.2v-5.6H367V42zm34.9 20c-.4 3.2-2 5.9-4.7 8.2-2.8 2.3-6.5 3.4-11.3 3.4-5.4 0-9.7-1.6-13.1-4.7-3.3-3.2-5-7.7-5-13.7 0-5.7 1.6-10.3 4.7-14s7.4-5.5 12.9-5.5c5.1 0 9.1 1.6 11.9 4.7s4.3 6.9 4.3 11.3c0 1.5-.2 3-.5 4.7h-25.6c.3 7.7 4 11.6 10.9 11.6 2.9 0 5.1-.7 6.5-2 1.5-1.4 2.5-3 3-4.9l6 .9zM394 51.3c.2-2.4-.4-4.7-1.8-6.9s-3.8-3.3-7-3.3c-3.1 0-5.3 1-6.9 3-1.5 2-2.5 4.4-2.8 7.2H394zm51 2.4c0 5-1.3 9.5-4 13.7s-6.9 6.2-12.7 6.2c-6 0-10.3-2.2-12.7-6.7-.1.4-.2 1.4-.4 2.9s-.3 2.5-.4 2.9h-7.3c.3-1.7.6-3.5.8-5.3.3-1.8.4-3.7.4-5.5V22.3h-6v-5.6H416v27c1.1-2.2 2.7-4.1 4.7-5.7 2-1.6 4.8-2.4 8.4-2.4 4.6 0 8.4 1.6 11.4 4.7 3 3.2 4.5 7.6 4.5 13.4zm-7.7.6c0-4.2-1-7.4-3-9.5-2-2.2-4.4-3.3-7.4-3.3-3.4 0-6 1.2-8 3.7-1.9 2.4-2.9 5-3 7.7V57c0 3 1 5.6 3 7.7s4.5 3.1 7.6 3.1c3.6 0 6.3-1.3 8.1-3.9 1.8-2.7 2.7-5.9 2.7-9.6zm69.2 18.5h-13.2v-7.2c-1.2 2.2-2.8 4.1-4.9 5.6-2.1 1.6-4.8 2.4-8.3 2.4-4.8 0-8.7-1.6-11.6-4.9-2.9-3.2-4.3-7.7-4.3-13.3 0-5 1.3-9.6 4-13.7 2.6-4.1 6.9-6.2 12.8-6.2 5.7 0 9.8 2.2 12.3 6.5V22.3h-8.6v-5.6h15.8v50.6h6v5.5zM493.2 56v-4.4c-.1-3-1.2-5.5-3.2-7.3s-4.4-2.8-7.2-2.8c-3.6 0-6.3 1.3-8.2 3.9-1.9 2.6-2.8 5.8-2.8 9.6 0 4.1 1 7.3 3 9.5s4.5 3.3 7.4 3.3c3.2 0 5.8-1.3 7.8-3.8 2.1-2.6 3.1-5.3 3.2-8zm53.1-1.4c0 5.6-1.8 10.2-5.3 13.7s-8.2 5.3-13.9 5.3-10.1-1.7-13.4-5.1c-3.3-3.4-5-7.9-5-13.5 0-5.3 1.6-9.9 4.7-13.7 3.2-3.8 7.9-5.7 14.2-5.7s11 1.9 14.1 5.7c3 3.7 4.6 8.1 4.6 13.3zm-7.7-.2c0-4-1-7.2-3-9.5s-4.8-3.5-8.2-3.5c-3.6 0-6.4 1.2-8.3 3.7s-2.9 5.6-2.9 9.5c0 3.7.9 6.8 2.8 9.4 1.9 2.6 4.6 3.9 8.3 3.9 3.6 0 6.4-1.3 8.4-3.8 1.9-2.6 2.9-5.8 2.9-9.7zm45 5.8c-.4 3.2-1.9 6.3-4.4 9.1-2.5 2.9-6.4 4.3-11.8 4.3-5.2 0-9.4-1.6-12.6-4.8-3.2-3.2-4.8-7.7-4.8-13.7 0-5.5 1.6-10.1 4.7-13.9 3.2-3.8 7.6-5.7 13.2-5.7 2.3 0 4.6.3 6.7.8 2.2.5 4.2 1.5 6.2 2.9l1.5 9.5-5.9.7-1.3-6.1c-2.1-1.2-4.5-1.8-7.2-1.8-3.5 0-6.1 1.2-7.7 3.7-1.7 2.5-2.5 5.7-2.5 9.6 0 4.1.9 7.3 2.7 9.5 1.8 2.3 4.4 3.4 7.8 3.4 5.2 0 8.2-2.9 9.2-8.8l6.2 1.3zm34.7 1.9c0 3.6-1.5 6.5-4.6 8.5s-7 3-11.7 3c-5.7 0-10.6-1.2-14.6-3.6l1.2-8.8 5.7.6-.2 4.7c1.1.5 2.3.9 3.6 1.1s2.6.3 3.9.3c2.4 0 4.5-.4 6.5-1.3 1.9-.9 2.9-2.2 2.9-4.1 0-1.8-.8-3.1-2.3-3.8s-3.5-1.3-5.8-1.7-4.6-.9-6.9-1.4c-2.3-.6-4.2-1.6-5.7-2.9-1.6-1.4-2.3-3.5-2.3-6.3 0-4.1 1.5-6.9 4.6-8.5s6.4-2.4 9.9-2.4c2.6 0 5 .3 7.2.9 2.2.6 4.3 1.4 6.1 2.4l.8 8.8-5.8.7-.8-5.7c-2.3-1-4.7-1.6-7.2-1.6-2.1 0-3.7.4-5.1 1.1-1.3.8-2 2-2 3.8 0 1.7.8 2.9 2.3 3.6 1.5.7 3.4 1.2 5.7 1.6 2.2.4 4.5.8 6.7 1.4 2.2.6 4.1 1.6 5.7 3 1.4 1.6 2.2 3.7 2.2 6.6zM197.6 73.2h-17.1v-5.5h3.8V51.9c0-3.7-.7-6.3-2.1-7.9-1.4-1.6-3.3-2.3-5.7-2.3-3.2 0-5.6 1.1-7.2 3.4s-2.4 4.6-2.5 6.9v15.6h6v5.5h-17.1v-5.5h3.8V51.9c0-3.8-.7-6.4-2.1-7.9-1.4-1.5-3.3-2.3-5.6-2.3-3.2 0-5.5 1.1-7.2 3.3-1.6 2.2-2.4 4.5-2.5 6.9v15.8h6.9v5.5h-20.2v-5.5h6V42.4h-6.1v-5.6h13.4v6.4c1.2-2.1 2.7-3.8 4.7-5.2 2-1.3 4.4-2 7.3-2s5.3.7 7.5 2.1c2.2 1.4 3.7 3.5 4.5 6.4 1.1-2.5 2.7-4.5 4.9-6.1s4.8-2.4 7.9-2.4c3.5 0 6.5 1.1 8.9 3.3s3.7 5.6 3.7 10.2v18.2h6.1v5.5zm42.5 0h-13.2V66c-1.2 2.2-2.8 4.1-4.9 5.6-2.1 1.6-4.8 2.4-8.3 2.4-4.8 0-8.7-1.6-11.6-4.9-2.9-3.2-4.3-7.7-4.3-13.3 0-5 1.3-9.6 4-13.7 2.6-4.1 6.9-6.2 12.8-6.2s9.8 2.2 12.3 6.5V22.7h-8.6v-5.6h15.8v50.6h6v5.5zm-13.3-16.8V52c-.1-3-1.2-5.5-3.2-7.3s-4.4-2.8-7.2-2.8c-3.6 0-6.3 1.3-8.2 3.9-1.9 2.6-2.8 5.8-2.8 9.6 0 4.1 1 7.3 3 9.5s4.5 3.3 7.4 3.3c3.2 0 5.8-1.3 7.8-3.8 2.1-2.6 3.1-5.3 3.2-8zm61.5 16.8H269v-5.5h6V51.9c0-3.7-.7-6.3-2.2-7.9-1.4-1.6-3.4-2.3-5.7-2.3-3.1 0-5.6 1-7.4 3s-2.8 4.4-2.9 7v15.9h6v5.5h-19.3v-5.5h6V42.4h-6.2v-5.6h13.6V43c2.6-4.6 6.8-6.9 12.7-6.9 3.6 0 6.7 1.1 9.2 3.3s3.7 5.6 3.7 10.2v18.2h6v5.4h-.2z" class="logo-text"></path></svg></a><button title="Open main menu" type="button" class="button action has-icon main-menu-toggle" aria-haspopup="menu" aria-label="Open main menu" aria-expanded="false"><span class="button-wrap"><span class="icon icon-menu "></span><span class="visually-hidden">Open main menu</span></span></button></div><div class="top-navigation-main"><nav class="main-nav" aria-label="Main menu"><ul class="main-menu nojs"><li class="top-level-entry-container active"><button type="button" id="references-button" class="top-level-entry menu-toggle" aria-controls="references-menu" aria-expanded="false">References</button><a href="/en-US/docs/Web" class="top-level-entry">References</a><ul id="references-menu" class="submenu references hidden inline-submenu-lg" aria-labelledby="references-button"><li class="apis-link-container mobile-only "><a href="/en-US/docs/Web" class="submenu-item "><div class="submenu-icon"></div><div class="submenu-content-container"><div class="submenu-item-heading">Overview / Web Technology</div><p class="submenu-item-description">Web technology reference for developers</p></div></a></li><li class="html-link-container "><a href="/en-US/docs/Web/HTML" class="submenu-item "><div class="submenu-icon html"></div><div class="submenu-content-container"><div class="submenu-item-heading">HTML</div><p class="submenu-item-description">Structure of content on the web</p></div></a></li><li class="css-link-container "><a href="/en-US/docs/Web/CSS" class="submenu-item "><div class="submenu-icon css"></div><div class="submenu-content-container"><div class="submenu-item-heading">CSS</div><p class="submenu-item-description">Code used to describe document style</p></div></a></li><li class="javascript-link-container "><a href="/en-US/docs/Web/JavaScript" class="submenu-item "><div class="submenu-icon javascript"></div><div class="submenu-content-container"><div class="submenu-item-heading">JavaScript</div><p class="submenu-item-description">General-purpose scripting language</p></div></a></li><li class="http-link-container "><a href="/en-US/docs/Web/HTTP" class="submenu-item "><div class="submenu-icon http"></div><div class="submenu-content-container"><div class="submenu-item-heading">HTTP</div><p class="submenu-item-description">Protocol for transmitting web resources</p></div></a></li><li class="apis-link-container "><a href="/en-US/docs/Web/API" class="submenu-item "><div class="submenu-icon apis"></div><div class="submenu-content-container"><div class="submenu-item-heading">Web APIs</div><p class="submenu-item-description">Interfaces for building web applications</p></div></a></li><li class="apis-link-container "><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions" class="submenu-item "><div class="submenu-icon"></div><div class="submenu-content-container"><div class="submenu-item-heading">Web Extensions</div><p class="submenu-item-description">Developing extensions for web browsers</p></div></a></li><li class="apis-link-container desktop-only "><a href="/en-US/docs/Web" class="submenu-item "><div class="submenu-icon"></div><div class="submenu-content-container"><div class="submenu-item-heading">Web Technology</div><p class="submenu-item-description">Web technology reference for developers</p></div></a></li></ul></li><li class="top-level-entry-container "><button type="button" id="guides-button" class="top-level-entry menu-toggle" aria-controls="guides-menu" aria-expanded="false">Guides</button><a href="/en-US/docs/Learn" class="top-level-entry">Guides</a><ul id="guides-menu" class="submenu guides hidden inline-submenu-lg" aria-labelledby="guides-button"><li class="apis-link-container mobile-only "><a href="/en-US/docs/Learn" class="submenu-item "><div class="submenu-icon learn"></div><div class="submenu-content-container"><div class="submenu-item-heading">Overview / MDN Learning Area</div><p class="submenu-item-description">Learn web development</p></div></a></li><li class="apis-link-container desktop-only "><a href="/en-US/docs/Learn" class="submenu-item "><div class="submenu-icon learn"></div><div class="submenu-content-container"><div class="submenu-item-heading">MDN Learning Area</div><p class="submenu-item-description">Learn web development</p></div></a></li><li class="html-link-container "><a href="/en-US/docs/Learn/HTML" class="submenu-item "><div class="submenu-icon html"></div><div class="submenu-content-container"><div class="submenu-item-heading">HTML</div><p class="submenu-item-description">Learn to structure web content with HTML</p></div></a></li><li class="css-link-container "><a href="/en-US/docs/Learn/CSS" class="submenu-item "><div class="submenu-icon css"></div><div class="submenu-content-container"><div class="submenu-item-heading">CSS</div><p class="submenu-item-description">Learn to style content using CSS</p></div></a></li><li class="javascript-link-container "><a href="/en-US/docs/Learn/JavaScript" class="submenu-item "><div class="submenu-icon javascript"></div><div class="submenu-content-container"><div class="submenu-item-heading">JavaScript</div><p class="submenu-item-description">Learn to run scripts in the browser</p></div></a></li><li class=" "><a href="/en-US/docs/Web/Accessibility" class="submenu-item "><div class="submenu-icon"></div><div class="submenu-content-container"><div class="submenu-item-heading">Accessibility</div><p class="submenu-item-description">Learn to make the web accessible to all</p></div></a></li></ul></li><li class="top-level-entry-container "><a class="top-level-entry menu-link" href="/en-US/blog/">Blog</a></li><li class="top-level-entry-container "><a class="top-level-entry menu-link" href="/en-US/play">Play</a></li><li class="top-level-entry-container "><a class="top-level-entry menu-link" href="/en-US/plus/ai-help">AI Help <sup class="new beta">Beta</sup></a></li></ul></nav><div class="header-search"><form action="/en-US/search" class="search-form search-widget" id="top-nav-search-form" role="search"><label id="top-nav-search-label" for="top-nav-search-input" class="visually-hidden">Search MDN</label><input aria-activedescendant="" aria-autocomplete="list" aria-controls="top-nav-search-menu" aria-expanded="false" aria-labelledby="top-nav-search-label" autoComplete="off" id="top-nav-search-input" role="combobox" type="search" class="search-input-field" name="q" placeholder="   " required="" value=""/><button type="button" class="button action has-icon clear-search-button"><span class="button-wrap"><span class="icon icon-cancel "></span><span class="visually-hidden">Clear search input</span></span></button><button type="submit" class="button action has-icon search-button"><span class="button-wrap"><span class="icon icon-search "></span><span class="visually-hidden">Search</span></span></button><div id="top-nav-search-menu" role="listbox" aria-labelledby="top-nav-search-label"></div></form></div><div class="theme-switcher-menu"><button type="button" class="button action has-icon theme-switcher-menu small" aria-haspopup="menu"><span class="button-wrap"><span class="icon icon-theme-os-default "></span>Theme</span></button></div><ul class="auth-container"><li><a href="?next=%2Fen-US%2Fdocs%2FWeb%2FAPI%2FShared_Storage_API" class="login-link" rel="nofollow">Log in</a></li><li><a href="?next=%2Fen-US%2Fdocs%2FWeb%2FAPI%2FShared_Storage_API" target="_self" class="button primary mdn-plus-subscribe-link"><span class="button-wrap">Sign up for free</span></a></li></ul></div></div></header><div class="article-actions-container"><div class="container"><button type="button" class="button action has-icon sidebar-button" aria-label="Expand sidebar" aria-expanded="false" aria-controls="sidebar-quicklinks"><span class="button-wrap"><span class="icon icon-sidebar "></span></span></button><nav class="breadcrumbs-container" aria-label="Breadcrumb"><ol typeof="BreadcrumbList" vocab="https://schema.org/" aria-label="breadcrumbs"><li property="itemListElement" typeof="ListItem"><a class="breadcrumb" property="item" typeof="WebPage" href="/en-US/docs/Web"><span property="name">References</span></a><meta property="position" content="1"/></li><li property="itemListElement" typeof="ListItem"><a class="breadcrumb" property="item" typeof="WebPage" href="/en-US/docs/Web/API"><span property="name">Web APIs</span></a><meta property="position" content="2"/></li><li property="itemListElement" typeof="ListItem"><a class="breadcrumb-current-page" property="item" typeof="WebPage" href="/en-US/docs/Web/API/Shared_Storage_API"><span property="name">Shared Storage API</span></a><meta property="position" content="3"/></li></ol></nav></div></div></div><div class="main-wrapper"><div class="sidebar-container"><aside id="sidebar-quicklinks" class="sidebar" data-macro="DefaultAPISidebar"><button type="button" class="button action backdrop" aria-label="Collapse sidebar"><span class="button-wrap"></span></button><nav aria-label="Related Topics" class="sidebar-inner"><header class="sidebar-actions"><section class="sidebar-filter-container"><div class="sidebar-filter "><label id="sidebar-filter-label" class="sidebar-filter-label" for="sidebar-filter-input"><span class="icon icon-filter"></span><span class="visually-hidden">Filter sidebar</span></label><input id="sidebar-filter-input" autoComplete="off" class="sidebar-filter-input-field false" type="text" placeholder="Filter" value=""/><button type="button" class="button action has-icon clear-sidebar-filter-button"><span class="button-wrap"><span class="icon icon-cancel "></span><span class="visually-hidden">Clear filter input</span></span></button></div></section></header><div class="sidebar-inner-nav"><div class="in-nav-toc"><div class="document-toc-container"><section class="document-toc"><header><h2 class="document-toc-heading">In this article</h2></header><ul class="document-toc-list"><li class="document-toc-item "><a class="document-toc-link" href="#concepts_and_usage">Concepts and usage</a></li><li class="document-toc-item "><a class="document-toc-link" href="#output_gates">Output gates</a></li><li class="document-toc-item "><a class="document-toc-link" href="#understanding_how_shared_storage_works">Understanding how shared storage works</a></li><li class="document-toc-item "><a class="document-toc-link" href="#differences_between_shared_storage_and_web_storage">Differences between shared storage and web storage</a></li><li class="document-toc-item "><a class="document-toc-link" href="#interfaces">Interfaces</a></li><li class="document-toc-item "><a class="document-toc-link" href="#enrollment_and_local_testing">Enrollment and local testing</a></li><li class="document-toc-item "><a class="document-toc-link" href="#examples">Examples</a></li><li class="document-toc-item "><a class="document-toc-link" href="#specifications">Specifications</a></li><li class="document-toc-item "><a class="document-toc-link" href="#browser_compatibility">Browser compatibility</a></li><li class="document-toc-item "><a class="document-toc-link" href="#see_also">See also</a></li></ul></section></div></div><div class="sidebar-body"><ol><li><strong><em><a href="/en-US/docs/Web/API/Shared_Storage_API" aria-current="page">Shared Storage API</a></em></strong></li><li class="toggle"><details open=""><summary>Interfaces</summary><ol><li><a href="/en-US/docs/Web/API/SharedStorage"><code>SharedStorage</code></a></li><li><a href="/en-US/docs/Web/API/SharedStorageOperation"><code>SharedStorageOperation</code></a></li><li><a href="/en-US/docs/Web/API/SharedStorageRunOperation"><code>SharedStorageRunOperation</code></a></li><li><a href="/en-US/docs/Web/API/SharedStorageSelectURLOperation"><code>SharedStorageSelectURLOperation</code></a></li><li><a href="/en-US/docs/Web/API/SharedStorageWorklet"><code>SharedStorageWorklet</code></a></li><li><a href="/en-US/docs/Web/API/SharedStorageWorkletGlobalScope"><code>SharedStorageWorkletGlobalScope</code></a></li><li><a href="/en-US/docs/Web/API/WindowSharedStorage"><code>WindowSharedStorage</code></a></li><li><a href="/en-US/docs/Web/API/WorkletSharedStorage"><code>WorkletSharedStorage</code></a></li></ol></details></li><li class="toggle"><details open=""><summary>Properties</summary><ol><li><a href="/en-US/docs/Web/API/Window/sharedStorage"><code>Window.sharedStorage</code></a></li></ol></details></li></ol></div></div></nav></aside><div class="toc-container"><aside class="toc"><nav><div class="document-toc-container"><section class="document-toc"><header><h2 class="document-toc-heading">In this article</h2></header><ul class="document-toc-list"><li class="document-toc-item "><a class="document-toc-link" href="#concepts_and_usage">Concepts and usage</a></li><li class="document-toc-item "><a class="document-toc-link" href="#output_gates">Output gates</a></li><li class="document-toc-item "><a class="document-toc-link" href="#understanding_how_shared_storage_works">Understanding how shared storage works</a></li><li class="document-toc-item "><a class="document-toc-link" href="#differences_between_shared_storage_and_web_storage">Differences between shared storage and web storage</a></li><li class="document-toc-item "><a class="document-toc-link" href="#interfaces">Interfaces</a></li><li class="document-toc-item "><a class="document-toc-link" href="#enrollment_and_local_testing">Enrollment and local testing</a></li><li class="document-toc-item "><a class="document-toc-link" href="#examples">Examples</a></li><li class="document-toc-item "><a class="document-toc-link" href="#specifications">Specifications</a></li><li class="document-toc-item "><a class="document-toc-link" href="#browser_compatibility">Browser compatibility</a></li><li class="document-toc-item "><a class="document-toc-link" href="#see_also">See also</a></li></ul></section></div></nav></aside></div></div><main id="content" class="main-content  "><article class="main-page-content" lang="en-US"><header><h1>Shared Storage API</h1></header><div class="section-content"><div class="notecard experimental" id="sect1"><p><strong>Experimental:</strong> <strong>This is an <a href="/en-US/docs/MDN/Writing_guidelines/Experimental_deprecated_obsolete#experimental">experimental technology</a></strong><br>Check the <a href="#browser_compatibility">Browser compatibility table</a> carefully before using this in production.</p></div>
<p>The <strong>Shared Storage API</strong> is a client-side storage mechanism that enables unpartitioned, cross-site data access while preserving privacy (i.e. without relying on tracking cookies).</p></div><section aria-labelledby="concepts_and_usage"><h2 id="concepts_and_usage"><a href="#concepts_and_usage">Concepts and usage</a></h2><div class="section-content"><p>One major source of <a href="/en-US/docs/Web/Privacy">privacy</a> and <a href="/en-US/docs/Web/Security">security</a> problems on the web is the use of cookies set on third-party content embedded in sites (for example via <a href="/en-US/docs/Web/HTML/Element/iframe"><code>&lt;iframe&gt;</code></a> elements). These cookies can be used to track and profile users, and share information across sites.</p>
<p>To prevent cross-site tracking, browsers are working towards partitioning all storage types, including <a href="/en-US/docs/Web/HTTP/Cookies">Cookies</a>, <a href="/en-US/docs/Web/API/Web_Storage_API">Web Storage</a>, <a href="/en-US/docs/Web/API/IndexedDB_API">IndexedDB</a>, and the <a href="/en-US/docs/Web/API/Cache">Cache API</a>. However, a major barrier to achieving this is the need for several legitimate use cases that rely on cross-site information sharing. Examples of such uses cases include advertisers wanting to measure the reach of their across sites and generate reports, and site owners wanting to customize user experiences based on the group they are in or their previous site interactions.</p>
<p>The Shared Storage API provides a flexible solution for such use cases. It aims to provide the required data storage, processing, and sharing capabilities without the ability to track and profile users.</p>
<p>Like other storage APIs, you can write to shared storage at any time. However, you can only read shared storage data from inside a <a href="/en-US/docs/Web/API/SharedStorageWorklet" title="worklet">worklet</a>. Worklets provide a secure environment inside which you can process shared storage data and return useful results, but you can't directly share the data with the associated browsing context.</p>
<p>To extract useful results from a shared storage worklet, you need to use an <strong>output gate</strong>. These gates serve specific purposes such as selecting a URL from a provided list to display to the user based on shared storage data. Results meant for the user are shown securely inside a <a href="/en-US/docs/Web/API/Fenced_Frame_API" class="page-not-created" title="This is a link to an unwritten page" data-flaw="link1">fenced frame</a> where they can't be accessed from the embedding page.</p></div></section><section aria-labelledby="output_gates"><h2 id="output_gates"><a href="#output_gates">Output gates</a></h2><div class="section-content"><p>The currently available output gates for the Shared Storage API are discussed in the sections below. In each section, we list typical use cases for each gate and provide links to guides with more information and code examples.</p>
<div class="notecard note" id="sect2">
  <p><strong>Note:</strong> More output gates will likely be added in the future to support additional use cases.</p>
</div></div></section><section aria-labelledby="url_selection"><h3 id="url_selection"><a href="#url_selection">URL Selection</a></h3><div class="section-content"><p>The <strong>URL Selection</strong> output gate, accessed via the <a href="/en-US/docs/Web/API/WindowSharedStorage/selectURL" title="selectURL()"><code>selectURL()</code></a> method, is used to select a URL from a provided list to display to the user, based on shared storage data. This gate be used for the following purposes:</p>
<ul>
  <li><a href="https://developer.chrome.com/docs/privacy-sandbox/shared-storage/creative-rotation/" class="external" target="_blank"><strong>Creative rotation</strong></a>: Use stored data such as creative IDs, view counts, and user interaction to determine which creative content users see across different sites. This approach helps in balancing views and prevents overexposure of certain content, which in turn can help avoid a negative user experience.</li>
  <li><a href="https://developer.chrome.com/docs/privacy-sandbox/shared-storage/ab-testing/" class="external" target="_blank"><strong>A/B testing</strong></a>: Assign a user to an experiment group, then store group details in shared storage for cross-site access.</li>
  <li><a href="https://developer.chrome.com/docs/privacy-sandbox/shared-storage/known-customer/" class="external" target="_blank"><strong>Custom user experiences</strong></a>: Share custom content and calls-to-action based on a user's registration status or other user states.</li>
</ul></div></section><section aria-labelledby="run"><h3 id="run"><a href="#run">Run</a></h3><div class="section-content"><p>The <strong>Run</strong> output gate, accessed via the <a href="/en-US/docs/Web/API/WindowSharedStorage/run" title="run()"><code>run()</code></a> method, is intended to be used in a generic way to process some shared storage data.</p>
<p>The <a href="https://developer.chrome.com/docs/privacy-sandbox/private-aggregation/" class="external" target="_blank">Private Aggregation API</a> can use the Run output gate to process shared storage data and generate aggregated reports. These reports can be used in the following use cases:</p>
<ul>
  <li><a href="https://developer.chrome.com/docs/privacy-sandbox/shared-storage/unique-reach/" class="external" target="_blank"><strong>Unique reach reporting</strong></a>: Content producers and advertisers often want to know the number of unique viewers for their content. You can use shared storage to report the first time a user sees your ad or embedded publication and prevent duplicate counting for the same user on a different site, giving you an aggregated noisy report of approximate unique reach.</li>
  <li><a href="https://developer.chrome.com/docs/privacy-sandbox/shared-storage/user-demographics/" class="external" target="_blank"><strong>User demographic reporting</strong></a>: Content producers often want to understand the demographics of their audience. You can use shared storage to record user demographic data on your main site, and use aggregated reporting to report on it across other sites in embedded contexts.</li>
  <li><a href="https://developer.chrome.com/docs/privacy-sandbox/shared-storage/k-freq-reach/" class="external" target="_blank"><strong>K+ frequency measurement</strong></a>: Sometimes described as "effective frequency", K+ frequency refers to the minimum number of views needed before a user will recognize or recall certain content (often used in the context of ad views). You can use shared storage to build reports of unique users who have seen a piece of content at least K times.</li>
</ul></div></section><section aria-labelledby="understanding_how_shared_storage_works"><h2 id="understanding_how_shared_storage_works"><a href="#understanding_how_shared_storage_works">Understanding how shared storage works</a></h2><div class="section-content"><p>There are two parts to using the Shared Storage API — writing data to storage and reading/processing it. To give you an idea of how these parts are handled, we'll walk you through the basic <a href="https://developer.chrome.com/docs/privacy-sandbox/shared-storage/ab-testing/" class="external" target="_blank">A/B testing</a> example from developer.chrome.com. In this example, a user is assigned to an experiment group, and the group details are stored in shared storage. Other sites are able to use this data when choosing a URL to display in a <a href="/en-US/docs/Web/API/Fenced_Frame_API" class="page-not-created" title="This is a link to an unwritten page" data-flaw="link2">fenced frame</a>.</p></div></section><section aria-labelledby="writing_to_shared_storage"><h3 id="writing_to_shared_storage"><a href="#writing_to_shared_storage">Writing to shared storage</a></h3><div class="section-content"><p>Writing data to shared storage is simple — you use methods defined on the <a href="/en-US/docs/Web/API/SharedStorage"><code>SharedStorage</code></a> interface to <a href="/en-US/docs/Web/API/SharedStorage/set" title="set">set</a>, <a href="/en-US/docs/Web/API/SharedStorage/append" title="append">append</a>, or <a href="/en-US/docs/Web/API/SharedStorage/delete" title="delete">delete</a>/<a href="/en-US/docs/Web/API/SharedStorage/clear" title="clear">clear</a> data.</p>
<p>This functionality is available in two different contexts:</p>
<ul>
  <li>In the main browsing context, where your site or app runs, on <a href="/en-US/docs/Web/API/WindowSharedStorage"><code>WindowSharedStorage</code></a>. This is available via <code>window.sharedStorage</code>.</li>
  <li>In the context of your shared storage worklet, on <a href="/en-US/docs/Web/API/WorkletSharedStorage"><code>WorkletSharedStorage</code></a>. This is is available via <code>this.sharedStorage</code>.</li>
</ul>
<p>In our A/B testing example, we define a function in our app context that generates a random number — 0 or 1 — to represent an experiment group. We then run the <a href="/en-US/docs/Web/API/SharedStorage/set" title="window.sharedStorage.set()"><code>window.sharedStorage.set()</code></a> function to assign the user to a group and save the result in shared storage:</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code><span class="token comment">// Randomly assigns a user to a group 0 or 1</span>
<span class="token keyword">function</span> <span class="token function">getExperimentGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">injectContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Assign user to a random group (0 or 1) and store it in shared storage</span>
  window<span class="token punctuation">.</span>sharedStorage<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"ab-testing-group"</span><span class="token punctuation">,</span> <span class="token function">getExperimentGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">ignoreIfPresent</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div>
<div class="notecard note" id="sect3">
  <p><strong>Note:</strong> The <code>ignoreIfPresent: true</code> option causes the <code>set()</code> function to abort if the shared storage already contains a data item with the specified key.</p>
</div></div></section><section aria-labelledby="reading_and_processing_data_from_shared_storage"><h3 id="reading_and_processing_data_from_shared_storage"><a href="#reading_and_processing_data_from_shared_storage">Reading and processing data from shared storage</a></h3><div class="section-content"><p>As mentioned above, to extract useful results from a shared storage worklet, you need to use an <strong>output gate</strong>. In this example, we'll use the <a href="#url_selection">URL Selection output gate</a> to read the user's experiment group and then display a URL in a fenced frame based on their group.</p>
<p>To use the output gate, you need to:</p>
<ol>
  <li>Define an operation in a worklet module script to handle choosing the URL, and register it.</li>
  <li>Add the module to your shared storage worklet.</li>
  <li>Choose the URL using the worklet operation and load it in a fenced frame.</li>
</ol>
<p>Below we'll look at these steps one by one.</p>
<h4 id="define_an_operation_in_a_worklet_module">Define an operation in a worklet module</h4>
<p>The URL selection is based on the experiment group stored in shared storage. To retrieve this value and choose a URL based on it, we need to define an operation in a <a href="/en-US/docs/Web/API/SharedStorageWorklet"><code>SharedStorageWorklet</code></a> context. This ensures the raw data is hidden from other contexts, thereby preserving privacy.</p>
<p>The URL Selection operation is a JavaScript class that must follow the rules below (these rules vary for each output gate, depending on their intended use case):</p>
<ul>
  <li>The actual functionality must be contained in an asynchronous <code>run()</code> method, which takes an array of objects containing URLs as its first parameter and a data object as its second parameter (when called, the data argument is optional).</li>
  <li>The <code>run()</code> method must return a number, which will equate to the number of the URL chosen.</li>
</ul>
<div class="notecard note" id="sect4">
  <p><strong>Note:</strong> Each output gate has a corresponding interface that defines the required structure of its class and <code>run()</code> method. For URL Selection, see <a href="/en-US/docs/Web/API/SharedStorageSelectURLOperation"><code>SharedStorageSelectURLOperation</code></a>.</p>
</div>
<p>Once the operation is defined, it needs to be registered using <a href="/en-US/docs/Web/API/SharedStorageWorkletGlobalScope/register"><code>SharedStorageWorkletGlobalScope.register()</code></a>.</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code><span class="token comment">// ab-testing-worklet.js</span>
<span class="token keyword">class</span> <span class="token class-name">SelectURLOperation</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token parameter">urls<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Read the user's experiment group from shared storage</span>
    <span class="token keyword">const</span> experimentGroup <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sharedStorage<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"ab-testing-group"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Return the group number</span>
    <span class="token keyword">return</span> experimentGroup<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token function">register</span><span class="token punctuation">(</span><span class="token string">"ab-testing"</span><span class="token punctuation">,</span> SelectURLOperation<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>Notice how the value set in our main app context is retrieved using <a href="/en-US/docs/Web/API/WorkletSharedStorage/get"><code>WorkletSharedStorage.get()</code></a>. To reiterate, to preserve privacy and mitigate data leakage, you can read values from shared storage only within a worklet.</p>
<div class="notecard note" id="sect5">
  <p><strong>Note:</strong> It is possible to define and register multiple operations in the same shared storage worklet module script with different names; see <a href="/en-US/docs/Web/API/SharedStorageOperation"><code>SharedStorageOperation</code></a> for an example.</p>
</div>
<h4 id="add_the_module_to_the_shared_storage_worklet">Add the module to the shared storage worklet</h4>
<p>To use the operation defined in the worklet module, it needs to be added to the shared storage worklet using <a href="/en-US/docs/Web/API/Worklet/addModule" title="window.sharedStorage.worklet.addModule()"><code>window.sharedStorage.worklet.addModule()</code></a>. In our main app context, this is done before we set the experiment group value, so that it is ready to use when needed:</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">injectContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Add the module to the shared storage worklet</span>
  <span class="token keyword">await</span> window<span class="token punctuation">.</span>sharedStorage<span class="token punctuation">.</span>worklet<span class="token punctuation">.</span><span class="token function">addModule</span><span class="token punctuation">(</span><span class="token string">"ab-testing-worklet.js"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Assign user to a random group (0 or 1) and store it in shared storage</span>
  window<span class="token punctuation">.</span>sharedStorage<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"ab-testing-group"</span><span class="token punctuation">,</span> <span class="token function">getExperimentGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">ignoreIfPresent</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div>
<h4 id="choose_a_url_and_load_it_in_a_fenced_frame">Choose a URL and load it in a fenced frame</h4>
<p>To run the operation defined in the worklet, we call <a href="/en-US/docs/Web/API/WindowSharedStorage/selectURL"><code>WindowSharedStorage.selectURL()</code></a>. This method acts as a proxy to our worklet operation, accessing it securely and returning the result without leaking any data. <code>selectURL()</code> is the correct method to call our user-defined worklet operation because it was defined with the appropriate class structure for a URL Selection operation, as discussed above.</p>
<p><code>selectURL()</code> expects an array of objects containing URLs to choose from, an optional options object, and for the underlying operation to return an integer that it can use to choose a URL.</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code><span class="token comment">// Run the URL selection operation</span>
<span class="token keyword">const</span> fencedFrameConfig <span class="token operator">=</span> <span class="token keyword">await</span> window<span class="token punctuation">.</span>sharedStorage<span class="token punctuation">.</span><span class="token function">selectURL</span><span class="token punctuation">(</span>
  <span class="token string">"ab-testing"</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">https://your-server.example/content/default-content.html</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">https://your-server.example/content/experiment-content-a.html</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">resolveToConfig</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>Because the options object contains <code>resolveToConfig: true</code>, the returned <a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise"><code>Promise</code></a> will resolve with a <a class="page-not-created" title="The documentation about this has not yet been written; please consider contributing!" data-flaw-src="{{domxref(&quot;FencedFrameConfig&quot;)}}"><code>FencedFrameConfig</code></a> object. This object can be set as the value of the <a class="page-not-created" title="The documentation about this has not yet been written; please consider contributing!" data-flaw-src="{{domxref(&quot;HTMLFencedFrameElement.config&quot;)}}"><code>HTMLFencedFrameElement.config</code></a> property, resulting in the content of the chosen URL being displayed in the corresponding <a class="page-not-created" title="The documentation about this has not yet been written; please consider contributing!" data-flaw-src="{{htmlelement(&quot;fencedframe&quot;)}}"><code>&lt;fencedframe&gt;</code></a> element:</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"content-slot"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>config <span class="token operator">=</span> fencedFrameConfig<span class="token punctuation">;</span>
</code></pre></div>
<p>The full app script looks like so:</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code><span class="token comment">// Randomly assigns a user to a group 0 or 1</span>
<span class="token keyword">function</span> <span class="token function">getExperimentGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">injectContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Add the module to the shared storage worklet</span>
  <span class="token keyword">await</span> window<span class="token punctuation">.</span>sharedStorage<span class="token punctuation">.</span>worklet<span class="token punctuation">.</span><span class="token function">addModule</span><span class="token punctuation">(</span><span class="token string">"ab-testing-worklet.js"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Assign user to a random group (0 or 1) and store it in shared storage</span>
  window<span class="token punctuation">.</span>sharedStorage<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"ab-testing-group"</span><span class="token punctuation">,</span> <span class="token function">getExperimentGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">ignoreIfPresent</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Run the URL selection operation</span>
  <span class="token keyword">const</span> fencedFrameConfig <span class="token operator">=</span> <span class="token keyword">await</span> window<span class="token punctuation">.</span>sharedStorage<span class="token punctuation">.</span><span class="token function">selectURL</span><span class="token punctuation">(</span>
    <span class="token string">"ab-testing"</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>
      <span class="token punctuation">{</span> <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">https://your-server.example/content/default-content.html</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">https://your-server.example/content/experiment-content-a.html</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">resolveToConfig</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Render the chosen URL into a fenced frame</span>
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"content-slot"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>config <span class="token operator">=</span> fencedFrameConfig<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">injectContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div></section><section aria-labelledby="differences_between_shared_storage_and_web_storage"><h2 id="differences_between_shared_storage_and_web_storage"><a href="#differences_between_shared_storage_and_web_storage">Differences between shared storage and web storage</a></h2><div class="section-content"><p>The key difference is that shared storage is intended for use with cross-origin data after storage has been partitioned.</p>
<ul>
  <li>If you are a publisher and you want to store first-party data that is accessible to only you, use the <a href="/en-US/docs/Web/API/Window/localStorage"><code>localStorage</code></a> version of <a href="/en-US/docs/Web/API/Web_Storage_API">web storage</a>.</li>
  <li>If you want data to persist only during a browser session, use <a href="/en-US/docs/Web/API/Window/sessionStorage"><code>sessionStorage</code></a>.</li>
  <li>If you are operating as a third-party on another site, and you want to record data from that site to access later on another site, use shared storage.</li>
</ul>
<p>Another important difference between shared storage and web storage is that reading from shared storage is guarded (writing to storage behaves similarly). With <code>localStorage</code> and <code>sessionStorage</code>, you can read freely. With shared storage, reading can happen only within a shared storage worklet, and the origin used for reading in the worklet is the same as the browsing context that created it.</p>
<p>Additionally, you cannot extract shared storage data outside of a shared storage worklet, as a tracking protection. You must use one of the output gates to work with your data in shared storage.</p>
<p>Lastly, data in <code>localStorage</code> persists until it is manually cleared. <code>sessionStorage</code> clears at the end of a browsing session, whereas shared storage data clears 30 days after the last write call.</p></div></section><section aria-labelledby="interfaces"><h2 id="interfaces"><a href="#interfaces">Interfaces</a></h2><div class="section-content"><dl>
  <dt id="sharedstorage"><a href="/en-US/docs/Web/API/SharedStorage"><code>SharedStorage</code></a></dt>
  <dd>
    <p>Represents the shared storage for a particular origin. It defines methods to write data to the shared storage.</p>
  </dd>
  <dt id="windowsharedstorage"><a href="/en-US/docs/Web/API/WindowSharedStorage"><code>WindowSharedStorage</code></a></dt>
  <dd>
    <p>Represents the shared storage for a particular origin as exposed to a standard browsing context. Among other things, it defines methods to use the available output gates, which act as proxies for the operations defined in the worklet.</p>
  </dd>
  <dt id="workletsharedstorage"><a href="/en-US/docs/Web/API/WorkletSharedStorage"><code>WorkletSharedStorage</code></a></dt>
  <dd>
    <p>Represents the shared storage for a particular origin within a worklet context. Among other things, it defines methods to read the shared storage data.</p>
  </dd>
  <dt id="sharedstorageworklet"><a href="/en-US/docs/Web/API/SharedStorageWorklet"><code>SharedStorageWorklet</code></a></dt>
  <dd>
    <p>Represents the current origin's shared storage worklet. It contains the <a href="/en-US/docs/Web/API/Worklet/addModule" title="addModule()"><code>addModule()</code></a> method for adding modules. Unlike a regular <a href="/en-US/docs/Web/API/Worklet"><code>Worklet</code></a>, the <code>SharedStorageWorklet</code> can have only a single module added to it, for privacy reasons.</p>
  </dd>
  <dt id="sharedstorageworkletglobalscope"><a href="/en-US/docs/Web/API/SharedStorageWorkletGlobalScope"><code>SharedStorageWorkletGlobalScope</code></a></dt>
  <dd>
    <p>Represents the global scope of a <a href="/en-US/docs/Web/API/SharedStorageWorklet"><code>SharedStorageWorklet</code></a> module. It contains the functionality to <a href="/en-US/docs/Web/API/SharedStorageWorkletGlobalScope/register" title="register">register</a> a defined operation and <a href="/en-US/docs/Web/API/SharedStorageWorkletGlobalScope/sharedStorage" title="access the shared storage">access the shared storage</a>.</p>
  </dd>
</dl></div></section><section aria-labelledby="output_gate_operation_signature_definitions"><h3 id="output_gate_operation_signature_definitions"><a href="#output_gate_operation_signature_definitions">Output gate operation signature definitions</a></h3><div class="section-content"><dl>
  <dt id="sharedstorageoperation"><a href="/en-US/docs/Web/API/SharedStorageOperation"><code>SharedStorageOperation</code></a></dt>
  <dd>
    <p>Represents the base class for all different output gate operation types.</p>
  </dd>
  <dt id="sharedstoragerunoperation"><a href="/en-US/docs/Web/API/SharedStorageRunOperation"><code>SharedStorageRunOperation</code></a></dt>
  <dd>
    <p>Represents a Run output gate operation.</p>
  </dd>
  <dt id="sharedstorageselecturloperation"><a href="/en-US/docs/Web/API/SharedStorageSelectURLOperation"><code>SharedStorageSelectURLOperation</code></a></dt>
  <dd>
    <p>Represents a URL Selection output gate operation.</p>
  </dd>
</dl></div></section><section aria-labelledby="extensions_to_other_interfaces"><h3 id="extensions_to_other_interfaces"><a href="#extensions_to_other_interfaces">Extensions to other interfaces</a></h3><div class="section-content"><dl>
  <dt id="window.sharedstorage"><a href="/en-US/docs/Web/API/Window/sharedStorage"><code>Window.sharedStorage</code></a></dt>
  <dd>
    <p>Returns the <a href="/en-US/docs/Web/API/WindowSharedStorage"><code>WindowSharedStorage</code></a> object for the current origin.</p>
  </dd>
</dl></div></section><section aria-labelledby="enrollment_and_local_testing"><h2 id="enrollment_and_local_testing"><a href="#enrollment_and_local_testing">Enrollment and local testing</a></h2><div class="section-content"><p>To use the Shared Storage API in your sites, you must specify it in the <a href="/en-US/docs/Web/Privacy/Privacy_sandbox/Enrollment" class="page-not-created" title="This is a link to an unwritten page" data-flaw="link3">privacy sandbox enrollment process</a>. If you don't, the Shared Storage API methods won't run successfully.</p>
<p>You can test your Shared Storage API code locally without enrollment. To allow local testing, enable the following Chrome developer flag:</p>
<p><code>chrome://flags/#privacy-sandbox-enrollment-overrides</code></p></div></section><section aria-labelledby="examples"><h2 id="examples"><a href="#examples">Examples</a></h2><div class="section-content"><p>For extensive demos, see the <a href="https://shared-storage-demo.web.app/" class="external" target="_blank">Shared Storage API demo site</a>, which also includes some Private Aggregation API examples.</p></div></section><h2 id="specifications"><a href="#specifications">Specifications</a></h2><table class="standard-table"><thead><tr><th scope="col">Specification</th></tr></thead><tbody><tr><td><a href="https://wicg.github.io/shared-storage/#sharedstorage">Shared Storage API<!-- --> <br/><small># <!-- -->sharedstorage</small></a></td></tr></tbody></table><h2 id="browser_compatibility"><a href="#browser_compatibility">Browser compatibility</a></h2><p>BCD tables only load in the browser<noscript> <!-- -->with JavaScript enabled. Enable JavaScript to view data.</noscript></p><section aria-labelledby="see_also"><h2 id="see_also"><a href="#see_also">See also</a></h2><div class="section-content"><ul>
  <li><a href="https://developer.chrome.com/docs/privacy-sandbox/shared-storage/" class="external" target="_blank">Shared Storage</a> on developer.chrome.com</li>
  <li><a href="https://developer.chrome.com/docs/privacy-sandbox/" class="external" target="_blank">The Privacy Sandbox</a> on developer.chrome.com</li>
</ul></div></section><aside class="metadata"><div class="metadata-content-container"><div id="on-github" class="on-github"><h3>Found a content problem with this page?</h3><ul><li><a href="https://github.com/mdn/content/edit/main/files/en-us/web/api/shared_storage_api/index.md" title="This will take you to GitHub, where you&#x27;ll need to sign in first." target="_blank" rel="noopener noreferrer">Edit the page on GitHub</a>.</li><li><a href="https://github.com/mdn/content/issues/new?template=page-report.yml&amp;mdn-url=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FShared_Storage_API&amp;metadata=%3C%21--+Do+not+make+changes+below+this+line+--%3E%0A%3Cdetails%3E%0A%3Csummary%3EPage+report+details%3C%2Fsummary%3E%0A%0A*+Folder%3A+%60en-us%2Fweb%2Fapi%2Fshared_storage_api%60%0A*+MDN+URL%3A+https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FShared_Storage_API%0A*+GitHub+URL%3A+https%3A%2F%2Fgithub.com%2Fmdn%2Fcontent%2Fblob%2Fmain%2Ffiles%2Fen-us%2Fweb%2Fapi%2Fshared_storage_api%2Findex.md%0A*+Last+commit%3A+https%3A%2F%2Fgithub.com%2Fmdn%2Fcontent%2Fcommit%2F87f5aacd076db585bf04699b8bc584bcc7b6b467%0A*+Document+last+modified%3A+2023-12-06T16%3A02%3A13.000Z%0A%0A%3C%2Fdetails%3E" title="This will take you to GitHub to file a new issue." target="_blank" rel="noopener noreferrer">Report the content issue</a>.</li><li><a href="https://github.com/mdn/content/blob/main/files/en-us/web/api/shared_storage_api/index.md?plain=1" title="Folder: en-us/web/api/shared_storage_api (Opens in a new tab)" target="_blank" rel="noopener noreferrer">View the source on GitHub</a>.</li></ul>Want to get more involved?<!-- --> <a href="https://github.com/mdn/content/blob/main/CONTRIBUTING.md" title="This will take you to our contribution guidelines on GitHub." target="_blank" rel="noopener noreferrer">Learn how to contribute</a>.</div><p class="last-modified-date">This page was last modified on<!-- --> <time dateTime="2023-12-06T16:02:13.000Z">Dec 7, 2023</time> by<!-- --> <a href="/en-US/docs/Web/API/Shared_Storage_API/contributors.txt">MDN contributors</a>.</p></div></aside></article></main></div></div><footer id="nav-footer" class="page-footer"><div class="page-footer-grid"><div class="page-footer-logo-col"><a href="/" class="mdn-footer-logo" aria-label="MDN homepage"><svg width="48" height="17" viewBox="0 0 48 17" fill="none" xmlns="http://www.w3.org/2000/svg"><title id="mdn-footer-logo-svg">MDN logo</title><path d="M20.04 16.512H15.504V10.416C15.504 9.488 15.344 8.824 15.024 8.424C14.72 8.024 14.264 7.824 13.656 7.824C12.92 7.824 12.384 8.064 12.048 8.544C11.728 9.024 11.568 9.64 11.568 10.392V14.184H13.008V16.512H8.472V10.416C8.472 9.488 8.312 8.824 7.992 8.424C7.688 8.024 7.232 7.824 6.624 7.824C5.872 7.824 5.336 8.064 5.016 8.544C4.696 9.024 4.536 9.64 4.536 10.392V14.184H6.6V16.512H0V14.184H1.44V8.04H0.024V5.688H4.536V7.32C5.224 6.088 6.32 5.472 7.824 5.472C8.608 5.472 9.328 5.664 9.984 6.048C10.64 6.432 11.096 7.016 11.352 7.8C11.992 6.248 13.168 5.472 14.88 5.472C15.856 5.472 16.72 5.776 17.472 6.384C18.224 6.992 18.6 7.936 18.6 9.216V14.184H20.04V16.512Z" fill="currentColor"></path><path d="M33.6714 16.512H29.1354V14.496C28.8314 15.12 28.3834 15.656 27.7914 16.104C27.1994 16.536 26.4154 16.752 25.4394 16.752C24.0154 16.752 22.8954 16.264 22.0794 15.288C21.2634 14.312 20.8554 12.984 20.8554 11.304C20.8554 9.688 21.2554 8.312 22.0554 7.176C22.8554 6.04 24.0634 5.472 25.6794 5.472C26.5594 5.472 27.2794 5.648 27.8394 6C28.3994 6.352 28.8314 6.8 29.1354 7.344V2.352H26.9754V0H32.2314V14.184H33.6714V16.512ZM29.1354 11.04V10.776C29.1354 9.88 28.8954 9.184 28.4154 8.688C27.9514 8.176 27.3674 7.92 26.6634 7.92C25.9754 7.92 25.3674 8.176 24.8394 8.688C24.3274 9.2 24.0714 10.008 24.0714 11.112C24.0714 12.152 24.3114 12.944 24.7914 13.488C25.2714 14.032 25.8394 14.304 26.4954 14.304C27.3114 14.304 27.9514 13.96 28.4154 13.272C28.8954 12.584 29.1354 11.84 29.1354 11.04Z" fill="currentColor"></path><path d="M47.9589 16.512H41.9829V14.184H43.4229V10.416C43.4229 9.488 43.2629 8.824 42.9429 8.424C42.6389 8.024 42.1829 7.824 41.5749 7.824C40.8389 7.824 40.2709 8.056 39.8709 8.52C39.4709 8.968 39.2629 9.56 39.2469 10.296V14.184H40.6869V16.512H34.7109V14.184H36.1509V8.04H34.5909V5.688H39.2469V7.344C39.9669 6.096 41.1269 5.472 42.7269 5.472C43.7509 5.472 44.6389 5.776 45.3909 6.384C46.1429 6.992 46.5189 7.936 46.5189 9.216V14.184H47.9589V16.512Z" fill="currentColor"></path></svg></a><p>Your blueprint for a better internet.</p><ul class="social-icons"><li><a class="icon icon-mastodon" href="https://mozilla.social/@mdn" target="_blank" rel="me noopener noreferrer"><span class="visually-hidden">MDN on Mastodon</span></a></li><li><a class="icon icon-twitter" href="https://twitter.com/mozdevnet" target="_blank" rel="noopener noreferrer"><span class="visually-hidden">MDN on Twitter</span></a></li><li><a class="icon icon-github-mark-small" href="https://github.com/mdn/" target="_blank" rel="noopener noreferrer"><span class="visually-hidden">MDN on GitHub</span></a></li><li><a class="icon icon-feed" href="/en-US/blog/rss.xml" target="_blank"><span class="visually-hidden">MDN Blog RSS Feed</span></a></li></ul></div><div class="page-footer-nav-col-1"><h2 class="footer-nav-heading">MDN</h2><ul class="footer-nav-list"><li class="footer-nav-item"><a href="/en-US/about">About</a></li><li class="footer-nav-item"><a href="/en-US/blog/">Blog</a></li><li class="footer-nav-item"><a href="https://www.mozilla.org/en-US/careers/listings/?team=ProdOps" target="_blank" rel="noopener noreferrer">Careers</a></li><li class="footer-nav-item"><a href="/en-US/advertising">Advertise with us</a></li></ul></div><div class="page-footer-nav-col-2"><h2 class="footer-nav-heading">Support</h2><ul class="footer-nav-list"><li class="footer-nav-item"><a class="footer-nav-link" href="/en-US/docs/MDN/Community/Issues">Report an issue</a></li></ul></div><div class="page-footer-nav-col-3"><h2 class="footer-nav-heading">Our communities</h2><ul class="footer-nav-list"><li class="footer-nav-item"><a class="footer-nav-link" href="/en-US/community">MDN Community</a></li><li class="footer-nav-item"><a class="footer-nav-link" href="https://discourse.mozilla.org/c/mdn/236" target="_blank" rel="noopener noreferrer">MDN Forum</a></li><li class="footer-nav-item"><a class="footer-nav-link" href="/discord" target="_blank" rel="noopener noreferrer">MDN Chat</a></li></ul></div><div class="page-footer-nav-col-4"><h2 class="footer-nav-heading">Developers</h2><ul class="footer-nav-list"><li class="footer-nav-item"><a class="footer-nav-link" href="/en-US/docs/Web">Web Technologies</a></li><li class="footer-nav-item"><a class="footer-nav-link" href="/en-US/docs/Learn">Learn Web Development</a></li><li class="footer-nav-item"><a href="https://hacks.mozilla.org/" target="_blank" rel="noopener noreferrer">Hacks Blog</a></li></ul></div><div class="page-footer-moz"><a href="https://www.mozilla.org/" class="footer-moz-logo-link" target="_blank" rel="noopener noreferrer"><svg width="112" height="32" fill="none" xmlns="http://www.w3.org/2000/svg"><title id="mozilla-footer-logo-svg">Mozilla logo</title><path d="M41.753 14.218c-2.048 0-3.324 1.522-3.324 4.157 0 2.423 1.119 4.286 3.29 4.286 2.082 0 3.447-1.678 3.447-4.347 0-2.826-1.522-4.096-3.413-4.096Zm54.89 7.044c0 .901.437 1.618 1.645 1.618 1.427 0 2.949-1.024 3.044-3.352-.649-.095-1.365-.185-2.02-.185-1.426-.005-2.668.397-2.668 1.92Z" fill="currentColor"></path><path d="M0 0v32h111.908V0H0Zm32.56 25.426h-5.87v-7.884c0-2.423-.806-3.352-2.39-3.352-1.924 0-2.702 1.365-2.702 3.324v4.868h1.864v3.044h-5.864v-7.884c0-2.423-.806-3.352-2.39-3.352-1.924 0-2.702 1.365-2.702 3.324v4.868h2.669v3.044H6.642v-3.044h1.863v-7.918H6.642V11.42h5.864v2.11c.839-1.489 2.3-2.39 4.252-2.39 2.02 0 3.878.963 4.566 3.01.778-1.862 2.361-3.01 4.566-3.01 2.512 0 4.812 1.522 4.812 4.84v6.402h1.863v3.044h-.005Zm9.036.307c-4.314 0-7.296-2.635-7.296-7.106 0-4.096 2.484-7.481 7.514-7.481s7.481 3.38 7.481 7.29c0 4.472-3.228 7.297-7.699 7.297Zm22.578-.307H51.942l-.403-2.11 7.7-8.846h-4.376l-.621 2.17-2.888-.313.498-4.907h12.294l.313 2.11-7.767 8.852h4.533l.654-2.172 3.167.308-.872 4.908Zm7.99 0h-4.191v-5.03h4.19v5.03Zm0-8.976h-4.191v-5.03h4.19v5.03Zm2.618 8.976 6.054-21.358h3.945l-6.054 21.358h-3.945Zm8.136 0 6.048-21.358h3.945l-6.054 21.358h-3.939Zm21.486.307c-1.863 0-2.887-1.085-3.072-2.792-.805 1.427-2.232 2.792-4.498 2.792-2.02 0-4.314-1.085-4.314-4.006 0-3.447 3.323-4.253 6.518-4.253.778 0 1.584.034 2.3.124v-.465c0-1.427-.034-3.133-2.3-3.133-.84 0-1.488.061-2.143.402l-.453 1.578-3.195-.34.549-3.224c2.45-.996 3.692-1.27 5.992-1.27 3.01 0 5.556 1.55 5.556 4.75v6.083c0 .805.314 1.085.963 1.085.184 0 .375-.034.587-.095l.034 2.11a5.432 5.432 0 0 1-2.524.654Z" fill="currentColor"></path></svg></a><ul class="footer-moz-list"><li class="footer-moz-item"><a href="https://www.mozilla.org/privacy/websites/" class="footer-moz-link" target="_blank" rel="noopener noreferrer">Website Privacy Notice</a></li><li class="footer-moz-item"><a href="https://www.mozilla.org/privacy/websites/#cookies" class="footer-moz-link" target="_blank" rel="noopener noreferrer">Cookies</a></li><li class="footer-moz-item"><a href="https://www.mozilla.org/about/legal/terms/mozilla" class="footer-moz-link" target="_blank" rel="noopener noreferrer">Legal</a></li><li class="footer-moz-item"><a href="https://www.mozilla.org/about/governance/policies/participation/" class="footer-moz-link" target="_blank" rel="noopener noreferrer">Community Participation Guidelines</a></li></ul></div><div class="page-footer-legal"><p id="license" class="page-footer-legal-text">Visit<!-- --> <a href="https://www.mozilla.org" target="_blank" rel="noopener noreferrer">Mozilla Corporation’s</a> <!-- -->not-for-profit parent, the<!-- --> <a target="_blank" rel="noopener noreferrer" href="https://foundation.mozilla.org/">Mozilla Foundation</a>.<br/>Portions of this content are ©1998–<!-- -->2023<!-- --> by individual mozilla.org contributors. Content available under<!-- --> <a href="/en-US/docs/MDN/Writing_guidelines/Attrib_copyright_license">a Creative Commons license</a>.</p></div></div></footer></div><script type="application/json" id="hydration">{"doc":{"isMarkdown":true,"isTranslated":false,"isActive":true,"flaws":{"macros":[{"id":"macro0","fixable":false,"suggestion":null,"explanation":"/en-US/docs/Web/API/FencedFrameConfig does not exist","name":"MacroBrokenLinkError","error":{},"errorStack":"Error: /en-US/docs/Web/API/FencedFrameConfig does not exist\n    at Object.recordNonFatalError (file:///Users/jason/Code/yari/kumascript/src/render.ts:88:13)\n    at Object.smartLink (file:///Users/jason/Code/yari/kumascript/src/api/web.ts:121:29)\n    at eval (\"/Users/jason/Code/yari/kumascript/macros/DOMxRef.ejs\":60:18)\n    at DOMxRef (/Users/jason/Code/yari/node_modules/ejs/lib/ejs.js:703:17)\n    at /Users/jason/Code/yari/node_modules/ejs/lib/ejs.js:260:40\n    at new Promise (<anonymous>)\n    at tryHandleCache (/Users/jason/Code/yari/node_modules/ejs/lib/ejs.js:258:14)\n    at exports.renderFile (/Users/jason/Code/yari/node_modules/ejs/lib/ejs.js:491:10)\n    at Templates.render (file:///Users/jason/Code/yari/kumascript/src/templates.ts:55:40)\n    at render (file:///Users/jason/Code/yari/kumascript/src/render.ts:181:56)","offset":9,"line":127,"column":131,"macroName":"domxref","sourceContext":"  | );\n  | </pre>\n> | <p>Because the options object contains <code>resolveToConfig: true</code>, the returned {{jsxref(\"Promise\")}} will resolve with a {{domxref(\"FencedFrameConfig\")}} object. This object can be set as the value of the {{domxref(\"HTMLFencedFrameElement.config\")}} property, resulting in the content of the chosen URL being displayed in the corresponding {{htmlelement(\"fencedframe\")}} element:</p>\n                                                                                                                                      ^\n  | <pre class=\"brush: js\">document.getElementById(\"content-slot\").config = fencedFrameConfig;\n  | </pre>","fatal":false,"filepath":"/Users/jason/Code/content/files/en-us/web/api/shared_storage_api/index.md","macroSource":"{{domxref(\"FencedFrameConfig\")}}"},{"id":"macro1","fixable":false,"suggestion":null,"explanation":"/en-US/docs/Web/API/HTMLFencedFrameElement/config does not exist","name":"MacroBrokenLinkError","error":{},"errorStack":"Error: /en-US/docs/Web/API/HTMLFencedFrameElement/config does not exist\n    at Object.recordNonFatalError (file:///Users/jason/Code/yari/kumascript/src/render.ts:88:13)\n    at Object.smartLink (file:///Users/jason/Code/yari/kumascript/src/api/web.ts:121:29)\n    at eval (\"/Users/jason/Code/yari/kumascript/macros/DOMxRef.ejs\":60:18)\n    at DOMxRef (/Users/jason/Code/yari/node_modules/ejs/lib/ejs.js:703:17)\n    at /Users/jason/Code/yari/node_modules/ejs/lib/ejs.js:260:40\n    at new Promise (<anonymous>)\n    at tryHandleCache (/Users/jason/Code/yari/node_modules/ejs/lib/ejs.js:258:14)\n    at exports.renderFile (/Users/jason/Code/yari/node_modules/ejs/lib/ejs.js:491:10)\n    at Templates.render (file:///Users/jason/Code/yari/kumascript/src/templates.ts:55:40)\n    at render (file:///Users/jason/Code/yari/kumascript/src/render.ts:181:56)","offset":9,"line":127,"column":215,"macroName":"domxref","sourceContext":"  | );\n  | </pre>\n> | <p>Because the options object contains <code>resolveToConfig: true</code>, the returned {{jsxref(\"Promise\")}} will resolve with a {{domxref(\"FencedFrameConfig\")}} object. This object can be set as the value of the {{domxref(\"HTMLFencedFrameElement.config\")}} property, resulting in the content of the chosen URL being displayed in the corresponding {{htmlelement(\"fencedframe\")}} element:</p>\n                                                                                                                                                                                                                          ^\n  | <pre class=\"brush: js\">document.getElementById(\"content-slot\").config = fencedFrameConfig;\n  | </pre>","fatal":false,"filepath":"/Users/jason/Code/content/files/en-us/web/api/shared_storage_api/index.md","macroSource":"{{domxref(\"HTMLFencedFrameElement.config\")}}"},{"id":"macro2","fixable":false,"suggestion":null,"explanation":"/en-US/docs/Web/HTML/Element/fencedframe does not exist","name":"MacroBrokenLinkError","error":{},"errorStack":"Error: /en-US/docs/Web/HTML/Element/fencedframe does not exist\n    at Object.recordNonFatalError (file:///Users/jason/Code/yari/kumascript/src/render.ts:88:13)\n    at Object.smartLink (file:///Users/jason/Code/yari/kumascript/src/api/web.ts:121:29)\n    at eval (\"/Users/jason/Code/yari/kumascript/macros/HTMLElement.ejs\":55:18)\n    at HTMLElement (/Users/jason/Code/yari/node_modules/ejs/lib/ejs.js:703:17)\n    at /Users/jason/Code/yari/node_modules/ejs/lib/ejs.js:260:40\n    at new Promise (<anonymous>)\n    at tryHandleCache (/Users/jason/Code/yari/node_modules/ejs/lib/ejs.js:258:14)\n    at exports.renderFile (/Users/jason/Code/yari/node_modules/ejs/lib/ejs.js:491:10)\n    at Templates.render (file:///Users/jason/Code/yari/kumascript/src/templates.ts:55:40)\n    at render (file:///Users/jason/Code/yari/kumascript/src/render.ts:181:56)","offset":9,"line":127,"column":350,"macroName":"htmlelement","sourceContext":"  | );\n  | </pre>\n> | <p>Because the options object contains <code>resolveToConfig: true</code>, the returned {{jsxref(\"Promise\")}} will resolve with a {{domxref(\"FencedFrameConfig\")}} object. This object can be set as the value of the {{domxref(\"HTMLFencedFrameElement.config\")}} property, resulting in the content of the chosen URL being displayed in the corresponding {{htmlelement(\"fencedframe\")}} element:</p>\n                                                                                                                                                                                                                                                                                                                                                                 ^\n  | <pre class=\"brush: js\">document.getElementById(\"content-slot\").config = fencedFrameConfig;\n  | </pre>","fatal":false,"filepath":"/Users/jason/Code/content/files/en-us/web/api/shared_storage_api/index.md","macroSource":"{{htmlelement(\"fencedframe\")}}"}],"broken_links":[{"explanation":"Can't resolve /en-US/docs/Web/API/Fenced_Frame_API","id":"link1","href":"/en-US/docs/Web/API/Fenced_Frame_API","suggestion":null,"fixable":false,"line":24,"column":283},{"explanation":"Can't resolve /en-US/docs/Web/API/Fenced_Frame_API","id":"link2","href":"/en-US/docs/Web/API/Fenced_Frame_API","suggestion":null,"fixable":false,"line":52,"column":504},{"explanation":"Can't resolve /en-US/docs/Web/Privacy/Privacy_sandbox/Enrollment","id":"link3","href":"/en-US/docs/Web/Privacy/Privacy_sandbox/Enrollment","suggestion":null,"fixable":false,"line":246,"column":73}]},"title":"Shared Storage API","mdn_url":"/en-US/docs/Web/API/Shared_Storage_API","locale":"en-US","native":"English (US)","browserCompat":["api.SharedStorage"],"sidebarHTML":"<ol><li><strong><em><a href=\"/en-US/docs/Web/API/Shared_Storage_API\" aria-current=\"page\">Shared Storage API</a></em></strong></li><li class=\"toggle\"><details open=\"\"><summary>Interfaces</summary><ol><li><a href=\"/en-US/docs/Web/API/SharedStorage\"><code>SharedStorage</code></a></li><li><a href=\"/en-US/docs/Web/API/SharedStorageOperation\"><code>SharedStorageOperation</code></a></li><li><a href=\"/en-US/docs/Web/API/SharedStorageRunOperation\"><code>SharedStorageRunOperation</code></a></li><li><a href=\"/en-US/docs/Web/API/SharedStorageSelectURLOperation\"><code>SharedStorageSelectURLOperation</code></a></li><li><a href=\"/en-US/docs/Web/API/SharedStorageWorklet\"><code>SharedStorageWorklet</code></a></li><li><a href=\"/en-US/docs/Web/API/SharedStorageWorkletGlobalScope\"><code>SharedStorageWorkletGlobalScope</code></a></li><li><a href=\"/en-US/docs/Web/API/WindowSharedStorage\"><code>WindowSharedStorage</code></a></li><li><a href=\"/en-US/docs/Web/API/WorkletSharedStorage\"><code>WorkletSharedStorage</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Properties</summary><ol><li><a href=\"/en-US/docs/Web/API/Window/sharedStorage\"><code>Window.sharedStorage</code></a></li></ol></details></li></ol>","sidebarMacro":"DefaultAPISidebar","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<div class=\"notecard experimental\" id=\"sect1\"><p><strong>Experimental:</strong> <strong>This is an <a href=\"/en-US/docs/MDN/Writing_guidelines/Experimental_deprecated_obsolete#experimental\">experimental technology</a></strong><br>Check the <a href=\"#browser_compatibility\">Browser compatibility table</a> carefully before using this in production.</p></div>\n<p>The <strong>Shared Storage API</strong> is a client-side storage mechanism that enables unpartitioned, cross-site data access while preserving privacy (i.e. without relying on tracking cookies).</p>"}},{"type":"prose","value":{"id":"concepts_and_usage","title":"Concepts and usage","isH3":false,"content":"<p>One major source of <a href=\"/en-US/docs/Web/Privacy\">privacy</a> and <a href=\"/en-US/docs/Web/Security\">security</a> problems on the web is the use of cookies set on third-party content embedded in sites (for example via <a href=\"/en-US/docs/Web/HTML/Element/iframe\"><code>&lt;iframe&gt;</code></a> elements). These cookies can be used to track and profile users, and share information across sites.</p>\n<p>To prevent cross-site tracking, browsers are working towards partitioning all storage types, including <a href=\"/en-US/docs/Web/HTTP/Cookies\">Cookies</a>, <a href=\"/en-US/docs/Web/API/Web_Storage_API\">Web Storage</a>, <a href=\"/en-US/docs/Web/API/IndexedDB_API\">IndexedDB</a>, and the <a href=\"/en-US/docs/Web/API/Cache\">Cache API</a>. However, a major barrier to achieving this is the need for several legitimate use cases that rely on cross-site information sharing. Examples of such uses cases include advertisers wanting to measure the reach of their across sites and generate reports, and site owners wanting to customize user experiences based on the group they are in or their previous site interactions.</p>\n<p>The Shared Storage API provides a flexible solution for such use cases. It aims to provide the required data storage, processing, and sharing capabilities without the ability to track and profile users.</p>\n<p>Like other storage APIs, you can write to shared storage at any time. However, you can only read shared storage data from inside a <a href=\"/en-US/docs/Web/API/SharedStorageWorklet\" title=\"worklet\">worklet</a>. Worklets provide a secure environment inside which you can process shared storage data and return useful results, but you can't directly share the data with the associated browsing context.</p>\n<p>To extract useful results from a shared storage worklet, you need to use an <strong>output gate</strong>. These gates serve specific purposes such as selecting a URL from a provided list to display to the user based on shared storage data. Results meant for the user are shown securely inside a <a href=\"/en-US/docs/Web/API/Fenced_Frame_API\" class=\"page-not-created\" title=\"This is a link to an unwritten page\" data-flaw=\"link1\">fenced frame</a> where they can't be accessed from the embedding page.</p>"}},{"type":"prose","value":{"id":"output_gates","title":"Output gates","isH3":false,"content":"<p>The currently available output gates for the Shared Storage API are discussed in the sections below. In each section, we list typical use cases for each gate and provide links to guides with more information and code examples.</p>\n<div class=\"notecard note\" id=\"sect2\">\n  <p><strong>Note:</strong> More output gates will likely be added in the future to support additional use cases.</p>\n</div>"}},{"type":"prose","value":{"id":"url_selection","title":"URL Selection","isH3":true,"content":"<p>The <strong>URL Selection</strong> output gate, accessed via the <a href=\"/en-US/docs/Web/API/WindowSharedStorage/selectURL\" title=\"selectURL()\"><code>selectURL()</code></a> method, is used to select a URL from a provided list to display to the user, based on shared storage data. This gate be used for the following purposes:</p>\n<ul>\n  <li><a href=\"https://developer.chrome.com/docs/privacy-sandbox/shared-storage/creative-rotation/\" class=\"external\" target=\"_blank\"><strong>Creative rotation</strong></a>: Use stored data such as creative IDs, view counts, and user interaction to determine which creative content users see across different sites. This approach helps in balancing views and prevents overexposure of certain content, which in turn can help avoid a negative user experience.</li>\n  <li><a href=\"https://developer.chrome.com/docs/privacy-sandbox/shared-storage/ab-testing/\" class=\"external\" target=\"_blank\"><strong>A/B testing</strong></a>: Assign a user to an experiment group, then store group details in shared storage for cross-site access.</li>\n  <li><a href=\"https://developer.chrome.com/docs/privacy-sandbox/shared-storage/known-customer/\" class=\"external\" target=\"_blank\"><strong>Custom user experiences</strong></a>: Share custom content and calls-to-action based on a user's registration status or other user states.</li>\n</ul>"}},{"type":"prose","value":{"id":"run","title":"Run","isH3":true,"content":"<p>The <strong>Run</strong> output gate, accessed via the <a href=\"/en-US/docs/Web/API/WindowSharedStorage/run\" title=\"run()\"><code>run()</code></a> method, is intended to be used in a generic way to process some shared storage data.</p>\n<p>The <a href=\"https://developer.chrome.com/docs/privacy-sandbox/private-aggregation/\" class=\"external\" target=\"_blank\">Private Aggregation API</a> can use the Run output gate to process shared storage data and generate aggregated reports. These reports can be used in the following use cases:</p>\n<ul>\n  <li><a href=\"https://developer.chrome.com/docs/privacy-sandbox/shared-storage/unique-reach/\" class=\"external\" target=\"_blank\"><strong>Unique reach reporting</strong></a>: Content producers and advertisers often want to know the number of unique viewers for their content. You can use shared storage to report the first time a user sees your ad or embedded publication and prevent duplicate counting for the same user on a different site, giving you an aggregated noisy report of approximate unique reach.</li>\n  <li><a href=\"https://developer.chrome.com/docs/privacy-sandbox/shared-storage/user-demographics/\" class=\"external\" target=\"_blank\"><strong>User demographic reporting</strong></a>: Content producers often want to understand the demographics of their audience. You can use shared storage to record user demographic data on your main site, and use aggregated reporting to report on it across other sites in embedded contexts.</li>\n  <li><a href=\"https://developer.chrome.com/docs/privacy-sandbox/shared-storage/k-freq-reach/\" class=\"external\" target=\"_blank\"><strong>K+ frequency measurement</strong></a>: Sometimes described as \"effective frequency\", K+ frequency refers to the minimum number of views needed before a user will recognize or recall certain content (often used in the context of ad views). You can use shared storage to build reports of unique users who have seen a piece of content at least K times.</li>\n</ul>"}},{"type":"prose","value":{"id":"understanding_how_shared_storage_works","title":"Understanding how shared storage works","isH3":false,"content":"<p>There are two parts to using the Shared Storage API — writing data to storage and reading/processing it. To give you an idea of how these parts are handled, we'll walk you through the basic <a href=\"https://developer.chrome.com/docs/privacy-sandbox/shared-storage/ab-testing/\" class=\"external\" target=\"_blank\">A/B testing</a> example from developer.chrome.com. In this example, a user is assigned to an experiment group, and the group details are stored in shared storage. Other sites are able to use this data when choosing a URL to display in a <a href=\"/en-US/docs/Web/API/Fenced_Frame_API\" class=\"page-not-created\" title=\"This is a link to an unwritten page\" data-flaw=\"link2\">fenced frame</a>.</p>"}},{"type":"prose","value":{"id":"writing_to_shared_storage","title":"Writing to shared storage","isH3":true,"content":"<p>Writing data to shared storage is simple — you use methods defined on the <a href=\"/en-US/docs/Web/API/SharedStorage\"><code>SharedStorage</code></a> interface to <a href=\"/en-US/docs/Web/API/SharedStorage/set\" title=\"set\">set</a>, <a href=\"/en-US/docs/Web/API/SharedStorage/append\" title=\"append\">append</a>, or <a href=\"/en-US/docs/Web/API/SharedStorage/delete\" title=\"delete\">delete</a>/<a href=\"/en-US/docs/Web/API/SharedStorage/clear\" title=\"clear\">clear</a> data.</p>\n<p>This functionality is available in two different contexts:</p>\n<ul>\n  <li>In the main browsing context, where your site or app runs, on <a href=\"/en-US/docs/Web/API/WindowSharedStorage\"><code>WindowSharedStorage</code></a>. This is available via <code>window.sharedStorage</code>.</li>\n  <li>In the context of your shared storage worklet, on <a href=\"/en-US/docs/Web/API/WorkletSharedStorage\"><code>WorkletSharedStorage</code></a>. This is is available via <code>this.sharedStorage</code>.</li>\n</ul>\n<p>In our A/B testing example, we define a function in our app context that generates a random number — 0 or 1 — to represent an experiment group. We then run the <a href=\"/en-US/docs/Web/API/SharedStorage/set\" title=\"window.sharedStorage.set()\"><code>window.sharedStorage.set()</code></a> function to assign the user to a group and save the result in shared storage:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// Randomly assigns a user to a group 0 or 1</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">getExperimentGroup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">round</span><span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">injectContent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Assign user to a random group (0 or 1) and store it in shared storage</span>\n  window<span class=\"token punctuation\">.</span>sharedStorage<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ab-testing-group\"</span><span class=\"token punctuation\">,</span> <span class=\"token function\">getExperimentGroup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">ignoreIfPresent</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<div class=\"notecard note\" id=\"sect3\">\n  <p><strong>Note:</strong> The <code>ignoreIfPresent: true</code> option causes the <code>set()</code> function to abort if the shared storage already contains a data item with the specified key.</p>\n</div>"}},{"type":"prose","value":{"id":"reading_and_processing_data_from_shared_storage","title":"Reading and processing data from shared storage","isH3":true,"content":"<p>As mentioned above, to extract useful results from a shared storage worklet, you need to use an <strong>output gate</strong>. In this example, we'll use the <a href=\"#url_selection\">URL Selection output gate</a> to read the user's experiment group and then display a URL in a fenced frame based on their group.</p>\n<p>To use the output gate, you need to:</p>\n<ol>\n  <li>Define an operation in a worklet module script to handle choosing the URL, and register it.</li>\n  <li>Add the module to your shared storage worklet.</li>\n  <li>Choose the URL using the worklet operation and load it in a fenced frame.</li>\n</ol>\n<p>Below we'll look at these steps one by one.</p>\n<h4 id=\"define_an_operation_in_a_worklet_module\">Define an operation in a worklet module</h4>\n<p>The URL selection is based on the experiment group stored in shared storage. To retrieve this value and choose a URL based on it, we need to define an operation in a <a href=\"/en-US/docs/Web/API/SharedStorageWorklet\"><code>SharedStorageWorklet</code></a> context. This ensures the raw data is hidden from other contexts, thereby preserving privacy.</p>\n<p>The URL Selection operation is a JavaScript class that must follow the rules below (these rules vary for each output gate, depending on their intended use case):</p>\n<ul>\n  <li>The actual functionality must be contained in an asynchronous <code>run()</code> method, which takes an array of objects containing URLs as its first parameter and a data object as its second parameter (when called, the data argument is optional).</li>\n  <li>The <code>run()</code> method must return a number, which will equate to the number of the URL chosen.</li>\n</ul>\n<div class=\"notecard note\" id=\"sect4\">\n  <p><strong>Note:</strong> Each output gate has a corresponding interface that defines the required structure of its class and <code>run()</code> method. For URL Selection, see <a href=\"/en-US/docs/Web/API/SharedStorageSelectURLOperation\"><code>SharedStorageSelectURLOperation</code></a>.</p>\n</div>\n<p>Once the operation is defined, it needs to be registered using <a href=\"/en-US/docs/Web/API/SharedStorageWorkletGlobalScope/register\"><code>SharedStorageWorkletGlobalScope.register()</code></a>.</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// ab-testing-worklet.js</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">SelectURLOperation</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">async</span> <span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">urls<span class=\"token punctuation\">,</span> data</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Read the user's experiment group from shared storage</span>\n    <span class=\"token keyword\">const</span> experimentGroup <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>sharedStorage<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ab-testing-group\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Return the group number</span>\n    <span class=\"token keyword\">return</span> experimentGroup<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">register</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ab-testing\"</span><span class=\"token punctuation\">,</span> SelectURLOperation<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Notice how the value set in our main app context is retrieved using <a href=\"/en-US/docs/Web/API/WorkletSharedStorage/get\"><code>WorkletSharedStorage.get()</code></a>. To reiterate, to preserve privacy and mitigate data leakage, you can read values from shared storage only within a worklet.</p>\n<div class=\"notecard note\" id=\"sect5\">\n  <p><strong>Note:</strong> It is possible to define and register multiple operations in the same shared storage worklet module script with different names; see <a href=\"/en-US/docs/Web/API/SharedStorageOperation\"><code>SharedStorageOperation</code></a> for an example.</p>\n</div>\n<h4 id=\"add_the_module_to_the_shared_storage_worklet\">Add the module to the shared storage worklet</h4>\n<p>To use the operation defined in the worklet module, it needs to be added to the shared storage worklet using <a href=\"/en-US/docs/Web/API/Worklet/addModule\" title=\"window.sharedStorage.worklet.addModule()\"><code>window.sharedStorage.worklet.addModule()</code></a>. In our main app context, this is done before we set the experiment group value, so that it is ready to use when needed:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">injectContent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Add the module to the shared storage worklet</span>\n  <span class=\"token keyword\">await</span> window<span class=\"token punctuation\">.</span>sharedStorage<span class=\"token punctuation\">.</span>worklet<span class=\"token punctuation\">.</span><span class=\"token function\">addModule</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ab-testing-worklet.js\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Assign user to a random group (0 or 1) and store it in shared storage</span>\n  window<span class=\"token punctuation\">.</span>sharedStorage<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ab-testing-group\"</span><span class=\"token punctuation\">,</span> <span class=\"token function\">getExperimentGroup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">ignoreIfPresent</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<h4 id=\"choose_a_url_and_load_it_in_a_fenced_frame\">Choose a URL and load it in a fenced frame</h4>\n<p>To run the operation defined in the worklet, we call <a href=\"/en-US/docs/Web/API/WindowSharedStorage/selectURL\"><code>WindowSharedStorage.selectURL()</code></a>. This method acts as a proxy to our worklet operation, accessing it securely and returning the result without leaking any data. <code>selectURL()</code> is the correct method to call our user-defined worklet operation because it was defined with the appropriate class structure for a URL Selection operation, as discussed above.</p>\n<p><code>selectURL()</code> expects an array of objects containing URLs to choose from, an optional options object, and for the underlying operation to return an integer that it can use to choose a URL.</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// Run the URL selection operation</span>\n<span class=\"token keyword\">const</span> fencedFrameConfig <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> window<span class=\"token punctuation\">.</span>sharedStorage<span class=\"token punctuation\">.</span><span class=\"token function\">selectURL</span><span class=\"token punctuation\">(</span>\n  <span class=\"token string\">\"ab-testing\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">url</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">https://your-server.example/content/default-content.html</span><span class=\"token template-punctuation string\">`</span></span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">url</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">https://your-server.example/content/experiment-content-a.html</span><span class=\"token template-punctuation string\">`</span></span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">resolveToConfig</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Because the options object contains <code>resolveToConfig: true</code>, the returned <a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise\"><code>Promise</code></a> will resolve with a <a class=\"page-not-created\" title=\"The documentation about this has not yet been written; please consider contributing!\" data-flaw-src=\"{{domxref(&quot;FencedFrameConfig&quot;)}}\"><code>FencedFrameConfig</code></a> object. This object can be set as the value of the <a class=\"page-not-created\" title=\"The documentation about this has not yet been written; please consider contributing!\" data-flaw-src=\"{{domxref(&quot;HTMLFencedFrameElement.config&quot;)}}\"><code>HTMLFencedFrameElement.config</code></a> property, resulting in the content of the chosen URL being displayed in the corresponding <a class=\"page-not-created\" title=\"The documentation about this has not yet been written; please consider contributing!\" data-flaw-src=\"{{htmlelement(&quot;fencedframe&quot;)}}\"><code>&lt;fencedframe&gt;</code></a> element:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code>document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"content-slot\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>config <span class=\"token operator\">=</span> fencedFrameConfig<span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>The full app script looks like so:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// Randomly assigns a user to a group 0 or 1</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">getExperimentGroup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">round</span><span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">injectContent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Add the module to the shared storage worklet</span>\n  <span class=\"token keyword\">await</span> window<span class=\"token punctuation\">.</span>sharedStorage<span class=\"token punctuation\">.</span>worklet<span class=\"token punctuation\">.</span><span class=\"token function\">addModule</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ab-testing-worklet.js\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Assign user to a random group (0 or 1) and store it in shared storage</span>\n  window<span class=\"token punctuation\">.</span>sharedStorage<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ab-testing-group\"</span><span class=\"token punctuation\">,</span> <span class=\"token function\">getExperimentGroup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">ignoreIfPresent</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Run the URL selection operation</span>\n  <span class=\"token keyword\">const</span> fencedFrameConfig <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> window<span class=\"token punctuation\">.</span>sharedStorage<span class=\"token punctuation\">.</span><span class=\"token function\">selectURL</span><span class=\"token punctuation\">(</span>\n    <span class=\"token string\">\"ab-testing\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span>\n      <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">url</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">https://your-server.example/content/default-content.html</span><span class=\"token template-punctuation string\">`</span></span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">url</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">https://your-server.example/content/experiment-content-a.html</span><span class=\"token template-punctuation string\">`</span></span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">resolveToConfig</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Render the chosen URL into a fenced frame</span>\n  document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"content-slot\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>config <span class=\"token operator\">=</span> fencedFrameConfig<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">injectContent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"differences_between_shared_storage_and_web_storage","title":"Differences between shared storage and web storage","isH3":false,"content":"<p>The key difference is that shared storage is intended for use with cross-origin data after storage has been partitioned.</p>\n<ul>\n  <li>If you are a publisher and you want to store first-party data that is accessible to only you, use the <a href=\"/en-US/docs/Web/API/Window/localStorage\"><code>localStorage</code></a> version of <a href=\"/en-US/docs/Web/API/Web_Storage_API\">web storage</a>.</li>\n  <li>If you want data to persist only during a browser session, use <a href=\"/en-US/docs/Web/API/Window/sessionStorage\"><code>sessionStorage</code></a>.</li>\n  <li>If you are operating as a third-party on another site, and you want to record data from that site to access later on another site, use shared storage.</li>\n</ul>\n<p>Another important difference between shared storage and web storage is that reading from shared storage is guarded (writing to storage behaves similarly). With <code>localStorage</code> and <code>sessionStorage</code>, you can read freely. With shared storage, reading can happen only within a shared storage worklet, and the origin used for reading in the worklet is the same as the browsing context that created it.</p>\n<p>Additionally, you cannot extract shared storage data outside of a shared storage worklet, as a tracking protection. You must use one of the output gates to work with your data in shared storage.</p>\n<p>Lastly, data in <code>localStorage</code> persists until it is manually cleared. <code>sessionStorage</code> clears at the end of a browsing session, whereas shared storage data clears 30 days after the last write call.</p>"}},{"type":"prose","value":{"id":"interfaces","title":"Interfaces","isH3":false,"content":"<dl>\n  <dt id=\"sharedstorage\"><a href=\"/en-US/docs/Web/API/SharedStorage\"><code>SharedStorage</code></a></dt>\n  <dd>\n    <p>Represents the shared storage for a particular origin. It defines methods to write data to the shared storage.</p>\n  </dd>\n  <dt id=\"windowsharedstorage\"><a href=\"/en-US/docs/Web/API/WindowSharedStorage\"><code>WindowSharedStorage</code></a></dt>\n  <dd>\n    <p>Represents the shared storage for a particular origin as exposed to a standard browsing context. Among other things, it defines methods to use the available output gates, which act as proxies for the operations defined in the worklet.</p>\n  </dd>\n  <dt id=\"workletsharedstorage\"><a href=\"/en-US/docs/Web/API/WorkletSharedStorage\"><code>WorkletSharedStorage</code></a></dt>\n  <dd>\n    <p>Represents the shared storage for a particular origin within a worklet context. Among other things, it defines methods to read the shared storage data.</p>\n  </dd>\n  <dt id=\"sharedstorageworklet\"><a href=\"/en-US/docs/Web/API/SharedStorageWorklet\"><code>SharedStorageWorklet</code></a></dt>\n  <dd>\n    <p>Represents the current origin's shared storage worklet. It contains the <a href=\"/en-US/docs/Web/API/Worklet/addModule\" title=\"addModule()\"><code>addModule()</code></a> method for adding modules. Unlike a regular <a href=\"/en-US/docs/Web/API/Worklet\"><code>Worklet</code></a>, the <code>SharedStorageWorklet</code> can have only a single module added to it, for privacy reasons.</p>\n  </dd>\n  <dt id=\"sharedstorageworkletglobalscope\"><a href=\"/en-US/docs/Web/API/SharedStorageWorkletGlobalScope\"><code>SharedStorageWorkletGlobalScope</code></a></dt>\n  <dd>\n    <p>Represents the global scope of a <a href=\"/en-US/docs/Web/API/SharedStorageWorklet\"><code>SharedStorageWorklet</code></a> module. It contains the functionality to <a href=\"/en-US/docs/Web/API/SharedStorageWorkletGlobalScope/register\" title=\"register\">register</a> a defined operation and <a href=\"/en-US/docs/Web/API/SharedStorageWorkletGlobalScope/sharedStorage\" title=\"access the shared storage\">access the shared storage</a>.</p>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"output_gate_operation_signature_definitions","title":"Output gate operation signature definitions","isH3":true,"content":"<dl>\n  <dt id=\"sharedstorageoperation\"><a href=\"/en-US/docs/Web/API/SharedStorageOperation\"><code>SharedStorageOperation</code></a></dt>\n  <dd>\n    <p>Represents the base class for all different output gate operation types.</p>\n  </dd>\n  <dt id=\"sharedstoragerunoperation\"><a href=\"/en-US/docs/Web/API/SharedStorageRunOperation\"><code>SharedStorageRunOperation</code></a></dt>\n  <dd>\n    <p>Represents a Run output gate operation.</p>\n  </dd>\n  <dt id=\"sharedstorageselecturloperation\"><a href=\"/en-US/docs/Web/API/SharedStorageSelectURLOperation\"><code>SharedStorageSelectURLOperation</code></a></dt>\n  <dd>\n    <p>Represents a URL Selection output gate operation.</p>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"extensions_to_other_interfaces","title":"Extensions to other interfaces","isH3":true,"content":"<dl>\n  <dt id=\"window.sharedstorage\"><a href=\"/en-US/docs/Web/API/Window/sharedStorage\"><code>Window.sharedStorage</code></a></dt>\n  <dd>\n    <p>Returns the <a href=\"/en-US/docs/Web/API/WindowSharedStorage\"><code>WindowSharedStorage</code></a> object for the current origin.</p>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"enrollment_and_local_testing","title":"Enrollment and local testing","isH3":false,"content":"<p>To use the Shared Storage API in your sites, you must specify it in the <a href=\"/en-US/docs/Web/Privacy/Privacy_sandbox/Enrollment\" class=\"page-not-created\" title=\"This is a link to an unwritten page\" data-flaw=\"link3\">privacy sandbox enrollment process</a>. If you don't, the Shared Storage API methods won't run successfully.</p>\n<p>You can test your Shared Storage API code locally without enrollment. To allow local testing, enable the following Chrome developer flag:</p>\n<p><code>chrome://flags/#privacy-sandbox-enrollment-overrides</code></p>"}},{"type":"prose","value":{"id":"examples","title":"Examples","isH3":false,"content":"<p>For extensive demos, see the <a href=\"https://shared-storage-demo.web.app/\" class=\"external\" target=\"_blank\">Shared Storage API demo site</a>, which also includes some Private Aggregation API examples.</p>"}},{"type":"specifications","value":{"title":"Specifications","id":"specifications","isH3":false,"specifications":[{"bcdSpecificationURL":"https://wicg.github.io/shared-storage/#sharedstorage","title":"Shared Storage API"}],"query":"api.SharedStorage"}},{"type":"browser_compatibility","value":{"title":"Browser compatibility","id":"browser_compatibility","isH3":false,"query":"api.SharedStorage"}},{"type":"prose","value":{"id":"see_also","title":"See also","isH3":false,"content":"<ul>\n  <li><a href=\"https://developer.chrome.com/docs/privacy-sandbox/shared-storage/\" class=\"external\" target=\"_blank\">Shared Storage</a> on developer.chrome.com</li>\n  <li><a href=\"https://developer.chrome.com/docs/privacy-sandbox/\" class=\"external\" target=\"_blank\">The Privacy Sandbox</a> on developer.chrome.com</li>\n</ul>"}}],"toc":[{"text":"Concepts and usage","id":"concepts_and_usage"},{"text":"Output gates","id":"output_gates"},{"text":"Understanding how shared storage works","id":"understanding_how_shared_storage_works"},{"text":"Differences between shared storage and web storage","id":"differences_between_shared_storage_and_web_storage"},{"text":"Interfaces","id":"interfaces"},{"text":"Enrollment and local testing","id":"enrollment_and_local_testing"},{"text":"Examples","id":"examples"},{"text":"Specifications","id":"specifications"},{"text":"Browser compatibility","id":"browser_compatibility"},{"text":"See also","id":"see_also"}],"summary":"The Shared Storage API is a client-side storage mechanism that enables unpartitioned, cross-site data access while preserving privacy (i.e. without relying on tracking cookies).","popularity":0,"modified":"2023-12-06T16:02:13.000Z","source":{"folder":"en-us/web/api/shared_storage_api","github_url":"https://github.com/mdn/content/blob/main/files/en-us/web/api/shared_storage_api/index.md","last_commit_url":"https://github.com/mdn/content/commit/87f5aacd076db585bf04699b8bc584bcc7b6b467","filename":"index.md"},"short_title":"Shared Storage API","parents":[{"uri":"/en-US/docs/Web","title":"References"},{"uri":"/en-US/docs/Web/API","title":"Web APIs"},{"uri":"/en-US/docs/Web/API/Shared_Storage_API","title":"Shared Storage API"}],"pageTitle":"Shared Storage API - Web APIs | MDN","noIndexing":false}}</script></body></html>