<!doctype html><html lang="en-US" prefix="og: https://ogp.me/ns#"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><link rel="icon" href="/favicon-48x48.cbbd161b.png"/><link rel="apple-touch-icon" href="/apple-touch-icon.6803c6f0.png"/><meta name="theme-color" content="#ffffff"/><link rel="manifest" href="/manifest.56b1cedc.json"/><link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="MDN Web Docs"/><title>Using the Web Animations API - Web APIs | MDN</title><link rel="alternate" type="application/rss+xml" title="MDN Blog RSS Feed" href="https://developer.mozilla.org/en-US/blog/rss.xml" hreflang="en" /><meta name="robots" content="noindex, nofollow"><meta name="description" content="The Web Animations API lets us construct animations and control their playback with JavaScript. This article will start you off in the right direction with fun demos and tutorials featuring Alice in Wonderland."/><meta property="og:url" content="https://developer.mozilla.org/en-US/docs/Web/API/Web_Animations_API/Using_the_Web_Animations_API"/><meta property="og:title" content="Using the Web Animations API - Web APIs | MDN"/><meta property="og:type" content="website"/><meta property="og:locale" content="en_US"/><meta property="og:description" content="The Web Animations API lets us construct animations and control their playback with JavaScript. This article will start you off in the right direction with fun demos and tutorials featuring Alice in Wonderland."/><meta property="og:image" content="https://developer.mozilla.org/mdn-social-share.cd6c4a5a.png"/><meta property="og:image:type" content="image/png"/><meta property="og:image:height" content="1080"/><meta property="og:image:width" content="1920"/><meta property="og:image:alt" content="The MDN Web Docs logo, featuring a blue accent color, displayed on a solid black background."/><meta property="og:site_name" content="MDN Web Docs"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:creator" content="MozDevNet"/><link rel="canonical" href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Animations_API/Using_the_Web_Animations_API"/><style media="print">.article-actions-container,.document-toc-container,.language-menu,.main-menu-toggle,.on-github,.page-footer,.place,.sidebar,.top-banner,.top-navigation-main,ul.prev-next{display:none!important}.main-page-content,.main-page-content pre{padding:2px}.main-page-content pre{border-left-width:2px}</style><script defer="defer" src="/static/js/main.8204838d.js"></script><link href="/static/css/main.3551aa81.css" rel="stylesheet"></head><body><script>if(document.body.addEventListener("load",(t=>{t.target.classList.contains("interactive")&&t.target.setAttribute("data-readystate","complete")}),{capture:!0}),window&&document.documentElement){const t={light:"#ffffff",dark:"#1b1b1b"};try{const e=window.localStorage.getItem("theme");e&&(document.documentElement.className=e,document.documentElement.style.backgroundColor=t[e])}catch(t){console.warn("Unable to read theme from localStorage",t)}}</script><div id="root"><ul id="nav-access" class="a11y-nav"><li><a id="skip-main" href="#content">Skip to main content</a></li><li><a id="skip-search" href="#top-nav-search-input">Skip to search</a></li><li><a id="skip-select-language" href="#languages-switcher-button">Skip to select language</a></li></ul><div class="page-wrapper  category-api document-page"><div class="top-banner loading"><section class="place top container"></section></div><div class="sticky-header-container"><header class="top-navigation 
      
      "><div class="container "><div class="top-navigation-wrap"><a href="/en-US/" class="logo" aria-label="MDN homepage"><svg id="mdn-docs-logo" xmlns="http://www.w3.org/2000/svg" x="0" y="0" viewBox="0 0 694.9 104.4" style="enable-background:new 0 0 694.9 104.4" xml:space="preserve" role="img"><title>MDN Web Docs</title><path d="M40.3 0 11.7 92.1H0L28.5 0h11.8zm10.4 0v92.1H40.3V0h10.4zM91 0 62.5 92.1H50.8L79.3 0H91zm10.4 0v92.1H91V0h10.4z" class="logo-m"></path><path d="M627.9 95.6h67v8.8h-67v-8.8z" class="logo-_"></path><path d="M367 42h-4l-10.7 30.8h-5.5l-10.8-26h-.4l-10.5 26h-5.2L308.7 42h-3.8v-5.6H323V42h-6.5l6.8 20.4h.4l10.3-26h4.7l11.2 26h.5l5.7-20.3h-6.2v-5.6H367V42zm34.9 20c-.4 3.2-2 5.9-4.7 8.2-2.8 2.3-6.5 3.4-11.3 3.4-5.4 0-9.7-1.6-13.1-4.7-3.3-3.2-5-7.7-5-13.7 0-5.7 1.6-10.3 4.7-14s7.4-5.5 12.9-5.5c5.1 0 9.1 1.6 11.9 4.7s4.3 6.9 4.3 11.3c0 1.5-.2 3-.5 4.7h-25.6c.3 7.7 4 11.6 10.9 11.6 2.9 0 5.1-.7 6.5-2 1.5-1.4 2.5-3 3-4.9l6 .9zM394 51.3c.2-2.4-.4-4.7-1.8-6.9s-3.8-3.3-7-3.3c-3.1 0-5.3 1-6.9 3-1.5 2-2.5 4.4-2.8 7.2H394zm51 2.4c0 5-1.3 9.5-4 13.7s-6.9 6.2-12.7 6.2c-6 0-10.3-2.2-12.7-6.7-.1.4-.2 1.4-.4 2.9s-.3 2.5-.4 2.9h-7.3c.3-1.7.6-3.5.8-5.3.3-1.8.4-3.7.4-5.5V22.3h-6v-5.6H416v27c1.1-2.2 2.7-4.1 4.7-5.7 2-1.6 4.8-2.4 8.4-2.4 4.6 0 8.4 1.6 11.4 4.7 3 3.2 4.5 7.6 4.5 13.4zm-7.7.6c0-4.2-1-7.4-3-9.5-2-2.2-4.4-3.3-7.4-3.3-3.4 0-6 1.2-8 3.7-1.9 2.4-2.9 5-3 7.7V57c0 3 1 5.6 3 7.7s4.5 3.1 7.6 3.1c3.6 0 6.3-1.3 8.1-3.9 1.8-2.7 2.7-5.9 2.7-9.6zm69.2 18.5h-13.2v-7.2c-1.2 2.2-2.8 4.1-4.9 5.6-2.1 1.6-4.8 2.4-8.3 2.4-4.8 0-8.7-1.6-11.6-4.9-2.9-3.2-4.3-7.7-4.3-13.3 0-5 1.3-9.6 4-13.7 2.6-4.1 6.9-6.2 12.8-6.2 5.7 0 9.8 2.2 12.3 6.5V22.3h-8.6v-5.6h15.8v50.6h6v5.5zM493.2 56v-4.4c-.1-3-1.2-5.5-3.2-7.3s-4.4-2.8-7.2-2.8c-3.6 0-6.3 1.3-8.2 3.9-1.9 2.6-2.8 5.8-2.8 9.6 0 4.1 1 7.3 3 9.5s4.5 3.3 7.4 3.3c3.2 0 5.8-1.3 7.8-3.8 2.1-2.6 3.1-5.3 3.2-8zm53.1-1.4c0 5.6-1.8 10.2-5.3 13.7s-8.2 5.3-13.9 5.3-10.1-1.7-13.4-5.1c-3.3-3.4-5-7.9-5-13.5 0-5.3 1.6-9.9 4.7-13.7 3.2-3.8 7.9-5.7 14.2-5.7s11 1.9 14.1 5.7c3 3.7 4.6 8.1 4.6 13.3zm-7.7-.2c0-4-1-7.2-3-9.5s-4.8-3.5-8.2-3.5c-3.6 0-6.4 1.2-8.3 3.7s-2.9 5.6-2.9 9.5c0 3.7.9 6.8 2.8 9.4 1.9 2.6 4.6 3.9 8.3 3.9 3.6 0 6.4-1.3 8.4-3.8 1.9-2.6 2.9-5.8 2.9-9.7zm45 5.8c-.4 3.2-1.9 6.3-4.4 9.1-2.5 2.9-6.4 4.3-11.8 4.3-5.2 0-9.4-1.6-12.6-4.8-3.2-3.2-4.8-7.7-4.8-13.7 0-5.5 1.6-10.1 4.7-13.9 3.2-3.8 7.6-5.7 13.2-5.7 2.3 0 4.6.3 6.7.8 2.2.5 4.2 1.5 6.2 2.9l1.5 9.5-5.9.7-1.3-6.1c-2.1-1.2-4.5-1.8-7.2-1.8-3.5 0-6.1 1.2-7.7 3.7-1.7 2.5-2.5 5.7-2.5 9.6 0 4.1.9 7.3 2.7 9.5 1.8 2.3 4.4 3.4 7.8 3.4 5.2 0 8.2-2.9 9.2-8.8l6.2 1.3zm34.7 1.9c0 3.6-1.5 6.5-4.6 8.5s-7 3-11.7 3c-5.7 0-10.6-1.2-14.6-3.6l1.2-8.8 5.7.6-.2 4.7c1.1.5 2.3.9 3.6 1.1s2.6.3 3.9.3c2.4 0 4.5-.4 6.5-1.3 1.9-.9 2.9-2.2 2.9-4.1 0-1.8-.8-3.1-2.3-3.8s-3.5-1.3-5.8-1.7-4.6-.9-6.9-1.4c-2.3-.6-4.2-1.6-5.7-2.9-1.6-1.4-2.3-3.5-2.3-6.3 0-4.1 1.5-6.9 4.6-8.5s6.4-2.4 9.9-2.4c2.6 0 5 .3 7.2.9 2.2.6 4.3 1.4 6.1 2.4l.8 8.8-5.8.7-.8-5.7c-2.3-1-4.7-1.6-7.2-1.6-2.1 0-3.7.4-5.1 1.1-1.3.8-2 2-2 3.8 0 1.7.8 2.9 2.3 3.6 1.5.7 3.4 1.2 5.7 1.6 2.2.4 4.5.8 6.7 1.4 2.2.6 4.1 1.6 5.7 3 1.4 1.6 2.2 3.7 2.2 6.6zM197.6 73.2h-17.1v-5.5h3.8V51.9c0-3.7-.7-6.3-2.1-7.9-1.4-1.6-3.3-2.3-5.7-2.3-3.2 0-5.6 1.1-7.2 3.4s-2.4 4.6-2.5 6.9v15.6h6v5.5h-17.1v-5.5h3.8V51.9c0-3.8-.7-6.4-2.1-7.9-1.4-1.5-3.3-2.3-5.6-2.3-3.2 0-5.5 1.1-7.2 3.3-1.6 2.2-2.4 4.5-2.5 6.9v15.8h6.9v5.5h-20.2v-5.5h6V42.4h-6.1v-5.6h13.4v6.4c1.2-2.1 2.7-3.8 4.7-5.2 2-1.3 4.4-2 7.3-2s5.3.7 7.5 2.1c2.2 1.4 3.7 3.5 4.5 6.4 1.1-2.5 2.7-4.5 4.9-6.1s4.8-2.4 7.9-2.4c3.5 0 6.5 1.1 8.9 3.3s3.7 5.6 3.7 10.2v18.2h6.1v5.5zm42.5 0h-13.2V66c-1.2 2.2-2.8 4.1-4.9 5.6-2.1 1.6-4.8 2.4-8.3 2.4-4.8 0-8.7-1.6-11.6-4.9-2.9-3.2-4.3-7.7-4.3-13.3 0-5 1.3-9.6 4-13.7 2.6-4.1 6.9-6.2 12.8-6.2s9.8 2.2 12.3 6.5V22.7h-8.6v-5.6h15.8v50.6h6v5.5zm-13.3-16.8V52c-.1-3-1.2-5.5-3.2-7.3s-4.4-2.8-7.2-2.8c-3.6 0-6.3 1.3-8.2 3.9-1.9 2.6-2.8 5.8-2.8 9.6 0 4.1 1 7.3 3 9.5s4.5 3.3 7.4 3.3c3.2 0 5.8-1.3 7.8-3.8 2.1-2.6 3.1-5.3 3.2-8zm61.5 16.8H269v-5.5h6V51.9c0-3.7-.7-6.3-2.2-7.9-1.4-1.6-3.4-2.3-5.7-2.3-3.1 0-5.6 1-7.4 3s-2.8 4.4-2.9 7v15.9h6v5.5h-19.3v-5.5h6V42.4h-6.2v-5.6h13.6V43c2.6-4.6 6.8-6.9 12.7-6.9 3.6 0 6.7 1.1 9.2 3.3s3.7 5.6 3.7 10.2v18.2h6v5.4h-.2z" class="logo-text"></path></svg></a><button title="Open main menu" type="button" class="button action has-icon main-menu-toggle" aria-haspopup="menu" aria-label="Open main menu" aria-expanded="false"><span class="button-wrap"><span class="icon icon-menu "></span><span class="visually-hidden">Open main menu</span></span></button></div><div class="top-navigation-main"><nav class="main-nav" aria-label="Main menu"><ul class="main-menu nojs"><li class="top-level-entry-container active"><button type="button" id="references-button" class="top-level-entry menu-toggle" aria-controls="references-menu" aria-expanded="false">References</button><a href="/en-US/docs/Web" class="top-level-entry">References</a><ul id="references-menu" class="submenu references hidden inline-submenu-lg" aria-labelledby="references-button"><li class="apis-link-container mobile-only "><a href="/en-US/docs/Web" class="submenu-item "><div class="submenu-icon"></div><div class="submenu-content-container"><div class="submenu-item-heading">Overview / Web Technology</div><p class="submenu-item-description">Web technology reference for developers</p></div></a></li><li class="html-link-container "><a href="/en-US/docs/Web/HTML" class="submenu-item "><div class="submenu-icon html"></div><div class="submenu-content-container"><div class="submenu-item-heading">HTML</div><p class="submenu-item-description">Structure of content on the web</p></div></a></li><li class="css-link-container "><a href="/en-US/docs/Web/CSS" class="submenu-item "><div class="submenu-icon css"></div><div class="submenu-content-container"><div class="submenu-item-heading">CSS</div><p class="submenu-item-description">Code used to describe document style</p></div></a></li><li class="javascript-link-container "><a href="/en-US/docs/Web/JavaScript" class="submenu-item "><div class="submenu-icon javascript"></div><div class="submenu-content-container"><div class="submenu-item-heading">JavaScript</div><p class="submenu-item-description">General-purpose scripting language</p></div></a></li><li class="http-link-container "><a href="/en-US/docs/Web/HTTP" class="submenu-item "><div class="submenu-icon http"></div><div class="submenu-content-container"><div class="submenu-item-heading">HTTP</div><p class="submenu-item-description">Protocol for transmitting web resources</p></div></a></li><li class="apis-link-container "><a href="/en-US/docs/Web/API" class="submenu-item "><div class="submenu-icon apis"></div><div class="submenu-content-container"><div class="submenu-item-heading">Web APIs</div><p class="submenu-item-description">Interfaces for building web applications</p></div></a></li><li class="apis-link-container "><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions" class="submenu-item "><div class="submenu-icon"></div><div class="submenu-content-container"><div class="submenu-item-heading">Web Extensions</div><p class="submenu-item-description">Developing extensions for web browsers</p></div></a></li><li class="apis-link-container desktop-only "><a href="/en-US/docs/Web" class="submenu-item "><div class="submenu-icon"></div><div class="submenu-content-container"><div class="submenu-item-heading">Web Technology</div><p class="submenu-item-description">Web technology reference for developers</p></div></a></li></ul></li><li class="top-level-entry-container "><button type="button" id="guides-button" class="top-level-entry menu-toggle" aria-controls="guides-menu" aria-expanded="false">Guides</button><a href="/en-US/docs/Learn" class="top-level-entry">Guides</a><ul id="guides-menu" class="submenu guides hidden inline-submenu-lg" aria-labelledby="guides-button"><li class="apis-link-container mobile-only "><a href="/en-US/docs/Learn" class="submenu-item "><div class="submenu-icon learn"></div><div class="submenu-content-container"><div class="submenu-item-heading">Overview / MDN Learning Area</div><p class="submenu-item-description">Learn web development</p></div></a></li><li class="apis-link-container desktop-only "><a href="/en-US/docs/Learn" class="submenu-item "><div class="submenu-icon learn"></div><div class="submenu-content-container"><div class="submenu-item-heading">MDN Learning Area</div><p class="submenu-item-description">Learn web development</p></div></a></li><li class="html-link-container "><a href="/en-US/docs/Learn/HTML" class="submenu-item "><div class="submenu-icon html"></div><div class="submenu-content-container"><div class="submenu-item-heading">HTML</div><p class="submenu-item-description">Learn to structure web content with HTML</p></div></a></li><li class="css-link-container "><a href="/en-US/docs/Learn/CSS" class="submenu-item "><div class="submenu-icon css"></div><div class="submenu-content-container"><div class="submenu-item-heading">CSS</div><p class="submenu-item-description">Learn to style content using CSS</p></div></a></li><li class="javascript-link-container "><a href="/en-US/docs/Learn/JavaScript" class="submenu-item "><div class="submenu-icon javascript"></div><div class="submenu-content-container"><div class="submenu-item-heading">JavaScript</div><p class="submenu-item-description">Learn to run scripts in the browser</p></div></a></li><li class=" "><a href="/en-US/docs/Web/Accessibility" class="submenu-item "><div class="submenu-icon"></div><div class="submenu-content-container"><div class="submenu-item-heading">Accessibility</div><p class="submenu-item-description">Learn to make the web accessible to all</p></div></a></li></ul></li><li class="top-level-entry-container "><a class="top-level-entry menu-link" href="/en-US/blog/">Blog</a></li><li class="top-level-entry-container "><a class="top-level-entry menu-link" href="/en-US/play">Play</a></li><li class="top-level-entry-container "><a class="top-level-entry menu-link" href="/en-US/plus/ai-help">AI Help <sup class="new beta">Beta</sup></a></li></ul></nav><div class="header-search"><form action="/en-US/search" class="search-form search-widget" id="top-nav-search-form" role="search"><label id="top-nav-search-label" for="top-nav-search-input" class="visually-hidden">Search MDN</label><input aria-activedescendant="" aria-autocomplete="list" aria-controls="top-nav-search-menu" aria-expanded="false" aria-labelledby="top-nav-search-label" autoComplete="off" id="top-nav-search-input" role="combobox" type="search" class="search-input-field" name="q" placeholder="   " required="" value=""/><button type="button" class="button action has-icon clear-search-button"><span class="button-wrap"><span class="icon icon-cancel "></span><span class="visually-hidden">Clear search input</span></span></button><button type="submit" class="button action has-icon search-button"><span class="button-wrap"><span class="icon icon-search "></span><span class="visually-hidden">Search</span></span></button><div id="top-nav-search-menu" role="listbox" aria-labelledby="top-nav-search-label"></div></form></div><div class="theme-switcher-menu"><button type="button" class="button action has-icon theme-switcher-menu small" aria-haspopup="menu"><span class="button-wrap"><span class="icon icon-theme-os-default "></span>Theme</span></button></div><ul class="auth-container"><li><a href="?next=%2Fen-US%2Fdocs%2FWeb%2FAPI%2FWeb_Animations_API%2FUsing_the_Web_Animations_API" class="login-link" rel="nofollow">Log in</a></li><li><a href="?next=%2Fen-US%2Fdocs%2FWeb%2FAPI%2FWeb_Animations_API%2FUsing_the_Web_Animations_API" target="_self" class="button primary mdn-plus-subscribe-link"><span class="button-wrap">Sign up for free</span></a></li></ul></div></div></header><div class="article-actions-container"><div class="container"><button type="button" class="button action has-icon sidebar-button" aria-label="Expand sidebar" aria-expanded="false" aria-controls="sidebar-quicklinks"><span class="button-wrap"><span class="icon icon-sidebar "></span></span></button><nav class="breadcrumbs-container" aria-label="Breadcrumb"><ol typeof="BreadcrumbList" vocab="https://schema.org/" aria-label="breadcrumbs"><li property="itemListElement" typeof="ListItem"><a class="breadcrumb" property="item" typeof="WebPage" href="/en-US/docs/Web"><span property="name">References</span></a><meta property="position" content="1"/></li><li property="itemListElement" typeof="ListItem"><a class="breadcrumb" property="item" typeof="WebPage" href="/en-US/docs/Web/API"><span property="name">Web APIs</span></a><meta property="position" content="2"/></li><li property="itemListElement" typeof="ListItem"><a class="breadcrumb" property="item" typeof="WebPage" href="/en-US/docs/Web/API/Web_Animations_API"><span property="name">Web Animations API</span></a><meta property="position" content="3"/></li><li property="itemListElement" typeof="ListItem"><a class="breadcrumb-current-page" property="item" typeof="WebPage" href="/en-US/docs/Web/API/Web_Animations_API/Using_the_Web_Animations_API"><span property="name">Using the Web Animations API</span></a><meta property="position" content="4"/></li></ol></nav></div></div></div><div class="main-wrapper"><div class="sidebar-container"><aside id="sidebar-quicklinks" class="sidebar" data-macro="DefaultAPISidebar"><button type="button" class="button action backdrop" aria-label="Collapse sidebar"><span class="button-wrap"></span></button><nav aria-label="Related Topics" class="sidebar-inner"><header class="sidebar-actions"><section class="sidebar-filter-container"><div class="sidebar-filter "><label id="sidebar-filter-label" class="sidebar-filter-label" for="sidebar-filter-input"><span class="icon icon-filter"></span><span class="visually-hidden">Filter sidebar</span></label><input id="sidebar-filter-input" autoComplete="off" class="sidebar-filter-input-field false" type="text" placeholder="Filter" value=""/><button type="button" class="button action has-icon clear-sidebar-filter-button"><span class="button-wrap"><span class="icon icon-cancel "></span><span class="visually-hidden">Clear filter input</span></span></button></div></section></header><div class="sidebar-inner-nav"><div class="in-nav-toc"><div class="document-toc-container"><section class="document-toc"><header><h2 class="document-toc-heading">In this article</h2></header><ul class="document-toc-list"><li class="document-toc-item "><a class="document-toc-link" href="#meet_the_web_animations_api">Meet the Web Animations API</a></li><li class="document-toc-item "><a class="document-toc-link" href="#writing_css_animations_with_the_web_animations_api">Writing CSS Animations with the Web Animations API</a></li><li class="document-toc-item "><a class="document-toc-link" href="#controlling_playback_with_play_pause_reverse_and_updateplaybackrate">Controlling playback with play(), pause(), reverse(), and updatePlaybackRate()</a></li><li class="document-toc-item "><a class="document-toc-link" href="#persisting_animation_styles">Persisting animation styles</a></li><li class="document-toc-item "><a class="document-toc-link" href="#automatically_removing_filling_animations">Automatically removing filling animations</a></li><li class="document-toc-item "><a class="document-toc-link" href="#getting_information_out_of_animations">Getting information out of animations</a></li><li class="document-toc-item "><a class="document-toc-link" href="#callbacks_and_promises">Callbacks and promises</a></li><li class="document-toc-item "><a class="document-toc-link" href="#conclusion">Conclusion</a></li><li class="document-toc-item "><a class="document-toc-link" href="#see_also">See also</a></li></ul></section></div></div><div class="sidebar-body"><ol><li><strong><a href="/en-US/docs/Web/API/Web_Animations_API">Web Animations API</a></strong></li><li class="toggle"><details open=""><summary>Guides</summary><ol><li><em><a href="/en-US/docs/Web/API/Web_Animations_API/Using_the_Web_Animations_API" aria-current="page">Using the Web Animations API</a></em></li><li><a href="/en-US/docs/Web/API/Web_Animations_API/Web_Animations_API_Concepts">Web Animations API Concepts</a></li><li><a href="/en-US/docs/Web/API/Web_Animations_API/Keyframe_Formats">Keyframe Formats</a></li></ol></details></li><li class="toggle"><details open=""><summary>Interfaces</summary><ol><li><a href="/en-US/docs/Web/API/Animation"><code>Animation</code></a></li><li><a href="/en-US/docs/Web/API/AnimationEffect"><code>AnimationEffect</code></a></li><li><a href="/en-US/docs/Web/API/AnimationEvent"><code>AnimationEvent</code></a></li><li><a href="/en-US/docs/Web/API/AnimationTimeline"><code>AnimationTimeline</code></a></li><li><a href="/en-US/docs/Web/API/AnimationPlaybackEvent"><code>AnimationPlaybackEvent</code></a></li><li><a href="/en-US/docs/Web/API/DocumentTimeline"><code>DocumentTimeline</code></a></li><li><a href="/en-US/docs/Web/API/KeyframeEffect"><code>KeyframeEffect</code></a></li><li><a href="/en-US/docs/Web/API/ScrollTimeline"><code>ScrollTimeline</code></a></li><li><a href="/en-US/docs/Web/API/ViewTimeline"><code>ViewTimeline</code></a></li></ol></details></li><li class="toggle"><details open=""><summary>Properties</summary><ol><li><a href="/en-US/docs/Web/API/Document/timeline"><code>Document.timeline</code></a></li></ol></details></li><li class="toggle"><details open=""><summary>Methods</summary><ol><li><a href="/en-US/docs/Web/API/Document/getAnimations"><code>Document.getAnimations()</code></a></li><li><a href="/en-US/docs/Web/API/Element/animate"><code>Element.animate()</code></a></li><li><a href="/en-US/docs/Web/API/Element/getAnimations"><code>Element.getAnimations()</code></a></li></ol></details></li></ol></div></div></nav></aside><div class="toc-container"><aside class="toc"><nav><div class="document-toc-container"><section class="document-toc"><header><h2 class="document-toc-heading">In this article</h2></header><ul class="document-toc-list"><li class="document-toc-item "><a class="document-toc-link" href="#meet_the_web_animations_api">Meet the Web Animations API</a></li><li class="document-toc-item "><a class="document-toc-link" href="#writing_css_animations_with_the_web_animations_api">Writing CSS Animations with the Web Animations API</a></li><li class="document-toc-item "><a class="document-toc-link" href="#controlling_playback_with_play_pause_reverse_and_updateplaybackrate">Controlling playback with play(), pause(), reverse(), and updatePlaybackRate()</a></li><li class="document-toc-item "><a class="document-toc-link" href="#persisting_animation_styles">Persisting animation styles</a></li><li class="document-toc-item "><a class="document-toc-link" href="#automatically_removing_filling_animations">Automatically removing filling animations</a></li><li class="document-toc-item "><a class="document-toc-link" href="#getting_information_out_of_animations">Getting information out of animations</a></li><li class="document-toc-item "><a class="document-toc-link" href="#callbacks_and_promises">Callbacks and promises</a></li><li class="document-toc-item "><a class="document-toc-link" href="#conclusion">Conclusion</a></li><li class="document-toc-item "><a class="document-toc-link" href="#see_also">See also</a></li></ul></section></div></nav></aside></div></div><main id="content" class="main-content  "><article class="main-page-content" lang="en-US"><header><h1>Using the Web Animations API</h1></header><div class="section-content"><p>The Web Animations API lets us construct animations and control their playback with JavaScript. This article will start you off in the right direction with fun demos and tutorials featuring Alice in Wonderland.</p></div><section aria-labelledby="meet_the_web_animations_api"><h2 id="meet_the_web_animations_api"><a href="#meet_the_web_animations_api">Meet the Web Animations API</a></h2><div class="section-content"><p>The <a href="/en-US/docs/Web/API/Web_Animations_API">Web Animations API</a> opens the browser's animation engine to developers and manipulation by JavaScript. This API was designed to underlie implementations of both <a href="/en-US/docs/Web/CSS/CSS_animations">CSS Animations</a> and <a href="/en-US/docs/Web/CSS/CSS_transitions">CSS Transitions</a>, and leaves the door open to future animation effects. It is one of the most performant ways to animate on the Web, letting the browser make its own internal optimizations without hacks, coercion, or <a href="/en-US/docs/Web/API/window/requestAnimationFrame"><code>Window.requestAnimationFrame()</code></a>.</p>
<p>With the Web Animations API, we can move interactive animations from stylesheets to JavaScript, separating presentation from behavior. We no longer need to rely on DOM-heavy techniques such as writing CSS properties and scoping classes onto elements to control playback direction. And unlike pure, declarative CSS, JavaScript also lets us dynamically set values from properties to durations. For building custom animation libraries and creating interactive animations, the Web Animations API might be the perfect tool for the job. Let's see what it can do!</p></div></section><section aria-labelledby="writing_css_animations_with_the_web_animations_api"><h2 id="writing_css_animations_with_the_web_animations_api"><a href="#writing_css_animations_with_the_web_animations_api">Writing CSS Animations with the Web Animations API</a></h2><div class="section-content"><p>One of the more familiar ways to approach learning the Web Animations API is to start with something most web developers have played with before: CSS Animations. CSS Animations have a familiar syntax that breaks down nicely for demonstration purposes.</p></div></section><section aria-labelledby="the_css_version"><h3 id="the_css_version"><a href="#the_css_version">The CSS version</a></h3><div class="section-content"><p>Here's a tumbling animation written in CSS showing Alice falling down the rabbit hole that leads to Wonderland (see the full <a href="https://codepen.io/rachelnabors/pen/QyOqqW" class="external" target="_blank">code on Codepen</a>):</p>
<p><a href="https://codepen.io/rachelnabors/pen/rxpmJL" class="external" target="_blank"><img src="/en-US/docs/Web/API/Web_Animations_API/Using_the_Web_Animations_API/tumbling-alice_optimized.gif" alt="Alice Tumbling down the rabbit's hole." width="700" height="374" loading="lazy"></a></p>
<p>Notice that the background moves, Alice spins, and her color changes at an offset from her spinning. We're going to focus on just Alice for this tutorial. Here's the simplified CSS that controls Alice's animation:</p>
<div class="code-example"><p class="example-header"><span class="language-name">css</span></p><pre class="brush: css notranslate"><code><span class="token selector">#alice</span> <span class="token punctuation">{</span>
  <span class="token property">animation</span><span class="token punctuation">:</span> aliceTumbling infinite 3s linear<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token atrule"><span class="token rule">@keyframes</span> aliceTumbling</span> <span class="token punctuation">{</span>
  <span class="token selector">0%</span> <span class="token punctuation">{</span>
    <span class="token property">color</span><span class="token punctuation">:</span> #000<span class="token punctuation">;</span>
    <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">rotate</span><span class="token punctuation">(</span>0<span class="token punctuation">)</span> <span class="token function">translate3D</span><span class="token punctuation">(</span>-50%<span class="token punctuation">,</span> -50%<span class="token punctuation">,</span> 0<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">30%</span> <span class="token punctuation">{</span>
    <span class="token property">color</span><span class="token punctuation">:</span> #431236<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">100%</span> <span class="token punctuation">{</span>
    <span class="token property">color</span><span class="token punctuation">:</span> #000<span class="token punctuation">;</span>
    <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">rotate</span><span class="token punctuation">(</span>360deg<span class="token punctuation">)</span> <span class="token function">translate3D</span><span class="token punctuation">(</span>-50%<span class="token punctuation">,</span> -50%<span class="token punctuation">,</span> 0<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p>This changes Alice's color and her transform's rotation over 3 seconds at a constant (linear) rate and loops infinitely. In the <a href="/en-US/docs/Web/CSS/@keyframes">@keyframes</a> block we can see that 30% of the way through each loop (about .9 seconds in), Alice's color changes from black to a deep burgundy then back again by the end of the loop.</p></div></section><section aria-labelledby="moving_it_to_javascript"><h3 id="moving_it_to_javascript"><a href="#moving_it_to_javascript">Moving it to JavaScript</a></h3><div class="section-content"><p>Now let's try creating the same animation with the Web Animations API.</p>
<h4 id="representing_keyframes">Representing keyframes</h4>
<p>The first thing we need is to create a <a href="/en-US/docs/Web/API/Web_Animations_API/Keyframe_Formats">Keyframe Object</a> corresponding to our CSS <a href="/en-US/docs/Web/CSS/@keyframes">@keyframes</a> block:</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code><span class="token keyword">const</span> aliceTumbling <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">transform</span><span class="token operator">:</span> <span class="token string">"rotate(0) translate3D(-50%, -50%, 0)"</span><span class="token punctuation">,</span> <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"#000"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"#431236"</span><span class="token punctuation">,</span> <span class="token literal-property property">offset</span><span class="token operator">:</span> <span class="token number">0.3</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">transform</span><span class="token operator">:</span> <span class="token string">"rotate(360deg) translate3D(-50%, -50%, 0)"</span><span class="token punctuation">,</span> <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"#000"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div>
<p>Here we're using an array containing multiple objects. Each object represents a key from the original CSS. However, unlike CSS, the Web Animations API doesn't need to explicitly be told the percentages along the animation for each key to appear at. It will automatically divide the animation into equal parts based on the number of keys you give it. This means that a Keyframe object with three keys will play the middle key 50% of the way through each loop of the animation unless told otherwise.</p>
<p>When we want to explicitly set a key's offset from the other keys, we can specify an offset directly in the object, separated from the declaration with a comma. In the above example, to make sure that Alice's color changes at 30% (not 50%) for the color change, we are giving it <code>offset: 0.3</code>.</p>
<p>Currently, there should be at least two keyframes specified (representing the starting and ending states of the animation sequence). If your keyframe list has only one entry, <a href="/en-US/docs/Web/API/Element/animate"><code>Element.animate()</code></a> may throw a <code>NotSupportedError</code> <a href="/en-US/docs/Web/API/DOMException"><code>DOMException</code></a> in some browsers until they are updated.</p>
<p>So to recap, the keys are equally spaced by default unless you specify an offset on a key. Handy, no?</p>
<h4 id="representing_timing_properties">Representing timing properties</h4>
<p>We'll also need to create an object of timing properties corresponding to the values in Alice's animation:</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code><span class="token keyword">const</span> aliceTiming <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">3000</span><span class="token punctuation">,</span>
  <span class="token literal-property property">iterations</span><span class="token operator">:</span> <span class="token number">Infinity</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div>
<p>You'll notice a few differences here from how equivalent values are represented in CSS:</p>
<ul>
  <li>For one, the duration is in milliseconds as opposed to seconds — 3000 not 3s. Like <a href="/en-US/docs/Web/API/setTimeout"><code>setTimeout()</code></a> and <a href="/en-US/docs/Web/API/window/requestAnimationFrame"><code>Window.requestAnimationFrame()</code></a>, the Web Animations API only takes milliseconds.</li>
  <li>The other thing you'll notice is that it's <code>iterations</code>, not <code>iteration-count</code>.</li>
</ul>
<div class="notecard note" id="sect1">
  <p><strong>Note:</strong> There are a number of small differences between the terminology used in CSS Animations and the terminology used in Web Animations. For instance, Web Animations doesn't use the string <code>"infinite"</code>, but instead uses the JavaScript keyword <code>Infinity</code>. And instead of <code>timing-function</code> we use <code>easing</code>. We aren't listing an <code>easing</code> value here because, unlike CSS Animations where the default <a href="/en-US/docs/Web/CSS/animation-timing-function">animation-timing-function</a> is <code>ease</code>, in the Web Animations API the default easing is <code>linear</code> — which is what we want here.</p>
</div>
<h4 id="bring_the_pieces_together">Bring the pieces together</h4>
<p>Now it's time to bring them both together with the <a href="/en-US/docs/Web/API/Element/animate"><code>Element.animate()</code></a> method:</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"alice"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">animate</span><span class="token punctuation">(</span>aliceTumbling<span class="token punctuation">,</span> aliceTiming<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>And boom: the animation starts playing (see the finished <a href="https://codepen.io/rachelnabors/pen/rxpmJL" class="external" target="_blank">version on Codepen</a>).</p>
<p>The <code>animate()</code> method can be called on any DOM element that could be animated with CSS. And it can be written in several ways. Instead of making objects for keyframes and timing properties, we could just pass their values in directly, like so:</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"alice"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">animate</span><span class="token punctuation">(</span>
  <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">transform</span><span class="token operator">:</span> <span class="token string">"rotate(0) translate3D(-50%, -50%, 0)"</span><span class="token punctuation">,</span> <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"#000"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"#431236"</span><span class="token punctuation">,</span> <span class="token literal-property property">offset</span><span class="token operator">:</span> <span class="token number">0.3</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">transform</span><span class="token operator">:</span> <span class="token string">"rotate(360deg) translate3D(-50%, -50%, 0)"</span><span class="token punctuation">,</span> <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"#000"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">3000</span><span class="token punctuation">,</span>
    <span class="token literal-property property">iterations</span><span class="token operator">:</span> <span class="token number">Infinity</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>What's more, if we only wanted to specify the duration of the animation and not its iterations (by default, animations iterate once), we could pass in the milliseconds alone:</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"alice"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">animate</span><span class="token punctuation">(</span>
  <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">transform</span><span class="token operator">:</span> <span class="token string">"rotate(0) translate3D(-50%, -50%, 0)"</span><span class="token punctuation">,</span> <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"#000"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"#431236"</span><span class="token punctuation">,</span> <span class="token literal-property property">offset</span><span class="token operator">:</span> <span class="token number">0.3</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">transform</span><span class="token operator">:</span> <span class="token string">"rotate(360deg) translate3D(-50%, -50%, 0)"</span><span class="token punctuation">,</span> <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"#000"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token number">3000</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div></section><section aria-labelledby="controlling_playback_with_play_pause_reverse_and_updateplaybackrate"><h2 id="controlling_playback_with_play_pause_reverse_and_updateplaybackrate"><a href="#controlling_playback_with_play_pause_reverse_and_updateplaybackrate">Controlling playback with play(), pause(), reverse(), and updatePlaybackRate()</a></h2><div class="section-content"><p>While we can write CSS Animations with the Web Animations API, where the API really comes in handy is manipulating the animation's playback. The Web Animations API provides several useful methods for controlling playback. Let's take a look at pausing and playing animations in the Growing/Shrinking Alice game (check out the <a href="https://codepen.io/rachelnabors/pen/PNYGZQ" class="external" target="_blank">full code on Codepen</a>):</p>
<p><a href="https://codepen.io/rachelnabors/pen/PNYGZQ?editors=0010" class="external" target="_blank"><img src="/en-US/docs/Web/API/Web_Animations_API/Using_the_Web_Animations_API/growing-shrinking_article_optimized.gif" alt="Playing the growing and shrinking game with Alice." width="700" height="374" loading="lazy"></a></p>
<p>In this game, Alice has an animation that causes her to go from small to big which we control via a bottle and a cupcake. Both of these have their own animations.</p></div></section><section aria-labelledby="pausing_and_playing_animations"><h3 id="pausing_and_playing_animations"><a href="#pausing_and_playing_animations">Pausing and playing animations</a></h3><div class="section-content"><p>We'll talk more about Alice's animation later, but for now, let's look closer at the cupcake's animation:</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code><span class="token keyword">const</span> nommingCake <span class="token operator">=</span> document
  <span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"eat-me_sprite"</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">animate</span><span class="token punctuation">(</span>
    <span class="token punctuation">[</span><span class="token punctuation">{</span> <span class="token literal-property property">transform</span><span class="token operator">:</span> <span class="token string">"translateY(0)"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">transform</span><span class="token operator">:</span> <span class="token string">"translateY(-80%)"</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token string">"forwards"</span><span class="token punctuation">,</span>
      <span class="token literal-property property">easing</span><span class="token operator">:</span> <span class="token string">"steps(4, end)"</span><span class="token punctuation">,</span>
      <span class="token literal-property property">duration</span><span class="token operator">:</span> aliceChange<span class="token punctuation">.</span>effect<span class="token punctuation">.</span><span class="token function">getComputedTiming</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>duration <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>The <a href="/en-US/docs/Web/API/Element/animate"><code>Element.animate()</code></a> method will immediately run after it is called. To prevent the cake from eating itself up before the user has had the chance to click on it, we call <a href="/en-US/docs/Web/API/Animation/pause"><code>Animation.pause()</code></a> on it immediately after it is defined, like so:</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code>nommingCake<span class="token punctuation">.</span><span class="token function">pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>We can now use the <a href="/en-US/docs/Web/API/Animation/play"><code>Animation.play()</code></a> method to run it whenever we're ready:</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code>nommingCake<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>Specifically, we want to link it to Alice's animation, so she gets bigger as the cupcake gets eaten. We can achieve this via the following function:</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code><span class="token keyword">const</span> <span class="token function-variable function">growAlice</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// Play Alice's animation.</span>
  aliceChange<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Play the cake's animation.</span>
  nommingCake<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div>
<p>When a user holds their mouse down or presses their finger on the cake on a touch screen, we can now call <code>growAlice</code> to make all the animations play:</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code>cake<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"mousedown"</span><span class="token punctuation">,</span> growAlice<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cake<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"touchstart"</span><span class="token punctuation">,</span> growAlice<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div></section><section aria-labelledby="other_useful_methods"><h3 id="other_useful_methods"><a href="#other_useful_methods">Other useful methods</a></h3><div class="section-content"><p>In addition to pausing and playing, we can use the following Animation methods:</p>
<ul>
  <li><a href="/en-US/docs/Web/API/Animation/finish"><code>Animation.finish()</code></a> skips to the end of the animation.</li>
  <li><a href="/en-US/docs/Web/API/Animation/cancel"><code>Animation.cancel()</code></a> aborts the animation and removes its effects.</li>
  <li><a href="/en-US/docs/Web/API/Animation/reverse"><code>Animation.reverse()</code></a> sets the animation's playback rate (<a href="/en-US/docs/Web/API/Animation/playbackRate"><code>Animation.playbackRate</code></a>) to a negative value so it runs backward.</li>
</ul>
<p>Let's take a look at <code>playbackRate</code> first — a negative playbackRate will cause an animation to run in reverse. When Alice drinks from the bottle, she grows smaller. This is because the bottle changes her animation's playbackRate from 1 to -1:</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code><span class="token keyword">const</span> <span class="token function-variable function">shrinkAlice</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  aliceChange<span class="token punctuation">.</span>playbackRate <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
  aliceChange<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

bottle<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"mousedown"</span><span class="token punctuation">,</span> shrinkAlice<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
bottle<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"touchstart"</span><span class="token punctuation">,</span> shrinkAlice<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>In <a href="https://en.wikipedia.org/wiki/Through_the_Looking-Glass" class="external" target="_blank">Through the Looking-Glass</a>, Alice travels to a world where she must run to stay in place — and run twice as fast to move forward! In the Red Queen's Race example, Alice and the Red Queen are running to stay in place (check out the <a href="https://codepen.io/rachelnabors/pen/PNGGaV" class="external" target="_blank">full code on Codepen</a>):</p>
<p><a href="https://codepen.io/rachelnabors/pen/PNGGaV" class="external" target="_blank"><img src="/en-US/docs/Web/API/Web_Animations_API/Using_the_Web_Animations_API/red-queen-race_optimized.gif" alt="Alice and the Red Queen race to get to the next square in this game." width="640" height="342" loading="lazy"></a></p>
<p>Because small children tire out easily, unlike automaton chess pieces, Alice is constantly slowing down. We can do this by setting a decay on her animation's <code>playbackRate</code>. We use <code>updatePlaybackRate()</code> instead of setting the playbackRate directly since that produces a smooth update:</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code><span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// Make sure the playback rate never falls below .4</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>redQueen_alice<span class="token punctuation">.</span>playbackRate <span class="token operator">&gt;</span> <span class="token number">0.4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    redQueen_alice<span class="token punctuation">.</span><span class="token function">updatePlaybackRate</span><span class="token punctuation">(</span>redQueen_alice<span class="token punctuation">.</span>playbackRate <span class="token operator">*</span> <span class="token number">0.9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>But urging them on by clicking or tapping causes them to speed up by multiplying their playbackRate:</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code><span class="token keyword">const</span> <span class="token function-variable function">goFaster</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  redQueen_alice<span class="token punctuation">.</span><span class="token function">updatePlaybackRate</span><span class="token punctuation">(</span>redQueen_alice<span class="token punctuation">.</span>playbackRate <span class="token operator">*</span> <span class="token number">1.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> goFaster<span class="token punctuation">)</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"touchstart"</span><span class="token punctuation">,</span> goFaster<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>The background elements also have <code>playbackRate</code>s that are impacted when you click or tap. What happens when you make Alice and the Red Queen run twice as fast? What happens when you let them slow down?</p></div></section><section aria-labelledby="persisting_animation_styles"><h2 id="persisting_animation_styles"><a href="#persisting_animation_styles">Persisting animation styles</a></h2><div class="section-content"><p>When animating elements, a common use case is to persist the final state of the animation, after the animation has finished. One method sometimes used for this is to set the animation's <a href="/en-US/docs/Web/API/KeyframeEffect/KeyframeEffect#fill">fill mode</a> to <code>forwards</code>. However, it is not recommended to use fill modes to persist the effect of an animation indefinitely, for two reasons:</p>
<ul>
  <li>The browser has to maintain the state of the animation while it is still active, so the animation continues to consume resources even though it is no longer animating. Note that this is somewhat alleviated by the browser <a href="#automatically_removing_filling_animations">automatically removing filling animations</a>.</li>
  <li>Styles applied by animations have a <a href="/en-US/docs/Web/CSS/Cascade#cascading_order">higher precedence in the cascade</a> than specified styles, so it can be difficult to override them when needed.</li>
</ul>
<p>A better approach is to use the <a href="/en-US/docs/Web/API/Animation/commitStyles"><code>Animation.commitStyles()</code></a> method. This writes the computed values of the animation's current styles into its target element's <a href="/en-US/docs/Web/HTML/Global_attributes#style"><code>style</code></a> attribute, after which the element can be restyled normally.</p></div></section><section aria-labelledby="automatically_removing_filling_animations"><h2 id="automatically_removing_filling_animations"><a href="#automatically_removing_filling_animations">Automatically removing filling animations</a></h2><div class="section-content"><p>It is possible to trigger a large number of animations on the same element. If they are indefinite (i.e., forwards-filling), this can result in a huge animations list, which could create a memory leak. For this reason, browsers automatically remove filling animations after they are replaced by newer animations, unless the developer explicitly specifies to keep them.</p>
<p>Animations are removed when all of the following are true:</p>
<ul>
  <li>The animation is filling (its <code>fill</code> is <code>forwards</code> if it is playing forwards, <code>backwards</code> if it is playing backwards, or <code>both</code>).</li>
  <li>The animation is finished. (Note that because of the <code>fill</code> it will still be in effect.)</li>
  <li>The animation's timeline is monotonically increasing. (This is always true for <a href="/en-US/docs/Web/API/DocumentTimeline"><code>DocumentTimeline</code></a>; other timelines such as <a href="/en-US/docs/Web/CSS/scroll-timeline"><code>scroll-timeline</code></a> can run backwards.)</li>
  <li>The animation is not being controlled by declarative markup such as CSS.</li>
  <li>Every styling effect of the animation's <a href="/en-US/docs/Web/API/AnimationEffect"><code>AnimationEffect</code></a> is being overridden by another animation that also satisfies all the conditions above. (Typically, when two animations would set the same style property of the same element, the one created last overrides the other.)</li>
</ul>
<p>The first four conditions ensure that, without intervention by JavaScript code, the animation's effect will never change or end. The last condition ensures that the animation will never actually affect the style of any element: it has been entirely replaced.</p>
<p>When the animation is automatically removed, the animation's <a href="/en-US/docs/Web/API/Animation/remove_event" title="remove"><code>remove</code></a> event fires.</p>
<p>To prevent the browser from automatically removing animations, call the animation's <a href="/en-US/docs/Web/API/Animation/persist" title="persist()"><code>persist()</code></a> method.</p>
<p>The animation's <a href="/en-US/docs/Web/API/Animation/replaceState"><code>animation.replaceState</code></a> property will be <code>removed</code> if the animation has been removed, <code>persisted</code> if you have called <a href="/en-US/docs/Web/API/Animation/persist" title="persist()"><code>persist()</code></a> on the animation, or <code>active</code> otherwise.</p></div></section><section aria-labelledby="getting_information_out_of_animations"><h2 id="getting_information_out_of_animations"><a href="#getting_information_out_of_animations">Getting information out of animations</a></h2><div class="section-content"><p>Imagine other ways we could use playbackRate, such as improving accessibility for users with vestibular disorders by letting them slow down animations across an entire site. That's impossible to do with CSS without recalculating durations in every CSS rule, but with the Web Animations API, we could use the <a href="/en-US/docs/Web/API/Document/getAnimations"><code>Document.getAnimations</code></a> method to loop over each animation on the page and halve their <code>playbackRate</code>s, like so:</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code>document<span class="token punctuation">.</span><span class="token function">getAnimations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">animation</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  animation<span class="token punctuation">.</span><span class="token function">updatePlaybackRate</span><span class="token punctuation">(</span>animation<span class="token punctuation">.</span>playbackRate <span class="token operator">*</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>With the Web Animations API, all you need to change is just one little property!</p>
<p>Another thing that's tough to do with CSS Animations alone is creating dependencies on values provided by other animations. For instance, in the Growing and Shrinking Alice game example, you might have noticed something odd about the cake's duration:</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"eat-me_sprite"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">duration</span><span class="token operator">:</span> aliceChange<span class="token punctuation">.</span>effect<span class="token punctuation">.</span>timing<span class="token punctuation">.</span>duration <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>To understand what's happening here, let's take a look at Alice's animation:</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code><span class="token keyword">const</span> aliceChange <span class="token operator">=</span> document
  <span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"alice"</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">animate</span><span class="token punctuation">(</span>
    <span class="token punctuation">[</span>
      <span class="token punctuation">{</span> <span class="token literal-property property">transform</span><span class="token operator">:</span> <span class="token string">"translate(-50%, -50%) scale(.5)"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> <span class="token literal-property property">transform</span><span class="token operator">:</span> <span class="token string">"translate(-50%, -50%) scale(2)"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">8000</span><span class="token punctuation">,</span>
      <span class="token literal-property property">easing</span><span class="token operator">:</span> <span class="token string">"ease-in-out"</span><span class="token punctuation">,</span>
      <span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token string">"both"</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>Alice's animation has her going from half her size to twice her size over 8 seconds. Then we pause her:</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code>aliceChange<span class="token punctuation">.</span><span class="token function">pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>If we had left her paused at the beginning of her animation, she'd start at half her full size, as if she'd drunk the entire bottle already! We want to set her animation's "playhead" in the middle, so she's already halfway done. We could do that by setting her <a href="/en-US/docs/Web/API/Animation/currentTime"><code>Animation.currentTime</code></a> to 4 seconds, like so:</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code>aliceChange<span class="token punctuation">.</span>currentTime <span class="token operator">=</span> <span class="token number">4000</span><span class="token punctuation">;</span>
</code></pre></div>
<p>But while working on this animation, we might change Alice's duration a lot. Wouldn't it be better if we set her <code>currentTime</code> dynamically, so we don't have to make two updates at a time? We can, in fact, do so by referencing aliceChange's <a href="/en-US/docs/Web/API/Animation/effect"><code>Animation.effect</code></a> property, which returns an object containing all the details of the effect(s) active on Alice:</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code>aliceChange<span class="token punctuation">.</span>currentTime <span class="token operator">=</span> aliceChange<span class="token punctuation">.</span>effect<span class="token punctuation">.</span><span class="token function">getComputedTiming</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>duration <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
</code></pre></div>
<p><code>effect</code> lets us access the animation's keyframes and timing properties — <code>aliceChange.effect.getComputedTiming()</code> points to Alice's timing object — this contains her <a href="/en-US/docs/Web/API/KeyframeEffect/KeyframeEffect"><code>duration</code></a>. We can divide her duration in half to get the midpoint for her animation's timeline, setting her to be normal height. Now we can reverse and play her animation in either direction to make her grow smaller or larger!</p>
<p>And we can do the same thing when setting the cake and bottle durations:</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code><span class="token keyword">const</span> drinking <span class="token operator">=</span> document
  <span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"liquid"</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span> <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token string">"100%"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token string">"0"</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token string">"forwards"</span><span class="token punctuation">,</span>
    <span class="token literal-property property">duration</span><span class="token operator">:</span> aliceChange<span class="token punctuation">.</span>effect<span class="token punctuation">.</span><span class="token function">getComputedTiming</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>duration <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
drinking<span class="token punctuation">.</span><span class="token function">pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>Now all three animations are linked to just one duration, which we can change easily from one place.</p>
<p>We can also use the Web Animations API to figure out the animation's current time. The game ends when you run out of cake to eat or empty the bottle. Which vignette players are presented with depends on how far along Alice was in her animation, whether she grew too big and can't get in the tiny door anymore or too small and cannot reach the key to open the door. We can figure out whether she's on the large end or small end of her animation by getting her animation's <a href="/en-US/docs/Web/API/Animation/currentTime"><code>currentTime</code></a> and dividing it by her <code>activeDuration</code>:</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code><span class="token keyword">const</span> <span class="token function-variable function">endGame</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// get Alice's timeline's playhead location</span>
  <span class="token keyword">const</span> alicePlayhead <span class="token operator">=</span> aliceChange<span class="token punctuation">.</span>currentTime<span class="token punctuation">;</span>
  <span class="token keyword">const</span> aliceTimeline <span class="token operator">=</span> aliceChange<span class="token punctuation">.</span>effect<span class="token punctuation">.</span><span class="token function">getComputedTiming</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>activeDuration<span class="token punctuation">;</span>

  <span class="token comment">// stops Alice's and other animations</span>
  <span class="token function">stopPlayingAlice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// depending on which third it falls into</span>
  <span class="token keyword">const</span> aliceHeight <span class="token operator">=</span> alicePlayhead <span class="token operator">/</span> aliceTimeline<span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>aliceHeight <span class="token operator">&lt;=</span> <span class="token number">0.333</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Alice got smaller!</span>
    <span class="token comment">// …</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>aliceHeight <span class="token operator">&gt;=</span> <span class="token number">0.666</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Alice got bigger!</span>
    <span class="token comment">// …</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// Alice didn't change significantly</span>
    <span class="token comment">// …</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div>
<div class="notecard note" id="sect2">
  <p><strong>Note:</strong> <code>getAnimations()</code> and <code>effect</code> are not shipping in all browsers as of this writing, but the polyfill does support them today.</p>
</div></div></section><section aria-labelledby="callbacks_and_promises"><h2 id="callbacks_and_promises"><a href="#callbacks_and_promises">Callbacks and promises</a></h2><div class="section-content"><p>CSS Animations and Transitions have their own event listeners, and these are also possible with the Web Animations API:</p>
<ul>
  <li><a href="/en-US/docs/Web/API/Animation/finish_event"><code>onfinish</code></a> is the event handler for the <code>finish</code> event and can be triggered manually with <a href="/en-US/docs/Web/API/Animation/finish"><code>finish()</code></a>.</li>
  <li><a href="/en-US/docs/Web/API/Animation/cancel_event"><code>oncancel</code></a> is the event handler for the <code>cancel</code> event and can be triggers with <a href="/en-US/docs/Web/API/Animation/cancel"><code>cancel()</code></a>.</li>
</ul>
<p>Here we set the callbacks for the cake, bottle, and Alice to fire the <code>endGame</code> function:</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code><span class="token comment">// When the cake or bottle runs out</span>
nommingCake<span class="token punctuation">.</span>onfinish <span class="token operator">=</span> endGame<span class="token punctuation">;</span>
drinking<span class="token punctuation">.</span>onfinish <span class="token operator">=</span> endGame<span class="token punctuation">;</span>

<span class="token comment">// Alice reaches the end of her animation</span>
aliceChange<span class="token punctuation">.</span>onfinish <span class="token operator">=</span> endGame<span class="token punctuation">;</span>
</code></pre></div>
<p>Better still, the Web Animations API also provides a <a href="/en-US/docs/Web/API/Animation/finished"><code>finished</code></a> promise that will resolve when the animation finishes, or reject if it is canceled.</p></div></section><section aria-labelledby="conclusion"><h2 id="conclusion"><a href="#conclusion">Conclusion</a></h2><div class="section-content"><p>These are the basic features of the Web Animations API. By now you should be ready to "jump down the rabbit hole" of animating in the browser and ready to write your own animation experiments!</p></div></section><section aria-labelledby="see_also"><h2 id="see_also"><a href="#see_also">See also</a></h2><div class="section-content"><ul>
  <li>The <a href="https://codepen.io/collection/nqNJvD" class="external" target="_blank">full suite of Alice in Wonderland demos</a> on CodePen for you to play with, fork, and share.</li>
  <li><a href="https://hacks.mozilla.org/2016/08/animating-like-you-just-dont-care-with-element-animate/" class="external" target="_blank">Animating like you just don't care with Element.animate</a> (2016) Explains the background of the Web Animations API and why it is more performant than other web animation methods.</li>
</ul></div></section><aside class="metadata"><div class="metadata-content-container"><div id="on-github" class="on-github"><h3>Found a content problem with this page?</h3><ul><li><a href="https://github.com/mdn/content/edit/main/files/en-us/web/api/web_animations_api/using_the_web_animations_api/index.md" title="This will take you to GitHub, where you&#x27;ll need to sign in first." target="_blank" rel="noopener noreferrer">Edit the page on GitHub</a>.</li><li><a href="https://github.com/mdn/content/issues/new?template=page-report.yml&amp;mdn-url=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FWeb_Animations_API%2FUsing_the_Web_Animations_API&amp;metadata=%3C%21--+Do+not+make+changes+below+this+line+--%3E%0A%3Cdetails%3E%0A%3Csummary%3EPage+report+details%3C%2Fsummary%3E%0A%0A*+Folder%3A+%60en-us%2Fweb%2Fapi%2Fweb_animations_api%2Fusing_the_web_animations_api%60%0A*+MDN+URL%3A+https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FWeb_Animations_API%2FUsing_the_Web_Animations_API%0A*+GitHub+URL%3A+https%3A%2F%2Fgithub.com%2Fmdn%2Fcontent%2Fblob%2Fmain%2Ffiles%2Fen-us%2Fweb%2Fapi%2Fweb_animations_api%2Fusing_the_web_animations_api%2Findex.md%0A*+Last+commit%3A+https%3A%2F%2Fgithub.com%2Fmdn%2Fcontent%2Fcommit%2F76717f752447b6eef25bf29c12272e407ee5cb6b%0A*+Document+last+modified%3A+2023-07-17T23%3A17%3A51.000Z%0A%0A%3C%2Fdetails%3E" title="This will take you to GitHub to file a new issue." target="_blank" rel="noopener noreferrer">Report the content issue</a>.</li><li><a href="https://github.com/mdn/content/blob/main/files/en-us/web/api/web_animations_api/using_the_web_animations_api/index.md?plain=1" title="Folder: en-us/web/api/web_animations_api/using_the_web_animations_api (Opens in a new tab)" target="_blank" rel="noopener noreferrer">View the source on GitHub</a>.</li></ul>Want to get more involved?<!-- --> <a href="https://github.com/mdn/content/blob/main/CONTRIBUTING.md" title="This will take you to our contribution guidelines on GitHub." target="_blank" rel="noopener noreferrer">Learn how to contribute</a>.</div><p class="last-modified-date">This page was last modified on<!-- --> <time dateTime="2023-07-17T23:17:51.000Z">Jul 18, 2023</time> by<!-- --> <a href="/en-US/docs/Web/API/Web_Animations_API/Using_the_Web_Animations_API/contributors.txt">MDN contributors</a>.</p></div></aside></article></main></div></div><footer id="nav-footer" class="page-footer"><div class="page-footer-grid"><div class="page-footer-logo-col"><a href="/" class="mdn-footer-logo" aria-label="MDN homepage"><svg width="48" height="17" viewBox="0 0 48 17" fill="none" xmlns="http://www.w3.org/2000/svg"><title id="mdn-footer-logo-svg">MDN logo</title><path d="M20.04 16.512H15.504V10.416C15.504 9.488 15.344 8.824 15.024 8.424C14.72 8.024 14.264 7.824 13.656 7.824C12.92 7.824 12.384 8.064 12.048 8.544C11.728 9.024 11.568 9.64 11.568 10.392V14.184H13.008V16.512H8.472V10.416C8.472 9.488 8.312 8.824 7.992 8.424C7.688 8.024 7.232 7.824 6.624 7.824C5.872 7.824 5.336 8.064 5.016 8.544C4.696 9.024 4.536 9.64 4.536 10.392V14.184H6.6V16.512H0V14.184H1.44V8.04H0.024V5.688H4.536V7.32C5.224 6.088 6.32 5.472 7.824 5.472C8.608 5.472 9.328 5.664 9.984 6.048C10.64 6.432 11.096 7.016 11.352 7.8C11.992 6.248 13.168 5.472 14.88 5.472C15.856 5.472 16.72 5.776 17.472 6.384C18.224 6.992 18.6 7.936 18.6 9.216V14.184H20.04V16.512Z" fill="currentColor"></path><path d="M33.6714 16.512H29.1354V14.496C28.8314 15.12 28.3834 15.656 27.7914 16.104C27.1994 16.536 26.4154 16.752 25.4394 16.752C24.0154 16.752 22.8954 16.264 22.0794 15.288C21.2634 14.312 20.8554 12.984 20.8554 11.304C20.8554 9.688 21.2554 8.312 22.0554 7.176C22.8554 6.04 24.0634 5.472 25.6794 5.472C26.5594 5.472 27.2794 5.648 27.8394 6C28.3994 6.352 28.8314 6.8 29.1354 7.344V2.352H26.9754V0H32.2314V14.184H33.6714V16.512ZM29.1354 11.04V10.776C29.1354 9.88 28.8954 9.184 28.4154 8.688C27.9514 8.176 27.3674 7.92 26.6634 7.92C25.9754 7.92 25.3674 8.176 24.8394 8.688C24.3274 9.2 24.0714 10.008 24.0714 11.112C24.0714 12.152 24.3114 12.944 24.7914 13.488C25.2714 14.032 25.8394 14.304 26.4954 14.304C27.3114 14.304 27.9514 13.96 28.4154 13.272C28.8954 12.584 29.1354 11.84 29.1354 11.04Z" fill="currentColor"></path><path d="M47.9589 16.512H41.9829V14.184H43.4229V10.416C43.4229 9.488 43.2629 8.824 42.9429 8.424C42.6389 8.024 42.1829 7.824 41.5749 7.824C40.8389 7.824 40.2709 8.056 39.8709 8.52C39.4709 8.968 39.2629 9.56 39.2469 10.296V14.184H40.6869V16.512H34.7109V14.184H36.1509V8.04H34.5909V5.688H39.2469V7.344C39.9669 6.096 41.1269 5.472 42.7269 5.472C43.7509 5.472 44.6389 5.776 45.3909 6.384C46.1429 6.992 46.5189 7.936 46.5189 9.216V14.184H47.9589V16.512Z" fill="currentColor"></path></svg></a><p>Your blueprint for a better internet.</p><ul class="social-icons"><li><a class="icon icon-mastodon" href="https://mozilla.social/@mdn" target="_blank" rel="me noopener noreferrer"><span class="visually-hidden">MDN on Mastodon</span></a></li><li><a class="icon icon-twitter" href="https://twitter.com/mozdevnet" target="_blank" rel="noopener noreferrer"><span class="visually-hidden">MDN on Twitter</span></a></li><li><a class="icon icon-github-mark-small" href="https://github.com/mdn/" target="_blank" rel="noopener noreferrer"><span class="visually-hidden">MDN on GitHub</span></a></li><li><a class="icon icon-feed" href="/en-US/blog/rss.xml" target="_blank"><span class="visually-hidden">MDN Blog RSS Feed</span></a></li></ul></div><div class="page-footer-nav-col-1"><h2 class="footer-nav-heading">MDN</h2><ul class="footer-nav-list"><li class="footer-nav-item"><a href="/en-US/about">About</a></li><li class="footer-nav-item"><a href="/en-US/blog/">Blog</a></li><li class="footer-nav-item"><a href="https://www.mozilla.org/en-US/careers/listings/?team=ProdOps" target="_blank" rel="noopener noreferrer">Careers</a></li><li class="footer-nav-item"><a href="/en-US/advertising">Advertise with us</a></li></ul></div><div class="page-footer-nav-col-2"><h2 class="footer-nav-heading">Support</h2><ul class="footer-nav-list"><li class="footer-nav-item"><a class="footer-nav-link" href="/en-US/docs/MDN/Community/Issues">Report an issue</a></li></ul></div><div class="page-footer-nav-col-3"><h2 class="footer-nav-heading">Our communities</h2><ul class="footer-nav-list"><li class="footer-nav-item"><a class="footer-nav-link" href="/en-US/community">MDN Community</a></li><li class="footer-nav-item"><a class="footer-nav-link" href="https://discourse.mozilla.org/c/mdn/236" target="_blank" rel="noopener noreferrer">MDN Forum</a></li><li class="footer-nav-item"><a class="footer-nav-link" href="/discord" target="_blank" rel="noopener noreferrer">MDN Chat</a></li></ul></div><div class="page-footer-nav-col-4"><h2 class="footer-nav-heading">Developers</h2><ul class="footer-nav-list"><li class="footer-nav-item"><a class="footer-nav-link" href="/en-US/docs/Web">Web Technologies</a></li><li class="footer-nav-item"><a class="footer-nav-link" href="/en-US/docs/Learn">Learn Web Development</a></li><li class="footer-nav-item"><a href="https://hacks.mozilla.org/" target="_blank" rel="noopener noreferrer">Hacks Blog</a></li></ul></div><div class="page-footer-moz"><a href="https://www.mozilla.org/" class="footer-moz-logo-link" target="_blank" rel="noopener noreferrer"><svg width="112" height="32" fill="none" xmlns="http://www.w3.org/2000/svg"><title id="mozilla-footer-logo-svg">Mozilla logo</title><path d="M41.753 14.218c-2.048 0-3.324 1.522-3.324 4.157 0 2.423 1.119 4.286 3.29 4.286 2.082 0 3.447-1.678 3.447-4.347 0-2.826-1.522-4.096-3.413-4.096Zm54.89 7.044c0 .901.437 1.618 1.645 1.618 1.427 0 2.949-1.024 3.044-3.352-.649-.095-1.365-.185-2.02-.185-1.426-.005-2.668.397-2.668 1.92Z" fill="currentColor"></path><path d="M0 0v32h111.908V0H0Zm32.56 25.426h-5.87v-7.884c0-2.423-.806-3.352-2.39-3.352-1.924 0-2.702 1.365-2.702 3.324v4.868h1.864v3.044h-5.864v-7.884c0-2.423-.806-3.352-2.39-3.352-1.924 0-2.702 1.365-2.702 3.324v4.868h2.669v3.044H6.642v-3.044h1.863v-7.918H6.642V11.42h5.864v2.11c.839-1.489 2.3-2.39 4.252-2.39 2.02 0 3.878.963 4.566 3.01.778-1.862 2.361-3.01 4.566-3.01 2.512 0 4.812 1.522 4.812 4.84v6.402h1.863v3.044h-.005Zm9.036.307c-4.314 0-7.296-2.635-7.296-7.106 0-4.096 2.484-7.481 7.514-7.481s7.481 3.38 7.481 7.29c0 4.472-3.228 7.297-7.699 7.297Zm22.578-.307H51.942l-.403-2.11 7.7-8.846h-4.376l-.621 2.17-2.888-.313.498-4.907h12.294l.313 2.11-7.767 8.852h4.533l.654-2.172 3.167.308-.872 4.908Zm7.99 0h-4.191v-5.03h4.19v5.03Zm0-8.976h-4.191v-5.03h4.19v5.03Zm2.618 8.976 6.054-21.358h3.945l-6.054 21.358h-3.945Zm8.136 0 6.048-21.358h3.945l-6.054 21.358h-3.939Zm21.486.307c-1.863 0-2.887-1.085-3.072-2.792-.805 1.427-2.232 2.792-4.498 2.792-2.02 0-4.314-1.085-4.314-4.006 0-3.447 3.323-4.253 6.518-4.253.778 0 1.584.034 2.3.124v-.465c0-1.427-.034-3.133-2.3-3.133-.84 0-1.488.061-2.143.402l-.453 1.578-3.195-.34.549-3.224c2.45-.996 3.692-1.27 5.992-1.27 3.01 0 5.556 1.55 5.556 4.75v6.083c0 .805.314 1.085.963 1.085.184 0 .375-.034.587-.095l.034 2.11a5.432 5.432 0 0 1-2.524.654Z" fill="currentColor"></path></svg></a><ul class="footer-moz-list"><li class="footer-moz-item"><a href="https://www.mozilla.org/privacy/websites/" class="footer-moz-link" target="_blank" rel="noopener noreferrer">Website Privacy Notice</a></li><li class="footer-moz-item"><a href="https://www.mozilla.org/privacy/websites/#cookies" class="footer-moz-link" target="_blank" rel="noopener noreferrer">Cookies</a></li><li class="footer-moz-item"><a href="https://www.mozilla.org/about/legal/terms/mozilla" class="footer-moz-link" target="_blank" rel="noopener noreferrer">Legal</a></li><li class="footer-moz-item"><a href="https://www.mozilla.org/about/governance/policies/participation/" class="footer-moz-link" target="_blank" rel="noopener noreferrer">Community Participation Guidelines</a></li></ul></div><div class="page-footer-legal"><p id="license" class="page-footer-legal-text">Visit<!-- --> <a href="https://www.mozilla.org" target="_blank" rel="noopener noreferrer">Mozilla Corporation’s</a> <!-- -->not-for-profit parent, the<!-- --> <a target="_blank" rel="noopener noreferrer" href="https://foundation.mozilla.org/">Mozilla Foundation</a>.<br/>Portions of this content are ©1998–<!-- -->2023<!-- --> by individual mozilla.org contributors. Content available under<!-- --> <a href="/en-US/docs/MDN/Writing_guidelines/Attrib_copyright_license">a Creative Commons license</a>.</p></div></div></footer></div><script type="application/json" id="hydration">{"doc":{"isMarkdown":true,"isTranslated":false,"isActive":true,"flaws":{},"title":"Using the Web Animations API","mdn_url":"/en-US/docs/Web/API/Web_Animations_API/Using_the_Web_Animations_API","locale":"en-US","native":"English (US)","sidebarHTML":"<ol><li><strong><a href=\"/en-US/docs/Web/API/Web_Animations_API\">Web Animations API</a></strong></li><li class=\"toggle\"><details open=\"\"><summary>Guides</summary><ol><li><em><a href=\"/en-US/docs/Web/API/Web_Animations_API/Using_the_Web_Animations_API\" aria-current=\"page\">Using the Web Animations API</a></em></li><li><a href=\"/en-US/docs/Web/API/Web_Animations_API/Web_Animations_API_Concepts\">Web Animations API Concepts</a></li><li><a href=\"/en-US/docs/Web/API/Web_Animations_API/Keyframe_Formats\">Keyframe Formats</a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Interfaces</summary><ol><li><a href=\"/en-US/docs/Web/API/Animation\"><code>Animation</code></a></li><li><a href=\"/en-US/docs/Web/API/AnimationEffect\"><code>AnimationEffect</code></a></li><li><a href=\"/en-US/docs/Web/API/AnimationEvent\"><code>AnimationEvent</code></a></li><li><a href=\"/en-US/docs/Web/API/AnimationTimeline\"><code>AnimationTimeline</code></a></li><li><a href=\"/en-US/docs/Web/API/AnimationPlaybackEvent\"><code>AnimationPlaybackEvent</code></a></li><li><a href=\"/en-US/docs/Web/API/DocumentTimeline\"><code>DocumentTimeline</code></a></li><li><a href=\"/en-US/docs/Web/API/KeyframeEffect\"><code>KeyframeEffect</code></a></li><li><a href=\"/en-US/docs/Web/API/ScrollTimeline\"><code>ScrollTimeline</code></a></li><li><a href=\"/en-US/docs/Web/API/ViewTimeline\"><code>ViewTimeline</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Properties</summary><ol><li><a href=\"/en-US/docs/Web/API/Document/timeline\"><code>Document.timeline</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Methods</summary><ol><li><a href=\"/en-US/docs/Web/API/Document/getAnimations\"><code>Document.getAnimations()</code></a></li><li><a href=\"/en-US/docs/Web/API/Element/animate\"><code>Element.animate()</code></a></li><li><a href=\"/en-US/docs/Web/API/Element/getAnimations\"><code>Element.getAnimations()</code></a></li></ol></details></li></ol>","sidebarMacro":"DefaultAPISidebar","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p>The Web Animations API lets us construct animations and control their playback with JavaScript. This article will start you off in the right direction with fun demos and tutorials featuring Alice in Wonderland.</p>"}},{"type":"prose","value":{"id":"meet_the_web_animations_api","title":"Meet the Web Animations API","isH3":false,"content":"<p>The <a href=\"/en-US/docs/Web/API/Web_Animations_API\">Web Animations API</a> opens the browser's animation engine to developers and manipulation by JavaScript. This API was designed to underlie implementations of both <a href=\"/en-US/docs/Web/CSS/CSS_animations\">CSS Animations</a> and <a href=\"/en-US/docs/Web/CSS/CSS_transitions\">CSS Transitions</a>, and leaves the door open to future animation effects. It is one of the most performant ways to animate on the Web, letting the browser make its own internal optimizations without hacks, coercion, or <a href=\"/en-US/docs/Web/API/window/requestAnimationFrame\"><code>Window.requestAnimationFrame()</code></a>.</p>\n<p>With the Web Animations API, we can move interactive animations from stylesheets to JavaScript, separating presentation from behavior. We no longer need to rely on DOM-heavy techniques such as writing CSS properties and scoping classes onto elements to control playback direction. And unlike pure, declarative CSS, JavaScript also lets us dynamically set values from properties to durations. For building custom animation libraries and creating interactive animations, the Web Animations API might be the perfect tool for the job. Let's see what it can do!</p>"}},{"type":"prose","value":{"id":"writing_css_animations_with_the_web_animations_api","title":"Writing CSS Animations with the Web Animations API","isH3":false,"content":"<p>One of the more familiar ways to approach learning the Web Animations API is to start with something most web developers have played with before: CSS Animations. CSS Animations have a familiar syntax that breaks down nicely for demonstration purposes.</p>"}},{"type":"prose","value":{"id":"the_css_version","title":"The CSS version","isH3":true,"content":"<p>Here's a tumbling animation written in CSS showing Alice falling down the rabbit hole that leads to Wonderland (see the full <a href=\"https://codepen.io/rachelnabors/pen/QyOqqW\" class=\"external\" target=\"_blank\">code on Codepen</a>):</p>\n<p><a href=\"https://codepen.io/rachelnabors/pen/rxpmJL\" class=\"external\" target=\"_blank\"><img src=\"/en-US/docs/Web/API/Web_Animations_API/Using_the_Web_Animations_API/tumbling-alice_optimized.gif\" alt=\"Alice Tumbling down the rabbit's hole.\" width=\"700\" height=\"374\" loading=\"lazy\"></a></p>\n<p>Notice that the background moves, Alice spins, and her color changes at an offset from her spinning. We're going to focus on just Alice for this tutorial. Here's the simplified CSS that controls Alice's animation:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">css</span></p><pre class=\"brush: css notranslate\"><code><span class=\"token selector\">#alice</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">animation</span><span class=\"token punctuation\">:</span> aliceTumbling infinite 3s linear<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token atrule\"><span class=\"token rule\">@keyframes</span> aliceTumbling</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token selector\">0%</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> #000<span class=\"token punctuation\">;</span>\n    <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">rotate</span><span class=\"token punctuation\">(</span>0<span class=\"token punctuation\">)</span> <span class=\"token function\">translate3D</span><span class=\"token punctuation\">(</span>-50%<span class=\"token punctuation\">,</span> -50%<span class=\"token punctuation\">,</span> 0<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token selector\">30%</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> #431236<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token selector\">100%</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> #000<span class=\"token punctuation\">;</span>\n    <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">rotate</span><span class=\"token punctuation\">(</span>360deg<span class=\"token punctuation\">)</span> <span class=\"token function\">translate3D</span><span class=\"token punctuation\">(</span>-50%<span class=\"token punctuation\">,</span> -50%<span class=\"token punctuation\">,</span> 0<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>This changes Alice's color and her transform's rotation over 3 seconds at a constant (linear) rate and loops infinitely. In the <a href=\"/en-US/docs/Web/CSS/@keyframes\">@keyframes</a> block we can see that 30% of the way through each loop (about .9 seconds in), Alice's color changes from black to a deep burgundy then back again by the end of the loop.</p>"}},{"type":"prose","value":{"id":"moving_it_to_javascript","title":"Moving it to JavaScript","isH3":true,"content":"<p>Now let's try creating the same animation with the Web Animations API.</p>\n<h4 id=\"representing_keyframes\">Representing keyframes</h4>\n<p>The first thing we need is to create a <a href=\"/en-US/docs/Web/API/Web_Animations_API/Keyframe_Formats\">Keyframe Object</a> corresponding to our CSS <a href=\"/en-US/docs/Web/CSS/@keyframes\">@keyframes</a> block:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">const</span> aliceTumbling <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">transform</span><span class=\"token operator\">:</span> <span class=\"token string\">\"rotate(0) translate3D(-50%, -50%, 0)\"</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">color</span><span class=\"token operator\">:</span> <span class=\"token string\">\"#000\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">color</span><span class=\"token operator\">:</span> <span class=\"token string\">\"#431236\"</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">offset</span><span class=\"token operator\">:</span> <span class=\"token number\">0.3</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">transform</span><span class=\"token operator\">:</span> <span class=\"token string\">\"rotate(360deg) translate3D(-50%, -50%, 0)\"</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">color</span><span class=\"token operator\">:</span> <span class=\"token string\">\"#000\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Here we're using an array containing multiple objects. Each object represents a key from the original CSS. However, unlike CSS, the Web Animations API doesn't need to explicitly be told the percentages along the animation for each key to appear at. It will automatically divide the animation into equal parts based on the number of keys you give it. This means that a Keyframe object with three keys will play the middle key 50% of the way through each loop of the animation unless told otherwise.</p>\n<p>When we want to explicitly set a key's offset from the other keys, we can specify an offset directly in the object, separated from the declaration with a comma. In the above example, to make sure that Alice's color changes at 30% (not 50%) for the color change, we are giving it <code>offset: 0.3</code>.</p>\n<p>Currently, there should be at least two keyframes specified (representing the starting and ending states of the animation sequence). If your keyframe list has only one entry, <a href=\"/en-US/docs/Web/API/Element/animate\"><code>Element.animate()</code></a> may throw a <code>NotSupportedError</code> <a href=\"/en-US/docs/Web/API/DOMException\"><code>DOMException</code></a> in some browsers until they are updated.</p>\n<p>So to recap, the keys are equally spaced by default unless you specify an offset on a key. Handy, no?</p>\n<h4 id=\"representing_timing_properties\">Representing timing properties</h4>\n<p>We'll also need to create an object of timing properties corresponding to the values in Alice's animation:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">const</span> aliceTiming <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">duration</span><span class=\"token operator\">:</span> <span class=\"token number\">3000</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">iterations</span><span class=\"token operator\">:</span> <span class=\"token number\">Infinity</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>You'll notice a few differences here from how equivalent values are represented in CSS:</p>\n<ul>\n  <li>For one, the duration is in milliseconds as opposed to seconds — 3000 not 3s. Like <a href=\"/en-US/docs/Web/API/setTimeout\"><code>setTimeout()</code></a> and <a href=\"/en-US/docs/Web/API/window/requestAnimationFrame\"><code>Window.requestAnimationFrame()</code></a>, the Web Animations API only takes milliseconds.</li>\n  <li>The other thing you'll notice is that it's <code>iterations</code>, not <code>iteration-count</code>.</li>\n</ul>\n<div class=\"notecard note\" id=\"sect1\">\n  <p><strong>Note:</strong> There are a number of small differences between the terminology used in CSS Animations and the terminology used in Web Animations. For instance, Web Animations doesn't use the string <code>\"infinite\"</code>, but instead uses the JavaScript keyword <code>Infinity</code>. And instead of <code>timing-function</code> we use <code>easing</code>. We aren't listing an <code>easing</code> value here because, unlike CSS Animations where the default <a href=\"/en-US/docs/Web/CSS/animation-timing-function\">animation-timing-function</a> is <code>ease</code>, in the Web Animations API the default easing is <code>linear</code> — which is what we want here.</p>\n</div>\n<h4 id=\"bring_the_pieces_together\">Bring the pieces together</h4>\n<p>Now it's time to bring them both together with the <a href=\"/en-US/docs/Web/API/Element/animate\"><code>Element.animate()</code></a> method:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code>document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"alice\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">animate</span><span class=\"token punctuation\">(</span>aliceTumbling<span class=\"token punctuation\">,</span> aliceTiming<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>And boom: the animation starts playing (see the finished <a href=\"https://codepen.io/rachelnabors/pen/rxpmJL\" class=\"external\" target=\"_blank\">version on Codepen</a>).</p>\n<p>The <code>animate()</code> method can be called on any DOM element that could be animated with CSS. And it can be written in several ways. Instead of making objects for keyframes and timing properties, we could just pass their values in directly, like so:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code>document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"alice\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">animate</span><span class=\"token punctuation\">(</span>\n  <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">transform</span><span class=\"token operator\">:</span> <span class=\"token string\">\"rotate(0) translate3D(-50%, -50%, 0)\"</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">color</span><span class=\"token operator\">:</span> <span class=\"token string\">\"#000\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">color</span><span class=\"token operator\">:</span> <span class=\"token string\">\"#431236\"</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">offset</span><span class=\"token operator\">:</span> <span class=\"token number\">0.3</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">transform</span><span class=\"token operator\">:</span> <span class=\"token string\">\"rotate(360deg) translate3D(-50%, -50%, 0)\"</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">color</span><span class=\"token operator\">:</span> <span class=\"token string\">\"#000\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">duration</span><span class=\"token operator\">:</span> <span class=\"token number\">3000</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">iterations</span><span class=\"token operator\">:</span> <span class=\"token number\">Infinity</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>What's more, if we only wanted to specify the duration of the animation and not its iterations (by default, animations iterate once), we could pass in the milliseconds alone:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code>document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"alice\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">animate</span><span class=\"token punctuation\">(</span>\n  <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">transform</span><span class=\"token operator\">:</span> <span class=\"token string\">\"rotate(0) translate3D(-50%, -50%, 0)\"</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">color</span><span class=\"token operator\">:</span> <span class=\"token string\">\"#000\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">color</span><span class=\"token operator\">:</span> <span class=\"token string\">\"#431236\"</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">offset</span><span class=\"token operator\">:</span> <span class=\"token number\">0.3</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">transform</span><span class=\"token operator\">:</span> <span class=\"token string\">\"rotate(360deg) translate3D(-50%, -50%, 0)\"</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">color</span><span class=\"token operator\">:</span> <span class=\"token string\">\"#000\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token number\">3000</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"controlling_playback_with_play_pause_reverse_and_updateplaybackrate","title":"Controlling playback with play(), pause(), reverse(), and updatePlaybackRate()","isH3":false,"content":"<p>While we can write CSS Animations with the Web Animations API, where the API really comes in handy is manipulating the animation's playback. The Web Animations API provides several useful methods for controlling playback. Let's take a look at pausing and playing animations in the Growing/Shrinking Alice game (check out the <a href=\"https://codepen.io/rachelnabors/pen/PNYGZQ\" class=\"external\" target=\"_blank\">full code on Codepen</a>):</p>\n<p><a href=\"https://codepen.io/rachelnabors/pen/PNYGZQ?editors=0010\" class=\"external\" target=\"_blank\"><img src=\"/en-US/docs/Web/API/Web_Animations_API/Using_the_Web_Animations_API/growing-shrinking_article_optimized.gif\" alt=\"Playing the growing and shrinking game with Alice.\" width=\"700\" height=\"374\" loading=\"lazy\"></a></p>\n<p>In this game, Alice has an animation that causes her to go from small to big which we control via a bottle and a cupcake. Both of these have their own animations.</p>"}},{"type":"prose","value":{"id":"pausing_and_playing_animations","title":"Pausing and playing animations","isH3":true,"content":"<p>We'll talk more about Alice's animation later, but for now, let's look closer at the cupcake's animation:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">const</span> nommingCake <span class=\"token operator\">=</span> document\n  <span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"eat-me_sprite\"</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">animate</span><span class=\"token punctuation\">(</span>\n    <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">transform</span><span class=\"token operator\">:</span> <span class=\"token string\">\"translateY(0)\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">transform</span><span class=\"token operator\">:</span> <span class=\"token string\">\"translateY(-80%)\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">fill</span><span class=\"token operator\">:</span> <span class=\"token string\">\"forwards\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">easing</span><span class=\"token operator\">:</span> <span class=\"token string\">\"steps(4, end)\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">duration</span><span class=\"token operator\">:</span> aliceChange<span class=\"token punctuation\">.</span>effect<span class=\"token punctuation\">.</span><span class=\"token function\">getComputedTiming</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>duration <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>The <a href=\"/en-US/docs/Web/API/Element/animate\"><code>Element.animate()</code></a> method will immediately run after it is called. To prevent the cake from eating itself up before the user has had the chance to click on it, we call <a href=\"/en-US/docs/Web/API/Animation/pause\"><code>Animation.pause()</code></a> on it immediately after it is defined, like so:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code>nommingCake<span class=\"token punctuation\">.</span><span class=\"token function\">pause</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>We can now use the <a href=\"/en-US/docs/Web/API/Animation/play\"><code>Animation.play()</code></a> method to run it whenever we're ready:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code>nommingCake<span class=\"token punctuation\">.</span><span class=\"token function\">play</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Specifically, we want to link it to Alice's animation, so she gets bigger as the cupcake gets eaten. We can achieve this via the following function:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">growAlice</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Play Alice's animation.</span>\n  aliceChange<span class=\"token punctuation\">.</span><span class=\"token function\">play</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Play the cake's animation.</span>\n  nommingCake<span class=\"token punctuation\">.</span><span class=\"token function\">play</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>When a user holds their mouse down or presses their finger on the cake on a touch screen, we can now call <code>growAlice</code> to make all the animations play:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code>cake<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"mousedown\"</span><span class=\"token punctuation\">,</span> growAlice<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ncake<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"touchstart\"</span><span class=\"token punctuation\">,</span> growAlice<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"other_useful_methods","title":"Other useful methods","isH3":true,"content":"<p>In addition to pausing and playing, we can use the following Animation methods:</p>\n<ul>\n  <li><a href=\"/en-US/docs/Web/API/Animation/finish\"><code>Animation.finish()</code></a> skips to the end of the animation.</li>\n  <li><a href=\"/en-US/docs/Web/API/Animation/cancel\"><code>Animation.cancel()</code></a> aborts the animation and removes its effects.</li>\n  <li><a href=\"/en-US/docs/Web/API/Animation/reverse\"><code>Animation.reverse()</code></a> sets the animation's playback rate (<a href=\"/en-US/docs/Web/API/Animation/playbackRate\"><code>Animation.playbackRate</code></a>) to a negative value so it runs backward.</li>\n</ul>\n<p>Let's take a look at <code>playbackRate</code> first — a negative playbackRate will cause an animation to run in reverse. When Alice drinks from the bottle, she grows smaller. This is because the bottle changes her animation's playbackRate from 1 to -1:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">shrinkAlice</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  aliceChange<span class=\"token punctuation\">.</span>playbackRate <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n  aliceChange<span class=\"token punctuation\">.</span><span class=\"token function\">play</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\nbottle<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"mousedown\"</span><span class=\"token punctuation\">,</span> shrinkAlice<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nbottle<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"touchstart\"</span><span class=\"token punctuation\">,</span> shrinkAlice<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>In <a href=\"https://en.wikipedia.org/wiki/Through_the_Looking-Glass\" class=\"external\" target=\"_blank\">Through the Looking-Glass</a>, Alice travels to a world where she must run to stay in place — and run twice as fast to move forward! In the Red Queen's Race example, Alice and the Red Queen are running to stay in place (check out the <a href=\"https://codepen.io/rachelnabors/pen/PNGGaV\" class=\"external\" target=\"_blank\">full code on Codepen</a>):</p>\n<p><a href=\"https://codepen.io/rachelnabors/pen/PNGGaV\" class=\"external\" target=\"_blank\"><img src=\"/en-US/docs/Web/API/Web_Animations_API/Using_the_Web_Animations_API/red-queen-race_optimized.gif\" alt=\"Alice and the Red Queen race to get to the next square in this game.\" width=\"640\" height=\"342\" loading=\"lazy\"></a></p>\n<p>Because small children tire out easily, unlike automaton chess pieces, Alice is constantly slowing down. We can do this by setting a decay on her animation's <code>playbackRate</code>. We use <code>updatePlaybackRate()</code> instead of setting the playbackRate directly since that produces a smooth update:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Make sure the playback rate never falls below .4</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>redQueen_alice<span class=\"token punctuation\">.</span>playbackRate <span class=\"token operator\">&gt;</span> <span class=\"token number\">0.4</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    redQueen_alice<span class=\"token punctuation\">.</span><span class=\"token function\">updatePlaybackRate</span><span class=\"token punctuation\">(</span>redQueen_alice<span class=\"token punctuation\">.</span>playbackRate <span class=\"token operator\">*</span> <span class=\"token number\">0.9</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>But urging them on by clicking or tapping causes them to speed up by multiplying their playbackRate:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">goFaster</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  redQueen_alice<span class=\"token punctuation\">.</span><span class=\"token function\">updatePlaybackRate</span><span class=\"token punctuation\">(</span>redQueen_alice<span class=\"token punctuation\">.</span>playbackRate <span class=\"token operator\">*</span> <span class=\"token number\">1.1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\ndocument<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> goFaster<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ndocument<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"touchstart\"</span><span class=\"token punctuation\">,</span> goFaster<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>The background elements also have <code>playbackRate</code>s that are impacted when you click or tap. What happens when you make Alice and the Red Queen run twice as fast? What happens when you let them slow down?</p>"}},{"type":"prose","value":{"id":"persisting_animation_styles","title":"Persisting animation styles","isH3":false,"content":"<p>When animating elements, a common use case is to persist the final state of the animation, after the animation has finished. One method sometimes used for this is to set the animation's <a href=\"/en-US/docs/Web/API/KeyframeEffect/KeyframeEffect#fill\">fill mode</a> to <code>forwards</code>. However, it is not recommended to use fill modes to persist the effect of an animation indefinitely, for two reasons:</p>\n<ul>\n  <li>The browser has to maintain the state of the animation while it is still active, so the animation continues to consume resources even though it is no longer animating. Note that this is somewhat alleviated by the browser <a href=\"#automatically_removing_filling_animations\">automatically removing filling animations</a>.</li>\n  <li>Styles applied by animations have a <a href=\"/en-US/docs/Web/CSS/Cascade#cascading_order\">higher precedence in the cascade</a> than specified styles, so it can be difficult to override them when needed.</li>\n</ul>\n<p>A better approach is to use the <a href=\"/en-US/docs/Web/API/Animation/commitStyles\"><code>Animation.commitStyles()</code></a> method. This writes the computed values of the animation's current styles into its target element's <a href=\"/en-US/docs/Web/HTML/Global_attributes#style\"><code>style</code></a> attribute, after which the element can be restyled normally.</p>"}},{"type":"prose","value":{"id":"automatically_removing_filling_animations","title":"Automatically removing filling animations","isH3":false,"content":"<p>It is possible to trigger a large number of animations on the same element. If they are indefinite (i.e., forwards-filling), this can result in a huge animations list, which could create a memory leak. For this reason, browsers automatically remove filling animations after they are replaced by newer animations, unless the developer explicitly specifies to keep them.</p>\n<p>Animations are removed when all of the following are true:</p>\n<ul>\n  <li>The animation is filling (its <code>fill</code> is <code>forwards</code> if it is playing forwards, <code>backwards</code> if it is playing backwards, or <code>both</code>).</li>\n  <li>The animation is finished. (Note that because of the <code>fill</code> it will still be in effect.)</li>\n  <li>The animation's timeline is monotonically increasing. (This is always true for <a href=\"/en-US/docs/Web/API/DocumentTimeline\"><code>DocumentTimeline</code></a>; other timelines such as <a href=\"/en-US/docs/Web/CSS/scroll-timeline\"><code>scroll-timeline</code></a> can run backwards.)</li>\n  <li>The animation is not being controlled by declarative markup such as CSS.</li>\n  <li>Every styling effect of the animation's <a href=\"/en-US/docs/Web/API/AnimationEffect\"><code>AnimationEffect</code></a> is being overridden by another animation that also satisfies all the conditions above. (Typically, when two animations would set the same style property of the same element, the one created last overrides the other.)</li>\n</ul>\n<p>The first four conditions ensure that, without intervention by JavaScript code, the animation's effect will never change or end. The last condition ensures that the animation will never actually affect the style of any element: it has been entirely replaced.</p>\n<p>When the animation is automatically removed, the animation's <a href=\"/en-US/docs/Web/API/Animation/remove_event\" title=\"remove\"><code>remove</code></a> event fires.</p>\n<p>To prevent the browser from automatically removing animations, call the animation's <a href=\"/en-US/docs/Web/API/Animation/persist\" title=\"persist()\"><code>persist()</code></a> method.</p>\n<p>The animation's <a href=\"/en-US/docs/Web/API/Animation/replaceState\"><code>animation.replaceState</code></a> property will be <code>removed</code> if the animation has been removed, <code>persisted</code> if you have called <a href=\"/en-US/docs/Web/API/Animation/persist\" title=\"persist()\"><code>persist()</code></a> on the animation, or <code>active</code> otherwise.</p>"}},{"type":"prose","value":{"id":"getting_information_out_of_animations","title":"Getting information out of animations","isH3":false,"content":"<p>Imagine other ways we could use playbackRate, such as improving accessibility for users with vestibular disorders by letting them slow down animations across an entire site. That's impossible to do with CSS without recalculating durations in every CSS rule, but with the Web Animations API, we could use the <a href=\"/en-US/docs/Web/API/Document/getAnimations\"><code>Document.getAnimations</code></a> method to loop over each animation on the page and halve their <code>playbackRate</code>s, like so:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code>document<span class=\"token punctuation\">.</span><span class=\"token function\">getAnimations</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">animation</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  animation<span class=\"token punctuation\">.</span><span class=\"token function\">updatePlaybackRate</span><span class=\"token punctuation\">(</span>animation<span class=\"token punctuation\">.</span>playbackRate <span class=\"token operator\">*</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>With the Web Animations API, all you need to change is just one little property!</p>\n<p>Another thing that's tough to do with CSS Animations alone is creating dependencies on values provided by other animations. For instance, in the Growing and Shrinking Alice game example, you might have noticed something odd about the cake's duration:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code>document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"eat-me_sprite\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">animate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">duration</span><span class=\"token operator\">:</span> aliceChange<span class=\"token punctuation\">.</span>effect<span class=\"token punctuation\">.</span>timing<span class=\"token punctuation\">.</span>duration <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>To understand what's happening here, let's take a look at Alice's animation:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">const</span> aliceChange <span class=\"token operator\">=</span> document\n  <span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"alice\"</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">animate</span><span class=\"token punctuation\">(</span>\n    <span class=\"token punctuation\">[</span>\n      <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">transform</span><span class=\"token operator\">:</span> <span class=\"token string\">\"translate(-50%, -50%) scale(.5)\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">transform</span><span class=\"token operator\">:</span> <span class=\"token string\">\"translate(-50%, -50%) scale(2)\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">duration</span><span class=\"token operator\">:</span> <span class=\"token number\">8000</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">easing</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ease-in-out\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">fill</span><span class=\"token operator\">:</span> <span class=\"token string\">\"both\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Alice's animation has her going from half her size to twice her size over 8 seconds. Then we pause her:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code>aliceChange<span class=\"token punctuation\">.</span><span class=\"token function\">pause</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>If we had left her paused at the beginning of her animation, she'd start at half her full size, as if she'd drunk the entire bottle already! We want to set her animation's \"playhead\" in the middle, so she's already halfway done. We could do that by setting her <a href=\"/en-US/docs/Web/API/Animation/currentTime\"><code>Animation.currentTime</code></a> to 4 seconds, like so:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code>aliceChange<span class=\"token punctuation\">.</span>currentTime <span class=\"token operator\">=</span> <span class=\"token number\">4000</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>But while working on this animation, we might change Alice's duration a lot. Wouldn't it be better if we set her <code>currentTime</code> dynamically, so we don't have to make two updates at a time? We can, in fact, do so by referencing aliceChange's <a href=\"/en-US/docs/Web/API/Animation/effect\"><code>Animation.effect</code></a> property, which returns an object containing all the details of the effect(s) active on Alice:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code>aliceChange<span class=\"token punctuation\">.</span>currentTime <span class=\"token operator\">=</span> aliceChange<span class=\"token punctuation\">.</span>effect<span class=\"token punctuation\">.</span><span class=\"token function\">getComputedTiming</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>duration <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p><code>effect</code> lets us access the animation's keyframes and timing properties — <code>aliceChange.effect.getComputedTiming()</code> points to Alice's timing object — this contains her <a href=\"/en-US/docs/Web/API/KeyframeEffect/KeyframeEffect\"><code>duration</code></a>. We can divide her duration in half to get the midpoint for her animation's timeline, setting her to be normal height. Now we can reverse and play her animation in either direction to make her grow smaller or larger!</p>\n<p>And we can do the same thing when setting the cake and bottle durations:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">const</span> drinking <span class=\"token operator\">=</span> document\n  <span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"liquid\"</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">animate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">height</span><span class=\"token operator\">:</span> <span class=\"token string\">\"100%\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">height</span><span class=\"token operator\">:</span> <span class=\"token string\">\"0\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">fill</span><span class=\"token operator\">:</span> <span class=\"token string\">\"forwards\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">duration</span><span class=\"token operator\">:</span> aliceChange<span class=\"token punctuation\">.</span>effect<span class=\"token punctuation\">.</span><span class=\"token function\">getComputedTiming</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>duration <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ndrinking<span class=\"token punctuation\">.</span><span class=\"token function\">pause</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Now all three animations are linked to just one duration, which we can change easily from one place.</p>\n<p>We can also use the Web Animations API to figure out the animation's current time. The game ends when you run out of cake to eat or empty the bottle. Which vignette players are presented with depends on how far along Alice was in her animation, whether she grew too big and can't get in the tiny door anymore or too small and cannot reach the key to open the door. We can figure out whether she's on the large end or small end of her animation by getting her animation's <a href=\"/en-US/docs/Web/API/Animation/currentTime\"><code>currentTime</code></a> and dividing it by her <code>activeDuration</code>:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">endGame</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// get Alice's timeline's playhead location</span>\n  <span class=\"token keyword\">const</span> alicePlayhead <span class=\"token operator\">=</span> aliceChange<span class=\"token punctuation\">.</span>currentTime<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> aliceTimeline <span class=\"token operator\">=</span> aliceChange<span class=\"token punctuation\">.</span>effect<span class=\"token punctuation\">.</span><span class=\"token function\">getComputedTiming</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>activeDuration<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// stops Alice's and other animations</span>\n  <span class=\"token function\">stopPlayingAlice</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// depending on which third it falls into</span>\n  <span class=\"token keyword\">const</span> aliceHeight <span class=\"token operator\">=</span> alicePlayhead <span class=\"token operator\">/</span> aliceTimeline<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>aliceHeight <span class=\"token operator\">&lt;=</span> <span class=\"token number\">0.333</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Alice got smaller!</span>\n    <span class=\"token comment\">// …</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>aliceHeight <span class=\"token operator\">&gt;=</span> <span class=\"token number\">0.666</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Alice got bigger!</span>\n    <span class=\"token comment\">// …</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Alice didn't change significantly</span>\n    <span class=\"token comment\">// …</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<div class=\"notecard note\" id=\"sect2\">\n  <p><strong>Note:</strong> <code>getAnimations()</code> and <code>effect</code> are not shipping in all browsers as of this writing, but the polyfill does support them today.</p>\n</div>"}},{"type":"prose","value":{"id":"callbacks_and_promises","title":"Callbacks and promises","isH3":false,"content":"<p>CSS Animations and Transitions have their own event listeners, and these are also possible with the Web Animations API:</p>\n<ul>\n  <li><a href=\"/en-US/docs/Web/API/Animation/finish_event\"><code>onfinish</code></a> is the event handler for the <code>finish</code> event and can be triggered manually with <a href=\"/en-US/docs/Web/API/Animation/finish\"><code>finish()</code></a>.</li>\n  <li><a href=\"/en-US/docs/Web/API/Animation/cancel_event\"><code>oncancel</code></a> is the event handler for the <code>cancel</code> event and can be triggers with <a href=\"/en-US/docs/Web/API/Animation/cancel\"><code>cancel()</code></a>.</li>\n</ul>\n<p>Here we set the callbacks for the cake, bottle, and Alice to fire the <code>endGame</code> function:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// When the cake or bottle runs out</span>\nnommingCake<span class=\"token punctuation\">.</span>onfinish <span class=\"token operator\">=</span> endGame<span class=\"token punctuation\">;</span>\ndrinking<span class=\"token punctuation\">.</span>onfinish <span class=\"token operator\">=</span> endGame<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Alice reaches the end of her animation</span>\naliceChange<span class=\"token punctuation\">.</span>onfinish <span class=\"token operator\">=</span> endGame<span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Better still, the Web Animations API also provides a <a href=\"/en-US/docs/Web/API/Animation/finished\"><code>finished</code></a> promise that will resolve when the animation finishes, or reject if it is canceled.</p>"}},{"type":"prose","value":{"id":"conclusion","title":"Conclusion","isH3":false,"content":"<p>These are the basic features of the Web Animations API. By now you should be ready to \"jump down the rabbit hole\" of animating in the browser and ready to write your own animation experiments!</p>"}},{"type":"prose","value":{"id":"see_also","title":"See also","isH3":false,"content":"<ul>\n  <li>The <a href=\"https://codepen.io/collection/nqNJvD\" class=\"external\" target=\"_blank\">full suite of Alice in Wonderland demos</a> on CodePen for you to play with, fork, and share.</li>\n  <li><a href=\"https://hacks.mozilla.org/2016/08/animating-like-you-just-dont-care-with-element-animate/\" class=\"external\" target=\"_blank\">Animating like you just don't care with Element.animate</a> (2016) Explains the background of the Web Animations API and why it is more performant than other web animation methods.</li>\n</ul>"}}],"toc":[{"text":"Meet the Web Animations API","id":"meet_the_web_animations_api"},{"text":"Writing CSS Animations with the Web Animations API","id":"writing_css_animations_with_the_web_animations_api"},{"text":"Controlling playback with play(), pause(), reverse(), and updatePlaybackRate()","id":"controlling_playback_with_play_pause_reverse_and_updateplaybackrate"},{"text":"Persisting animation styles","id":"persisting_animation_styles"},{"text":"Automatically removing filling animations","id":"automatically_removing_filling_animations"},{"text":"Getting information out of animations","id":"getting_information_out_of_animations"},{"text":"Callbacks and promises","id":"callbacks_and_promises"},{"text":"Conclusion","id":"conclusion"},{"text":"See also","id":"see_also"}],"summary":"The Web Animations API lets us construct animations and control their playback with JavaScript. This article will start you off in the right direction with fun demos and tutorials featuring Alice in Wonderland.","popularity":0.0117,"modified":"2023-07-17T23:17:51.000Z","source":{"folder":"en-us/web/api/web_animations_api/using_the_web_animations_api","github_url":"https://github.com/mdn/content/blob/main/files/en-us/web/api/web_animations_api/using_the_web_animations_api/index.md","last_commit_url":"https://github.com/mdn/content/commit/76717f752447b6eef25bf29c12272e407ee5cb6b","filename":"index.md"},"short_title":"Using the Web Animations API","parents":[{"uri":"/en-US/docs/Web","title":"References"},{"uri":"/en-US/docs/Web/API","title":"Web APIs"},{"uri":"/en-US/docs/Web/API/Web_Animations_API","title":"Web Animations API"},{"uri":"/en-US/docs/Web/API/Web_Animations_API/Using_the_Web_Animations_API","title":"Using the Web Animations API"}],"pageTitle":"Using the Web Animations API - Web APIs | MDN","noIndexing":false}}</script></body></html>