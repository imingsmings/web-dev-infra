{"doc":{"isMarkdown":true,"isTranslated":false,"isActive":true,"flaws":{},"title":"IdentityProvider: getUserInfo() static method","mdn_url":"/en-US/docs/Web/API/IdentityProvider/getUserInfo_static","locale":"en-US","native":"English (US)","browserCompat":["api.IdentityProvider.getUserInfo_static"],"sidebarHTML":"<ol><li><strong><a href=\"/en-US/docs/Web/API/FedCM_API\">FedCM API</a></strong></li><li><strong><a href=\"/en-US/docs/Web/API/IdentityProvider\"><code>IdentityProvider</code></a></strong></li><li class=\"toggle\"><details open=\"\"><summary>Static methods</summary><ol><li><em><code>getUserInfo()</code> <abbr class=\"icon icon-experimental\" title=\"Experimental. Expect behavior to change in the future.\">\n    <span class=\"visually-hidden\">Experimental</span>\n</abbr></em></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Related pages for FedCM API</summary><ol><li><a href=\"/en-US/docs/Web/API/CredentialsContainer/get\"><code>CredentialsContainer.get()</code></a></li><li><a href=\"/en-US/docs/Web/API/IdentityCredential\"><code>IdentityCredential</code></a></li></ol></details></li></ol>","sidebarMacro":"APIRef","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<div class=\"notecard experimental\" id=\"sect1\"><p><strong>Experimental:</strong> <strong>This is an <a href=\"/en-US/docs/MDN/Writing_guidelines/Experimental_deprecated_obsolete#experimental\">experimental technology</a></strong><br>Check the <a href=\"#browser_compatibility\">Browser compatibility table</a> carefully before using this in production.</p></div>\n<p>The <strong><code>getUserInfo()</code></strong> static method of the <a href=\"/en-US/docs/Web/API/IdentityProvider\"><code>IdentityProvider</code></a> interface returns information about a previously signed in user, which can be used to provide a personalized welcome message and sign-in button. This method has to be called from within an identity provider (IdP)-origin <a href=\"/en-US/docs/Web/HTML/Element/iframe\"><code>&lt;iframe&gt;</code></a> so that RP scripts cannot access the data. This must occur after a previously signed in user returns to the relying party (RP) site.</p>\n<p>This pattern is already common on sites that use identity federation for sign-in, but <code>getUserInfo()</code> provides a way to achieve it without relying on third-party cookies.</p>"}},{"type":"prose","value":{"id":"usage_notes","title":"Usage notes","isH3":false,"content":"<p>When <code>getUserInfo()</code> is called, the browser will make a request to the IdP <a href=\"/en-US/docs/Web/API/FedCM_API#the_accounts_list_endpoint\">accounts list endpoint</a> for the user information only when both the below conditions are true:</p>\n<ul>\n  <li>The user has previously signed in to the RP with the IdP via FedCM on the same browser instance, and the data hasn't been cleared.</li>\n  <li>The user is signed in to the IdP on the same browser instance.</li>\n</ul>\n<p><code>getUserInfo()</code> must be called from within an embedded <code>&lt;iframe&gt;</code>, and the embedded site's origin must match the <code>configURL</code> of the IdP. In addition, the embedding HTML must explicitly allow its use via the <a href=\"/en-US/docs/Web/HTTP/Headers/Permissions-Policy/identity-credentials-get\"><code>identity-credentials-get</code></a> <a href=\"/en-US/docs/Web/HTTP/Permissions_Policy\">Permissions-Policy</a>:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">html</span></p><pre class=\"brush: html notranslate\"><code><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>iframe</span>\n  <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://idp.example/signin<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">allow</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>identity-credentials-get<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>iframe</span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"syntax","title":"Syntax","isH3":false,"content":"<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code>IdentityProvider<span class=\"token punctuation\">.</span><span class=\"token function\">getUserInfo</span><span class=\"token punctuation\">(</span>config<span class=\"token punctuation\">)</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"parameters","title":"Parameters","isH3":true,"content":"<dl>\n  <dt id=\"config\"><a href=\"#config\"><code>config</code></a></dt>\n  <dd>\n    <p>A configuration object, which can contain the following properties:</p>\n    <dl>\n      <dt id=\"configurl\"><a href=\"#configurl\"><code>configURL</code></a></dt>\n      <dd>\n        <p>The URL of the <a href=\"/en-US/docs/Web/API/FedCM_API#provide_a_config_file\">configuration file</a> for the identity provider from which you want to get user information.</p>\n      </dd>\n      <dt id=\"clientid\"><a href=\"#clientid\"><code>clientId</code></a></dt>\n      <dd>\n        <p>The RP's client identifier issued by the IdP.</p>\n      </dd>\n    </dl>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"return_value","title":"Return value","isH3":true,"content":"<p>A <a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise\"><code>Promise</code></a> that fulfills with an array of objects, each containing information representing a separate user account. Each object contains the following properties:</p>\n<dl>\n  <dt id=\"email\"><a href=\"#email\"><code>email</code></a></dt>\n  <dd>\n    <p>A string representing the user's email address.</p>\n  </dd>\n  <dt id=\"name\"><a href=\"#name\"><code>name</code></a></dt>\n  <dd>\n    <p>A string representing the user's full name.</p>\n  </dd>\n  <dt id=\"givenname\"><a href=\"#givenname\"><code>givenName</code></a></dt>\n  <dd>\n    <p>A string representing the user's given (nick or abbreviated) name.</p>\n  </dd>\n  <dt id=\"picture\"><a href=\"#picture\"><code>picture</code></a></dt>\n  <dd>\n    <p>A string representing the URL of the user's profile picture.</p>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"exceptions","title":"Exceptions","isH3":true,"content":"<dl>\n  <dt id=\"invalidstateerror\"><a href=\"#invalidstateerror\"><code>InvalidStateError</code></a> <a href=\"/en-US/docs/Web/API/DOMException\"><code>DOMException</code></a></dt>\n  <dd>\n    <p>Thrown if the provided <code>configURL</code> is invalid or if the embedded document's origin does not match the <code>configURL</code>.</p>\n  </dd>\n  <dt id=\"networkerror\"><a href=\"#networkerror\"><code>NetworkError</code></a> <a href=\"/en-US/docs/Web/API/DOMException\"><code>DOMException</code></a></dt>\n  <dd>\n    <p>Thrown if the browser is unable to connect to the IdP or if <code>getUserInfo()</code> is invoked from the top-level document.</p>\n  </dd>\n  <dt id=\"notallowederror\"><a href=\"#notallowederror\"><code>NotAllowedError</code></a> <a href=\"/en-US/docs/Web/API/DOMException\"><code>DOMException</code></a></dt>\n  <dd>\n    <p>Thrown if the embedding <code>&lt;iframe&gt;</code> does not have a <a href=\"/en-US/docs/Web/HTTP/Headers/Permissions-Policy/identity-credentials-get\"><code>identity-credentials-get</code></a> <a href=\"/en-US/docs/Web/HTTP/Permissions_Policy\">Permissions-Policy</a> set to allow the use of <code>getUserInfo()</code> or if the FedCM API is disabled globally by a policy set on the top-level document.</p>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"examples","title":"Examples","isH3":false,"content":"<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// Iframe displaying a page from the https://idp.example origin</span>\n<span class=\"token keyword\">const</span> user_info <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> IdentityProvider<span class=\"token punctuation\">.</span><span class=\"token function\">getUserInfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">configUrl</span><span class=\"token operator\">:</span> <span class=\"token string\">\"https://idp.example/fedcm.json\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">clientId</span><span class=\"token operator\">:</span> <span class=\"token string\">\"client1234\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// IdentityProvider.getUserInfo() returns an array of user information.</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>user_info<span class=\"token punctuation\">.</span>length <span class=\"token operator\">&gt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Returning accounts should be first, so the first account received</span>\n  <span class=\"token comment\">// is guaranteed to be a returning account</span>\n  <span class=\"token keyword\">const</span> name <span class=\"token operator\">=</span> user_info<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> given_name <span class=\"token operator\">=</span> user_info<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>given_name<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> display_name <span class=\"token operator\">=</span> given_name <span class=\"token operator\">?</span> given_name <span class=\"token operator\">:</span> name<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> picture <span class=\"token operator\">=</span> user_info<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>picture<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> email <span class=\"token operator\">=</span> user_info<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>email<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// ...</span>\n\n  <span class=\"token comment\">// Render the personalized sign-in button using the information above</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>"}},{"type":"specifications","value":{"title":"Specifications","id":"specifications","isH3":false,"specifications":[{"bcdSpecificationURL":"https://fedidcg.github.io/FedCM/#dom-identityprovider-getuserinfo","title":"Federated Credential Management API"}],"query":"api.IdentityProvider.getUserInfo_static"}},{"type":"browser_compatibility","value":{"title":"Browser compatibility","id":"browser_compatibility","isH3":false,"query":"api.IdentityProvider.getUserInfo_static"}},{"type":"prose","value":{"id":"see_also","title":"See also","isH3":false,"content":"<ul>\n  <li><a href=\"https://developer.chrome.com/docs/privacy-sandbox/fedcm/\" class=\"external\" target=\"_blank\">Federated Credential Management API</a> on developer.chrome.com (2023)</li>\n</ul>"}}],"toc":[{"text":"Usage notes","id":"usage_notes"},{"text":"Syntax","id":"syntax"},{"text":"Examples","id":"examples"},{"text":"Specifications","id":"specifications"},{"text":"Browser compatibility","id":"browser_compatibility"},{"text":"See also","id":"see_also"}],"summary":"The getUserInfo() static method of the IdentityProvider interface returns information about a previously signed in user, which can be used to provide a personalized welcome message and sign-in button. This method has to be called from within an identity provider (IdP)-origin <iframe> so that RP scripts cannot access the data. This must occur after a previously signed in user returns to the relying party (RP) site.","popularity":0,"modified":"2023-11-16T06:09:15.000Z","source":{"folder":"en-us/web/api/identityprovider/getuserinfo_static","github_url":"https://github.com/mdn/content/blob/main/files/en-us/web/api/identityprovider/getuserinfo_static/index.md","last_commit_url":"https://github.com/mdn/content/commit/388135bbfb0c1f852a17f52a6bfe6e85c8dc1abc","filename":"index.md"},"short_title":"getUserInfo()","parents":[{"uri":"/en-US/docs/Web","title":"References"},{"uri":"/en-US/docs/Web/API","title":"Web APIs"},{"uri":"/en-US/docs/Web/API/IdentityProvider","title":"IdentityProvider"},{"uri":"/en-US/docs/Web/API/IdentityProvider/getUserInfo_static","title":"getUserInfo()"}],"pageTitle":"IdentityProvider: getUserInfo() static method - Web APIs | MDN","noIndexing":false}}