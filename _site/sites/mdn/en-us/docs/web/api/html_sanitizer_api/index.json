{"doc":{"isMarkdown":true,"isTranslated":false,"isActive":true,"flaws":{},"title":"HTML Sanitizer API","mdn_url":"/en-US/docs/Web/API/HTML_Sanitizer_API","locale":"en-US","native":"English (US)","browserCompat":["api.Sanitizer"],"sidebarHTML":"<ol><li><strong><em><a href=\"/en-US/docs/Web/API/HTML_Sanitizer_API\" aria-current=\"page\">HTML Sanitizer API</a></em></strong></li><li class=\"toggle\"><details open=\"\"><summary>Interfaces</summary><ol><li><a href=\"/en-US/docs/Web/API/Sanitizer\"><code>Sanitizer</code></a></li></ol></details></li></ol>","sidebarMacro":"DefaultAPISidebar","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<div class=\"notecard experimental\" id=\"sect1\"><p><strong>Experimental:</strong> <strong>This is an <a href=\"/en-US/docs/MDN/Writing_guidelines/Experimental_deprecated_obsolete#experimental\">experimental technology</a></strong><br>Check the <a href=\"#browser_compatibility\">Browser compatibility table</a> carefully before using this in production.</p></div>\n<div class=\"notecard secure\" id=\"sect2\"><p><strong>Secure context:</strong> This feature is available only in <a href=\"/en-US/docs/Web/Security/Secure_Contexts\">secure contexts</a> (HTTPS), in some or all <a href=\"#browser_compatibility\">supporting browsers</a>.</p></div>\n<div class=\"notecard warning\" id=\"sect3\">\n  <p>\n    <strong>Warning:</strong> This documentation reflects stale browser implementations.\n    The specification has changed significantly since the docs were written, and they will need to be updated once browser implementations catch up.\n  </p>\n</div>\n<p>The <strong>HTML Sanitizer API</strong> allow developers to take untrusted strings of HTML and <a href=\"/en-US/docs/Web/API/Document\"><code>Document</code></a> or <a href=\"/en-US/docs/Web/API/DocumentFragment\"><code>DocumentFragment</code></a> objects, and sanitize them for safe insertion into a document's DOM.</p>"}},{"type":"prose","value":{"id":"concepts_and_usage","title":"Concepts and usage","isH3":false,"content":"<p>\n  Web applications often need to work with untrusted HTML on the client side, for example, as part of a client-side templating solution or for rendering user generated content, or when including data in a frame from another site.\n  The Sanitizer API allows for rendering of this potentially untrusted HTML in a safe manner.\n</p>\n<p>\n  To access the API you would use the <a href=\"/en-US/docs/Web/API/Sanitizer/Sanitizer\" title=\"Sanitizer()\"><code>Sanitizer()</code></a> constructor to create and configure a <a href=\"/en-US/docs/Web/API/Sanitizer\"><code>Sanitizer</code></a> instance.\n  The configuration options parameter allows you to specify the allowed and dis-allowed elements and attributes, and to enable custom elements and comments.\n</p>\n<p>\n  The most common use-case - preventing XSS - is handled by the default configuration.\n  Creating a <a href=\"/en-US/docs/Web/API/Sanitizer/Sanitizer\" title=\"Sanitizer()\"><code>Sanitizer()</code></a> with a custom configuration is necessary only to handle additional, application-specific use cases.\n</p>\n<p>The API has two main methods for sanitizing data:</p>\n<ol>\n  <li>\n    <a href=\"/en-US/docs/Web/API/Element/setHTML\"><code>Element.setHTML()</code></a> parses and sanitizes a string of HTML and immediately inserts it into the DOM as a child of the current element.\n    This is essentially a \"safe\" version of <a href=\"/en-US/docs/Web/API/Element/innerHTML\"><code>Element.innerHTML</code></a>, and should be used instead of <code>innerHTML</code> when inserting untrusted data.\n  </li>\n  <li><a href=\"/en-US/docs/Web/API/Sanitizer/sanitize\"><code>Sanitizer.sanitize()</code></a> sanitizes data that is in a <a href=\"/en-US/docs/Web/API/Document\"><code>Document</code></a> or <a href=\"/en-US/docs/Web/API/DocumentFragment\"><code>DocumentFragment</code></a>. It might be used, for example, to sanitize a <a href=\"/en-US/docs/Web/API/Document\"><code>Document</code></a> instance in a frame.</li>\n</ol>"}},{"type":"prose","value":{"id":"parsing_and_sanitizing_strings","title":"Parsing and sanitizing strings","isH3":true,"content":"<p>The result of parsing a string of HTML depends on the context/the element into which it is inserted.</p>\n<p>\n  For example, an HTML string containing <a href=\"/en-US/docs/Web/HTML/Element/td\"><code>&lt;td&gt;</code></a> elements is valid if inserted under a <a href=\"/en-US/docs/Web/HTML/Element/table\"><code>&lt;table&gt;</code></a> elements, but will be dropped if inserted in a <a href=\"/en-US/docs/Web/HTML/Element/div\"><code>&lt;div&gt;</code></a> element.\n  Similarly, an <a href=\"/en-US/docs/Web/HTML/Element/em\"><code>&lt;em&gt;</code></a> element is a valid node in a <a href=\"/en-US/docs/Web/HTML/Element/div\"><code>&lt;div&gt;</code></a> but the tag will be escaped if used in a <a href=\"/en-US/docs/Web/HTML/Element/textarea\"><code>&lt;textarea&gt;</code></a>:\n</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">html</span></p><pre class=\"brush: html notranslate\"><code><span class=\"token comment\">&lt;!-- \"&lt;em&gt;bla&lt;/em&gt;\" inserted into &lt;div&gt; --&gt;</span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>em</span><span class=\"token punctuation\">&gt;</span></span>bla<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>em</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n\n<span class=\"token comment\">&lt;!-- \"&lt;em&gt;bla&lt;/em&gt;\" inserted into &lt;textarea&gt; --&gt;</span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>textarea</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token entity named-entity\" title=\"<\">&amp;lt;</span>em<span class=\"token entity named-entity\" title=\">\">&amp;gt;</span>bla<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>textarea</span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre></div>\n<p>\n  The target element must therefore be known when the parser is run and the resulting subtree must be inserted into that same type of element in the DOM, or the result will be incorrect.\n  This consideration does not matter for <a href=\"/en-US/docs/Web/API/Element/setHTML\"><code>Element.setHTML()</code></a> as it is called on a particular element and the context is therefore implicit.\n</p>\n<p>\n  The parser may also perform normalization operations on the input string.\n  As a result, even if the HTML is valid and the sanitizer method does nothing, the sanitized output may not precisely match the unsanitized input.\n  This applies to both methods.\n</p>"}},{"type":"prose","value":{"id":"interfaces","title":"Interfaces","isH3":false,"content":"<dl>\n  <dt id=\"sanitizer\"><a href=\"/en-US/docs/Web/API/Sanitizer\"><code>Sanitizer</code></a> <abbr class=\"icon icon-experimental\" title=\"Experimental. Expect behavior to change in the future.\">\n    <span class=\"visually-hidden\">Experimental</span>\n</abbr></dt>\n  <dd>\n    <p>Provides the functionality to define a sanitizer configuration, to sanitize untrusted strings of HTML for later insertion into the DOM, and to sanitize <a href=\"/en-US/docs/Web/API/Document\"><code>Document</code></a> and <a href=\"/en-US/docs/Web/API/DocumentFragment\"><code>DocumentFragment</code></a> objects.</p>\n  </dd>\n  <dt id=\"element.sethtml\"><a href=\"/en-US/docs/Web/API/Element/setHTML\" title=\"Element.setHTML()\"><code>Element.setHTML()</code></a></dt>\n  <dd>\n    <p>Parses a string of HTML into a subtree of nodes, sanitizes it using a <code>Sanitizer</code> object, then sets it as a child of the current element.</p>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"examples","title":"Examples","isH3":false,"content":"<p>The following examples show how to use the sanitizer API using the <em>default</em> sanitizer (at time of writing configuration operations are not yet supported).</p>"}},{"type":"prose","value":{"id":"sanitize_a_string_immediately","title":"Sanitize a string immediately","isH3":true,"content":"<p>The code below demonstrates how <a href=\"/en-US/docs/Web/API/Element/setHTML\" title=\"Element.setHTML()\"><code>Element.setHTML()</code></a> is used to sanitize a string of HTML and insert it into the <code>Element</code> with an id of <code>target</code>.</p>\n<p>The <code>script</code> element is disallowed by the default sanitizer so the alert is removed.</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">const</span> unsanitized_string <span class=\"token operator\">=</span> <span class=\"token string\">\"abc &lt;script&gt;alert(1)&lt;\"</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"/script&gt; def\"</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Unsanitized string of HTML</span>\n\n<span class=\"token keyword\">const</span> sanitizer <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Sanitizer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Default sanitizer;</span>\n\n<span class=\"token comment\">// Get the Element with id \"target\" and set it with the sanitized string.</span>\n<span class=\"token keyword\">const</span> target <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"target\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ntarget<span class=\"token punctuation\">.</span><span class=\"token function\">setHTML</span><span class=\"token punctuation\">(</span>unsanitized_string<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> sanitizer <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">.</span>innerHTML<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// \"abc  def\"</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"sanitize_a_frame","title":"Sanitize a frame","isH3":true,"content":"<p>To sanitize data from an <a href=\"/en-US/docs/Web/HTML/Element/iframe\"><code>&lt;iframe&gt;</code></a> with id <code>userFrame</code>:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">const</span> sanitizer <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Sanitizer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Default sanitizer;</span>\n\n<span class=\"token comment\">// Get the frame and its Document object</span>\n<span class=\"token keyword\">const</span> frame_element <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"userFrame\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> unsanitized_frame_tree <span class=\"token operator\">=</span> frame_element<span class=\"token punctuation\">.</span>contentWindow<span class=\"token punctuation\">.</span>document<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Sanitize the document tree and update the frame.</span>\n<span class=\"token keyword\">const</span> sanitized_frame_tree <span class=\"token operator\">=</span> sanitizer<span class=\"token punctuation\">.</span><span class=\"token function\">sanitize</span><span class=\"token punctuation\">(</span>unsanitized_frame_tree<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nframe_element<span class=\"token punctuation\">.</span><span class=\"token function\">replaceChildren</span><span class=\"token punctuation\">(</span>sanitized_frame_tree<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>"}},{"type":"specifications","value":{"title":"Specifications","id":"specifications","isH3":false,"specifications":[{"bcdSpecificationURL":"https://wicg.github.io/sanitizer-api/#sanitizer-api","title":"HTML Sanitizer API"}],"query":"api.Sanitizer"}},{"type":"browser_compatibility","value":{"title":"Browser compatibility","id":"browser_compatibility","isH3":false,"query":"api.Sanitizer"}}],"toc":[{"text":"Concepts and usage","id":"concepts_and_usage"},{"text":"Interfaces","id":"interfaces"},{"text":"Examples","id":"examples"},{"text":"Specifications","id":"specifications"},{"text":"Browser compatibility","id":"browser_compatibility"}],"summary":"The HTML Sanitizer API allow developers to take untrusted strings of HTML and Document or DocumentFragment objects, and sanitize them for safe insertion into a document's DOM.","popularity":0.0142,"modified":"2023-12-08T07:49:13.000Z","source":{"folder":"en-us/web/api/html_sanitizer_api","github_url":"https://github.com/mdn/content/blob/main/files/en-us/web/api/html_sanitizer_api/index.md","last_commit_url":"https://github.com/mdn/content/commit/69bab8adfe3363061312aa58202f576507bf72d9","filename":"index.md"},"short_title":"HTML Sanitizer API","parents":[{"uri":"/en-US/docs/Web","title":"References"},{"uri":"/en-US/docs/Web/API","title":"Web APIs"},{"uri":"/en-US/docs/Web/API/HTML_Sanitizer_API","title":"HTML Sanitizer API"}],"pageTitle":"HTML Sanitizer API - Web APIs | MDN","noIndexing":false}}