{"doc":{"isMarkdown":true,"isTranslated":false,"isActive":true,"flaws":{},"title":"Pointer Lock API","mdn_url":"/en-US/docs/Web/API/Pointer_Lock_API","locale":"en-US","native":"English (US)","browserCompat":["api.Element.requestPointerLock"],"sidebarHTML":"<ol><li><strong><em><a href=\"/en-US/docs/Web/API/Pointer_Lock_API\" aria-current=\"page\">Pointer Lock API</a></em></strong></li><li class=\"toggle\"><details open=\"\"><summary>Properties</summary><ol><li><a href=\"/en-US/docs/Web/API/Document/pointerLockElement\"><code>Document.pointerLockElement</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Methods</summary><ol><li><a href=\"/en-US/docs/Web/API/Element/requestPointerLock\"><code>Element.requestPointerLock()</code></a></li><li><a href=\"/en-US/docs/Web/API/Document/exitPointerLock\"><code>Document.exitPointerLock()</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Events</summary><ol><li><a href=\"/en-US/docs/Web/API/Document/pointerlockchange_event\"><code>Document</code>: <code>pointerlockchange</code></a></li><li><a href=\"/en-US/docs/Web/API/Document/pointerlockerror_event\"><code>Document</code>: <code>pointerlockerror</code></a></li></ol></details></li></ol>","sidebarMacro":"DefaultAPISidebar","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p>The <strong>Pointer Lock API</strong> (formerly called <em>Mouse Lock API</em>) provides input methods based on the movement of the mouse over time (i.e., deltas), not just the absolute position of the mouse cursor in the viewport. It gives you access to raw mouse movement, locks the target of mouse events to a single element, eliminates limits on how far mouse movement can go in a single direction, and removes the cursor from view. It is ideal for first-person 3D games, for example.</p>\n<p>More than that, the API is useful for any applications that require significant mouse input to control movements, rotate objects, and change entries, for example allowing users to control the viewing angle by moving the mouse around without any button clicking. The buttons are then freed up for other actions. Other examples include apps for viewing maps or satellite imagery.</p>\n<p>Pointer lock lets you access mouse events even when the cursor goes past the boundary of the browser or screen. For example, your users can continue to rotate or manipulate a 3D model by moving the mouse without end. Without Pointer lock, the rotation or manipulation stops the moment the pointer reaches the edge of the browser or screen. Game players can now click buttons and swipe the mouse cursor back and forth without worrying about leaving the game play area and accidentally clicking another application that would take mouse focus away from the game.</p>"}},{"type":"prose","value":{"id":"basic_concepts","title":"Basic concepts","isH3":false,"content":"<p>Pointer lock is related to <a href=\"/en-US/docs/Web/API/Element/setCapture\">mouse capture</a>. Mouse capture provides continued delivery of events to a target element while a mouse is being dragged, but it stops when the mouse button is released. Pointer lock is different from mouse capture in the following ways:</p>\n<ul>\n  <li>It is persistent: Pointer lock does not release the mouse until an explicit API call is made or the user uses a specific release gesture.</li>\n  <li>It is not limited by browser or screen boundaries.</li>\n  <li>It continues to send events regardless of mouse button state.</li>\n  <li>It hides the cursor.</li>\n</ul>"}},{"type":"prose","value":{"id":"methodproperties_overview","title":"Method/properties overview","isH3":false,"content":"<p>This section provides a brief description of each property and method related to the pointer lock specification.</p>"}},{"type":"prose","value":{"id":"requestpointerlock","title":"requestPointerLock()","isH3":true,"content":"<p>The Pointer lock API, similar to the <a href=\"/en-US/docs/Web/API/Fullscreen_API\">Fullscreen API</a>, extends DOM elements by adding a new method, <a href=\"/en-US/docs/Web/API/Element/requestPointerLock\" title=\"requestPointerLock()\"><code>requestPointerLock()</code></a>. The following example requests pointer lock on a <a href=\"/en-US/docs/Web/HTML/Element/canvas\"><code>&lt;canvas&gt;</code></a> element:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code>canvas<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">await</span> canvas<span class=\"token punctuation\">.</span><span class=\"token function\">requestPointerLock</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<div class=\"notecard note\" id=\"sect1\">\n  <p><strong>Note:</strong> If a user has exited pointer lock via the <a href=\"https://w3c.github.io/pointerlock/#dfn-default-unlock-gesture\" class=\"external\" target=\"_blank\">default unlock gesture</a>, or pointer lock has not previously been entered for this document, an event generated as a result of an <a href=\"https://w3c.github.io/pointerlock/#dfn-engagement-gesture\" class=\"external\" target=\"_blank\">engagement gesture</a> must be received by the document before <a href=\"https://w3c.github.io/pointerlock/#dom-element-requestpointerlock\" class=\"external\" target=\"_blank\"><code>requestPointerLock</code></a> will succeed. (from <a href=\"https://w3c.github.io/pointerlock/#extensions-to-the-element-interface\" class=\"external\" target=\"_blank\">https://w3c.github.io/pointerlock/#extensions-to-the-element-interface</a>)</p>\n</div>\n<p>Operating systems enable mouse acceleration by default, which is useful when you sometimes want slow precise movement (think about you might use a graphics package), but also want to move great distances with a faster mouse movement (think about scrolling, and selecting several files). For some first-person perspective games however, raw mouse input data is preferred for controlling camera rotation — where the same distance movement, fast or slow, results in the same rotation. This results in a better gaming experience and higher accuracy, according to professional gamers.</p>\n<p>To disable OS-level mouse acceleration and access raw mouse input, you can set the <code>unadjustedMovement</code> to <code>true</code>:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code>canvas<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">await</span> canvas<span class=\"token punctuation\">.</span><span class=\"token function\">requestPointerLock</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">unadjustedMovement</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"handling_promise_and_non-promise_versions_of_requestpointerlock","title":"Handling promise and non-promise versions of requestPointerLock()","isH3":false,"content":"<p>The above code snippet will still work in browsers that do not support the promise-based version of <code>requestPointerLock()</code> or the <code>unadjustedMovement</code> option — the <a href=\"/en-US/docs/Web/JavaScript/Reference/Operators/await\"><code>await</code></a> operator is permitted in front of a function that does not return a promise, and the options object will just be ignored in non-supporting browsers.</p>\n<p>However, this could be confusing, and has other potential side-effects (for example, trying to use <code>requestPointerLock().then()</code> would throw an error in non-supporting browsers), so you may want to handle this explicitly using code along the following lines:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">function</span> <span class=\"token function\">requestPointerLockWithUnadjustedMovement</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> promise <span class=\"token operator\">=</span> myTargetElement<span class=\"token punctuation\">.</span><span class=\"token function\">requestPointerLock</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">unadjustedMovement</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>promise<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"disabling mouse acceleration is not supported\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> promise\n    <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"pointer is locked\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">.</span>name <span class=\"token operator\">===</span> <span class=\"token string\">\"NotSupportedError\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// Some platforms may not support unadjusted movement.</span>\n        <span class=\"token comment\">// You can request again a regular pointer lock.</span>\n        <span class=\"token keyword\">return</span> myTargetElement<span class=\"token punctuation\">.</span><span class=\"token function\">requestPointerLock</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"pointerlockelement_and_exitpointerlock","title":"pointerLockElement and exitPointerLock()","isH3":true,"content":"<p>The Pointer lock API also extends the <a href=\"/en-US/docs/Web/API/Document\"><code>Document</code></a> interface, adding a new property and a new method:</p>\n<ul>\n  <li><a href=\"/en-US/docs/Web/API/Document/pointerLockElement\" title=\"pointerLockElement\"><code>pointerLockElement</code></a> is used for accessing the currently locked element (if any).</li>\n  <li><a href=\"/en-US/docs/Web/API/Document/exitPointerLock\" title=\"exitPointerLock()\"><code>exitPointerLock()</code></a> is used to exit the pointer lock.</li>\n</ul>\n<p>The <a href=\"/en-US/docs/Web/API/Document/pointerLockElement\" title=\"pointerLockElement\"><code>pointerLockElement</code></a> property is useful for determining if any element is currently pointer locked (e.g., for doing a boolean check) and also for obtaining a reference to the locked element, if any.</p>\n<p>Here is an example of using <code>pointerLockElement</code>:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span>pointerLockElement <span class=\"token operator\">===</span> canvas<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"The pointer lock status is now locked\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"The pointer lock status is now unlocked\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>The <a href=\"/en-US/docs/Web/API/Document/exitPointerLock\"><code>Document.exitPointerLock()</code></a> method is used to exit pointer lock, and like <a href=\"/en-US/docs/Web/API/Element/requestPointerLock\" title=\"requestPointerLock\"><code>requestPointerLock</code></a>, works asynchronously using the <a href=\"/en-US/docs/Web/API/Document/pointerlockchange_event\" title=\"pointerlockchange\"><code>pointerlockchange</code></a> and <a href=\"/en-US/docs/Web/API/Document/pointerlockerror_event\" title=\"pointerlockerror\"><code>pointerlockerror</code></a> events, which you'll see more about below.</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code>document<span class=\"token punctuation\">.</span><span class=\"token function\">exitPointerLock</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"pointerlockchange_event","title":"pointerlockchange event","isH3":false,"content":"<p>When the Pointer lock state changes—for example, when calling <a href=\"/en-US/docs/Web/API/Element/requestPointerLock\" title=\"requestPointerLock()\"><code>requestPointerLock()</code></a> or <a href=\"/en-US/docs/Web/API/Document/exitPointerLock\" title=\"exitPointerLock()\"><code>exitPointerLock()</code></a>, the user pressing the ESC key, etc.—the <a href=\"/en-US/docs/Web/API/Document/pointerlockchange_event\" title=\"pointerlockchange\"><code>pointerlockchange</code></a> event is dispatched to the <code>document</code>. This is a simple event containing no extra data.</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code>document<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"pointerlockchange\"</span><span class=\"token punctuation\">,</span> lockChangeAlert<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">lockChangeAlert</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span>pointerLockElement <span class=\"token operator\">===</span> canvas<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"The pointer lock status is now locked\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// Do something useful in response</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"The pointer lock status is now unlocked\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// Do something useful in response</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"pointerlockerror_event","title":"pointerlockerror event","isH3":false,"content":"<p>When there is an error caused by calling <a href=\"/en-US/docs/Web/API/Element/requestPointerLock\" title=\"requestPointerLock()\"><code>requestPointerLock()</code></a> or <a href=\"/en-US/docs/Web/API/Document/exitPointerLock\" title=\"exitPointerLock()\"><code>exitPointerLock()</code></a>, the <a href=\"/en-US/docs/Web/API/Document/pointerlockerror_event\" title=\"pointerlockerror\"><code>pointerlockerror</code></a> event is dispatched to the <code>document</code>. This is a simple event containing no extra data.</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code>document<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"pointerlockerror\"</span><span class=\"token punctuation\">,</span> lockError<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">lockError</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Pointer lock failed\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"extensions_to_mouse_events","title":"Extensions to mouse events","isH3":false,"content":"<p>The Pointer lock API extends the normal <a href=\"/en-US/docs/Web/API/MouseEvent\"><code>MouseEvent</code></a> interface with movement attributes. Two new attributes to mouse events—<a href=\"/en-US/docs/Web/API/MouseEvent/movementX\" title=\"movementX\"><code>movementX</code></a> and <a href=\"/en-US/docs/Web/API/MouseEvent/movementY\" title=\"movementY\"><code>movementY</code></a>—provide the change in mouse positions. The values of the parameters are the same as the difference between the values of <a href=\"/en-US/docs/Web/API/MouseEvent\"><code>MouseEvent</code></a> properties, <a href=\"/en-US/docs/Web/API/MouseEvent/screenX\" title=\"screenX\"><code>screenX</code></a> and <a href=\"/en-US/docs/Web/API/MouseEvent/screenY\" title=\"screenY\"><code>screenY</code></a>, which are stored in two subsequent <a href=\"/en-US/docs/Web/API/Element/mousemove_event\" title=\"mousemove\"><code>mousemove</code></a> events, <code>eNow</code> and <code>ePrevious</code>. In other words, the Pointer lock parameter <code>movementX = eNow.screenX - ePrevious.screenX</code>.</p>"}},{"type":"prose","value":{"id":"locked_state","title":"Locked state","isH3":true,"content":"<p>When Pointer lock is enabled, the standard <a href=\"/en-US/docs/Web/API/MouseEvent\"><code>MouseEvent</code></a> properties <a href=\"/en-US/docs/Web/API/MouseEvent/clientX\" title=\"clientX\"><code>clientX</code></a>, <a href=\"/en-US/docs/Web/API/MouseEvent/clientY\" title=\"clientY\"><code>clientY</code></a>, <a href=\"/en-US/docs/Web/API/MouseEvent/screenX\" title=\"screenX\"><code>screenX</code></a>, and <a href=\"/en-US/docs/Web/API/MouseEvent/screenY\" title=\"screenY\"><code>screenY</code></a> are held constant, as if the mouse is not moving. The <a href=\"/en-US/docs/Web/API/MouseEvent/movementX\" title=\"movementX\"><code>movementX</code></a> and <a href=\"/en-US/docs/Web/API/MouseEvent/movementY\" title=\"movementY\"><code>movementY</code></a> properties continue to provide the mouse's change in position. There is no limit to <a href=\"/en-US/docs/Web/API/MouseEvent/movementX\" title=\"movementX\"><code>movementX</code></a> and <a href=\"/en-US/docs/Web/API/MouseEvent/movementY\" title=\"movementY\"><code>movementY</code></a> values if the mouse is continuously moving in a single direction. The concept of the mouse cursor does not exist and the cursor cannot move off the window or be clamped by a screen edge.</p>"}},{"type":"prose","value":{"id":"unlocked_state","title":"Unlocked state","isH3":true,"content":"<p>The parameters <a href=\"/en-US/docs/Web/API/MouseEvent/movementX\" title=\"movementX\"><code>movementX</code></a> and <a href=\"/en-US/docs/Web/API/MouseEvent/movementY\" title=\"movementY\"><code>movementY</code></a> are valid regardless of the mouse lock state, and are available even when unlocked for convenience.</p>\n<p>When the mouse is unlocked, the system cursor can exit and re-enter the browser window. If that happens, <a href=\"/en-US/docs/Web/API/MouseEvent/movementX\" title=\"movementX\"><code>movementX</code></a> and <a href=\"/en-US/docs/Web/API/MouseEvent/movementY\" title=\"movementY\"><code>movementY</code></a> could be set to zero.</p>"}},{"type":"prose","value":{"id":"simple_example_walkthrough","title":"Simple example walkthrough","isH3":false,"content":"<p>We've written a <a href=\"https://mdn.github.io/dom-examples/pointer-lock/\" class=\"external\" target=\"_blank\">pointer lock demo</a> (<a href=\"https://github.com/mdn/dom-examples/tree/main/pointer-lock\" class=\"external\" target=\"_blank\">see source code</a>) to show you how to use it to set up a simple control system. This demo uses JavaScript to draw a ball on top of an <a href=\"/en-US/docs/Web/HTML/Element/canvas\"><code>&lt;canvas&gt;</code></a> element. When you click the canvas, pointer lock is then used to remove the mouse pointer and allow you to move the ball directly using the mouse. Let's see how this works.</p>\n<p>We set initial x and y positions on the canvas:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">let</span> x <span class=\"token operator\">=</span> <span class=\"token number\">50</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> y <span class=\"token operator\">=</span> <span class=\"token number\">50</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Next we set up an event listener to run the <code>requestPointerLock()</code> method on the canvas when it is clicked, which initiates pointer lock. The <code>document.pointerLockElement</code> check is to see if there is already an active pointer lock — we don't want to keep calling <code>requestPointerLock()</code> on the canvas every time we click inside it if we already have pointer lock.</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code>canvas<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>document<span class=\"token punctuation\">.</span>pointerLockElement<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">await</span> canvas<span class=\"token punctuation\">.</span><span class=\"token function\">requestPointerLock</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">unadjustedMovement</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<div class=\"notecard note\" id=\"sect2\">\n  <p><strong>Note:</strong> The above snippet works in browsers that don't support the promise version of <code>requestPointerLock()</code>. See <a href=\"#handling_promise_and_non-promise_versions_of_requestpointerlock\">Handling promise and non-promise versions of requestPointerLock()</a> for an explanation.</p>\n</div>\n<p>Now for the dedicated pointer lock event listener: <code>pointerlockchange</code>. When this occurs, we run a function called <code>lockChangeAlert()</code> to handle the change.</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code>document<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"pointerlockchange\"</span><span class=\"token punctuation\">,</span> lockChangeAlert<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>This function checks the <code>pointerLockElement</code> property to see if it is our canvas. If so, it attached an event listener to handle the mouse movements with the <code>updatePosition()</code> function. If not, it removes the event listener again.</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">function</span> <span class=\"token function\">lockChangeAlert</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span>pointerLockElement <span class=\"token operator\">===</span> canvas<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"The pointer lock status is now locked\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    document<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"mousemove\"</span><span class=\"token punctuation\">,</span> updatePosition<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"The pointer lock status is now unlocked\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    document<span class=\"token punctuation\">.</span><span class=\"token function\">removeEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"mousemove\"</span><span class=\"token punctuation\">,</span> updatePosition<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>The <code>updatePosition()</code> function updates the position of the ball on the canvas (<code>x</code> and <code>y</code>), and also includes <code>if ()</code> statements to check whether the ball has gone off the edges of the canvas. If so, it makes the ball wrap around to the opposite edge. It also includes a check whether a <a href=\"/en-US/docs/Web/API/window/requestAnimationFrame\"><code>requestAnimationFrame()</code></a> call has previously been made, and if so, calls it again as required, and calls the <code>canvasDraw()</code> function that updates the canvas scene. A tracker is also set up to write out the X and Y values to the screen, for reference.</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">const</span> tracker <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"tracker\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">let</span> animation<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">updatePosition</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  x <span class=\"token operator\">+=</span> e<span class=\"token punctuation\">.</span>movementX<span class=\"token punctuation\">;</span>\n  y <span class=\"token operator\">+=</span> e<span class=\"token punctuation\">.</span>movementY<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>x <span class=\"token operator\">&gt;</span> canvas<span class=\"token punctuation\">.</span>width <span class=\"token operator\">+</span> <span class=\"token constant\">RADIUS</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    x <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token constant\">RADIUS</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>y <span class=\"token operator\">&gt;</span> canvas<span class=\"token punctuation\">.</span>height <span class=\"token operator\">+</span> <span class=\"token constant\">RADIUS</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    y <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token constant\">RADIUS</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>x <span class=\"token operator\">&lt;</span> <span class=\"token operator\">-</span><span class=\"token constant\">RADIUS</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    x <span class=\"token operator\">=</span> canvas<span class=\"token punctuation\">.</span>width <span class=\"token operator\">+</span> <span class=\"token constant\">RADIUS</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>y <span class=\"token operator\">&lt;</span> <span class=\"token operator\">-</span><span class=\"token constant\">RADIUS</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    y <span class=\"token operator\">=</span> canvas<span class=\"token punctuation\">.</span>height <span class=\"token operator\">+</span> <span class=\"token constant\">RADIUS</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  tracker<span class=\"token punctuation\">.</span>textContent <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">X position: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>x<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">, Y position: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>y<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>animation<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    animation <span class=\"token operator\">=</span> <span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n      animation <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n      <span class=\"token function\">canvasDraw</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>The <code>canvasDraw()</code> function draws the ball in the current <code>x</code> and <code>y</code> positions:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">function</span> <span class=\"token function\">canvasDraw</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  ctx<span class=\"token punctuation\">.</span>fillStyle <span class=\"token operator\">=</span> <span class=\"token string\">\"black\"</span><span class=\"token punctuation\">;</span>\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">fillRect</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> canvas<span class=\"token punctuation\">.</span>width<span class=\"token punctuation\">,</span> canvas<span class=\"token punctuation\">.</span>height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  ctx<span class=\"token punctuation\">.</span>fillStyle <span class=\"token operator\">=</span> <span class=\"token string\">\"#f00\"</span><span class=\"token punctuation\">;</span>\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">beginPath</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">arc</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> <span class=\"token constant\">RADIUS</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token function\">degToRad</span><span class=\"token punctuation\">(</span><span class=\"token number\">360</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">fill</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"iframe_limitations","title":"IFrame limitations","isH3":false,"content":"<p>Pointer lock can only lock one <a href=\"/en-US/docs/Web/HTML/Element/iframe\"><code>&lt;iframe&gt;</code></a> at a time. If you lock one <code>&lt;iframe&gt;</code>, you can't lock another one and transfer the target to it; pointer lock will error out. To avoid this limitation, first unlock the locked <code>&lt;iframe&gt;</code>, and then lock the other.</p>\n<p>While <code>&lt;iframe&gt;</code> work by default, \"sandboxed\" <code>&lt;iframe&gt;</code>s block Pointer lock. To avoid this limitation, use <code>&lt;iframe sandbox=\"allow-pointer-lock\"&gt;</code>.</p>"}},{"type":"specifications","value":{"title":"Specifications","id":"specifications","isH3":false,"specifications":[{"bcdSpecificationURL":"https://w3c.github.io/pointerlock/#dom-element-requestpointerlock","title":"Pointer Lock 2.0"}],"query":"api.Element.requestPointerLock"}},{"type":"browser_compatibility","value":{"title":"Browser compatibility","id":"browser_compatibility","isH3":false,"query":"api.Element.requestPointerLock"}},{"type":"prose","value":{"id":"see_also","title":"See also","isH3":false,"content":"<ul>\n  <li><a href=\"/en-US/docs/Web/API/MouseEvent\"><code>MouseEvent</code></a></li>\n  <li><a href=\"/en-US/docs/Web/API/Element/requestPointerLock\"><code>Element.requestPointerLock()</code></a></li>\n</ul>"}}],"toc":[{"text":"Basic concepts","id":"basic_concepts"},{"text":"Method/properties overview","id":"methodproperties_overview"},{"text":"Handling promise and non-promise versions of requestPointerLock()","id":"handling_promise_and_non-promise_versions_of_requestpointerlock"},{"text":"pointerlockchange event","id":"pointerlockchange_event"},{"text":"pointerlockerror event","id":"pointerlockerror_event"},{"text":"Extensions to mouse events","id":"extensions_to_mouse_events"},{"text":"Simple example walkthrough","id":"simple_example_walkthrough"},{"text":"IFrame limitations","id":"iframe_limitations"},{"text":"Specifications","id":"specifications"},{"text":"Browser compatibility","id":"browser_compatibility"},{"text":"See also","id":"see_also"}],"summary":"The Pointer Lock API (formerly called Mouse Lock API) provides input methods based on the movement of the mouse over time (i.e., deltas), not just the absolute position of the mouse cursor in the viewport. It gives you access to raw mouse movement, locks the target of mouse events to a single element, eliminates limits on how far mouse movement can go in a single direction, and removes the cursor from view. It is ideal for first-person 3D games, for example.","popularity":0.0088,"modified":"2023-03-01T09:58:07.000Z","source":{"folder":"en-us/web/api/pointer_lock_api","github_url":"https://github.com/mdn/content/blob/main/files/en-us/web/api/pointer_lock_api/index.md","last_commit_url":"https://github.com/mdn/content/commit/c244d3b2cb6c17e6ba8692e3faec393afd9988ca","filename":"index.md"},"short_title":"Pointer Lock API","parents":[{"uri":"/en-US/docs/Web","title":"References"},{"uri":"/en-US/docs/Web/API","title":"Web APIs"},{"uri":"/en-US/docs/Web/API/Pointer_Lock_API","title":"Pointer Lock API"}],"pageTitle":"Pointer Lock API - Web APIs | MDN","noIndexing":false}}