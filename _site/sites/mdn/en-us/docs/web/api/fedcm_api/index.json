{"doc":{"isMarkdown":true,"isTranslated":false,"isActive":true,"flaws":{},"title":"Federated Credential Management (FedCM) API","mdn_url":"/en-US/docs/Web/API/FedCM_API","locale":"en-US","native":"English (US)","browserCompat":["api.IdentityCredential"],"sidebarHTML":"<ol><li><strong><em><a href=\"/en-US/docs/Web/API/FedCM_API\" aria-current=\"page\">FedCM API</a></em></strong></li><li class=\"toggle\"><details open=\"\"><summary>Interfaces</summary><ol><li><a href=\"/en-US/docs/Web/API/IdentityCredential\"><code>IdentityCredential</code></a></li><li><a href=\"/en-US/docs/Web/API/IdentityProvider\"><code>IdentityProvider</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Methods</summary><ol><li><a href=\"/en-US/docs/Web/API/CredentialsContainer/get\"><code>CredentialsContainer.get()</code></a></li></ol></details></li></ol>","sidebarMacro":"DefaultAPISidebar","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<div class=\"notecard experimental\" id=\"sect1\"><p><strong>Experimental:</strong> <strong>This is an <a href=\"/en-US/docs/MDN/Writing_guidelines/Experimental_deprecated_obsolete#experimental\">experimental technology</a></strong><br>Check the <a href=\"#browser_compatibility\">Browser compatibility table</a> carefully before using this in production.</p></div>\n<p>The <strong>Federated Credential Management API</strong> (or <em>FedCM API</em>) provides a standard mechanism for identity providers (IdPs) to make identity federation services available on the web in a privacy-preserving way, without the need for third-party cookies and redirects. This includes a JavaScript API that enables the use of federated authentication for activities such as signing in or signing up on a website.</p>"}},{"type":"prose","value":{"id":"fedcm_concepts","title":"FedCM concepts","isH3":false,"content":"<p>Identity federation is the delegation of user authentication from a website requiring user sign-up or sign-in, such as an e-commerce or social networking site (also known as a relying party or RP), to a trusted third-party IdP. Users register an account with the IdP, which can then be used for signing in on multiple RPs. Identity federation via a small set of dedicated IdPs has improved web authentication in terms of security, consumer confidence, and user experience, as compared to each site managing its own sign-in needs with separate usernames and passwords.</p>\n<p>The problem is that traditional identity federation relies on <a href=\"/en-US/docs/Web/HTML/Element/iframe\"><code>&lt;iframe&gt;</code></a>s, redirects, and third-party cookies, which are also used for third-party tracking. Browsers are limiting the usage of these features in an effort to preserve user privacy, but a side effect is that this makes valid, non-tracking uses more difficult to implement, and this includes identity federation.</p>\n<p>Affected identity federation use cases that rely on third-party cookies:</p>\n<ul>\n  <li><a href=\"https://openid.net/specs/openid-connect-frontchannel-1_0.html\" class=\"external\" target=\"_blank\">OIDC front-channel logout</a>: This flow requires the IDP to embed several RP <code>&lt;iframe&gt;</code>s, which rely on RP cookies.</li>\n  <li>Social Widgets: In order to provide social widgets, the IdP third-party cookie must be provided from the RP top-level origin.</li>\n  <li>Personalized buttons: The display of personalized sign in information on a <a href=\"/en-US/docs/Web/HTML/Element/button\"><code>&lt;button&gt;</code></a> in the RP origin is implemented as an IdP <code>&lt;iframe&gt;</code> that requires third party cookies.</li>\n  <li>Session Refresh without top-level navigation or popups.</li>\n</ul>\n<p>FedCM aims to work around this problem, providing a dedicated mechanism for federated identity flows on the web, and enabling supporting browsers to provide special UI elements on RPs, allowing users to choose an IdP account to use for sign-in.</p>\n<p>There are two parts to using the FedCM API: IdP integration with FedCM and RP sign-in using the JavaScript API.</p>"}},{"type":"prose","value":{"id":"idp_integration_with_fedcm","title":"IdP integration with FedCM","isH3":false,"content":"<p>To integrate with FedCM, an IdP needs to do the following:</p>\n<ol>\n  <li>Provide a well-known file to identify the IdP.</li>\n  <li>Provide a config file and endpoints for accounts list and assertion issuance (and optionally, client metadata).</li>\n</ol>"}},{"type":"prose","value":{"id":"provide_a_well-known_file","title":"Provide a well-known file","isH3":true,"content":"<p>There is a potential privacy issue whereby an <a href=\"https://github.com/fedidcg/FedCM/issues/230\" class=\"external\" target=\"_blank\">IdP is able to discern whether a user visited an RP without explicit consent</a>. This has tracking implications, so an IdP is required to provide a well-known file to verify its identity and mitigate this issue.</p>\n<p>The well-known file must be served from the <a href=\"https://web.dev/articles/same-site-same-origin#site\" class=\"external\" target=\"_blank\">eTLD+1</a> of the IdP at <code>/.well-known/web-identity</code>.</p>\n<p>For example, if the IdP endpoints are served under <code>https://accounts.idp.example/</code>, they must serve a well-known file at <code>https://idp.example/.well-known/web-identity</code>. The well-known file's content should have the following JSON structure:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">json</span></p><pre class=\"brush: json notranslate\"><code><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"provider_urls\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"https://accounts.idp.example/config.json\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>The <code>provider_urls</code> member should contain an array of URLs pointing to valid IdP config files that can be used by RPs to interact with the IdP. The array length is currently limited to one.</p>"}},{"type":"prose","value":{"id":"provide_a_config_file","title":"Provide a config file","isH3":true,"content":"<p>The IdP config file provides a list of the endpoints the browser needs to process the identity federation flow and manage the sign-ins. IdPs will host both this config file and the required endpoints.</p>\n<p>The config file (hosted at <code>https://accounts.idp.example/config.json</code> in our example) should have the following JSON structure:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">json</span></p><pre class=\"brush: json notranslate\"><code><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"accounts_endpoint\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/accounts.php\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"client_metadata_endpoint\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/client_metadata.php\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"id_assertion_endpoint\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/assertion.php\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"branding\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"background_color\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"green\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"color\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"0xFFEEAA\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"icons\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"url\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"https://idp.example/icon.ico\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"size\"</span><span class=\"token operator\">:</span> <span class=\"token number\">25</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>The properties are as follows:</p>\n<dl>\n  <dt id=\"accounts_endpoint\"><a href=\"#accounts_endpoint\"><code>accounts_endpoint</code></a></dt>\n  <dd>\n    <p>The URL for the accounts list endpoint, which returns a list of accounts that the user is currently signed in to on the IdP. The browser uses these to create a list of sign-in choices to show to the user in the browser-provided FedCM UI.</p>\n  </dd>\n  <dt id=\"client_metadata_endpoint\"><a href=\"#client_metadata_endpoint\"><code>client_metadata_endpoint</code></a> <span class=\"badge inline optional\">Optional</span></dt>\n  <dd>\n    <p>The URL for the client metadata endpoint, which provides URLs pointing to the RP's metadata and terms of service pages, to be used in the FedCM UI.</p>\n  </dd>\n  <dt id=\"id_assertion_endpoint\"><a href=\"#id_assertion_endpoint\"><code>id_assertion_endpoint</code></a></dt>\n  <dd>\n    <p>The URL for the ID assertion endpoint, which when sent valid user credentials should respond with a validation token that the RP can use to validate the authentication.</p>\n  </dd>\n  <dt id=\"branding\"><a href=\"#branding\"><code>branding</code></a> <span class=\"badge inline optional\">Optional</span></dt>\n  <dd>\n    <p>Contains branding information that will be used in the browser-supplied FedCM UI to customize its appearance as desired by the IdP.</p>\n  </dd>\n</dl>\n<h4 id=\"the_accounts_list_endpoint\">The accounts list endpoint</h4>\n<p>This endpoint returns a list of all the IdP accounts that the user is currently signed in with, with a JSON structure that matches the following:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">json</span></p><pre class=\"brush: json notranslate\"><code><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"accounts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"john_doe\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"given_name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"John\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"John Doe\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"email\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"john_doe@idp.example\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"picture\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"https://idp.example/profile/123\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"approved_clients\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"123\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"456\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"789\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"login_hints\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"john_doe\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"john_doe@idp.example\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"johnny\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"given_name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Johnny\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Johnny\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"email\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"johnny@idp.example\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"picture\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"https://idp.example/profile/456\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"approved_clients\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"abc\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"def\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"ghi\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"login_hints\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"johnny\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"johnny@idp.example\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>This includes the following information:</p>\n<dl>\n  <dt id=\"id\"><a href=\"#id\"><code>id</code></a></dt>\n  <dd>\n    <p>The unique ID of the user.</p>\n  </dd>\n  <dt id=\"name\"><a href=\"#name\"><code>name</code></a></dt>\n  <dd>\n    <p>The family name of the user.</p>\n  </dd>\n  <dt id=\"email\"><a href=\"#email\"><code>email</code></a></dt>\n  <dd>\n    <p>The email address of the user.</p>\n  </dd>\n  <dt id=\"given_name\"><a href=\"#given_name\"><code>given_name</code></a> <span class=\"badge inline optional\">Optional</span></dt>\n  <dd>\n    <p>The given name of the user.</p>\n  </dd>\n  <dt id=\"picture\"><a href=\"#picture\"><code>picture</code></a> <span class=\"badge inline optional\">Optional</span></dt>\n  <dd>\n    <p>The URL of the user's avatar image.</p>\n  </dd>\n  <dt id=\"approved_clients\"><a href=\"#approved_clients\"><code>approved_clients</code></a> <span class=\"badge inline optional\">Optional</span></dt>\n  <dd>\n    <p>An array of RP clients that the user has registered with.</p>\n  </dd>\n  <dt id=\"login_hints\"><a href=\"#login_hints\"><code>login_hints</code></a> <span class=\"badge inline optional\">Optional</span></dt>\n  <dd>\n    <p>An array of strings representing the account. These strings are used to filter the list of account options that the browser offers for the user to sign-in. This occurs when the <code>loginHint</code> property is provided within <a href=\"/en-US/docs/Web/API/CredentialsContainer/get#identity_object_structure\"><code>identity.providers</code></a> in a related <code>get()</code> call. Any account with a string in its <code>login_hints</code> array that matches the provided <code>loginHint</code> is included.</p>\n  </dd>\n</dl>\n<div class=\"notecard note\" id=\"sect2\">\n  <p><strong>Note:</strong>: If the user is not signed in to any IdP accounts, the endpoint should respond with <a href=\"/en-US/docs/Web/HTTP/Status/401\">HTTP 401 (Unauthorized)</a>.</p>\n</div>\n<h4 id=\"the_client_metadata_endpoint\">The client metadata endpoint</h4>\n<p>Provides URLs pointing to the RP's metadata and terms of service pages, to be used in the browser-supplied FedCM UI. This should follow the JSON structure seen below:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">json</span></p><pre class=\"brush: json notranslate\"><code><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"privacy_policy_url\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"https://rp.example/privacy_policy.html\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"terms_of_service_url\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"https://rp.example/terms_of_service.html\"</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<h4 id=\"the_id_assertion_endpoint\">The ID assertion endpoint</h4>\n<p>When sent valid user credentials, this endpoint should respond with a validation token that the RP can use to validate the authentication:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">json</span></p><pre class=\"brush: json notranslate\"><code><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"token\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"***********\"</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"rp_sign-in_using_the_javascript_api","title":"RP sign-in using the JavaScript API","isH3":false,"content":"<p>RPs can call <a href=\"/en-US/docs/Web/API/CredentialsContainer/get\" title=\"navigator.credentials.get()\"><code>navigator.credentials.get()</code></a> with an <code>identity</code> option to make a request for users to sign in to the RP with the IdP, using the available IdP config and endpoints (as described above). A typical request might look like this:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">signIn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> identityCredential <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> navigator<span class=\"token punctuation\">.</span>credentials<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">identity</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">context</span><span class=\"token operator\">:</span> <span class=\"token string\">\"signup\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">providers</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{</span>\n          <span class=\"token literal-property property\">configURL</span><span class=\"token operator\">:</span> <span class=\"token string\">\"https://accounts.idp.example/config.json\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token literal-property property\">clientId</span><span class=\"token operator\">:</span> <span class=\"token string\">\"********\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token literal-property property\">nonce</span><span class=\"token operator\">:</span> <span class=\"token string\">\"******\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token literal-property property\">loginHint</span><span class=\"token operator\">:</span> <span class=\"token string\">\"user1@example.com\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>The <code>identity.providers</code> property takes an array of objects containing the path to an IdP config file and the RP's client identifier issued by the IdP; the example above also includes a couple of optional features:</p>\n<ul>\n  <li><code>identity.context</code> specifies the context in which the user is authenticating with FedCM. For example, is it a first-time signup for this account, or a sign-in with an existing account?. The browser uses this information to vary the text in its FedCM UI to better suit the context.</li>\n  <li><code>identity.providers.nonce</code> provides a random nonce value that ensures the response is issued for this specific request, preventing <a href=\"/en-US/docs/Glossary/Replay_attack\">replay attacks</a>.</li>\n  <li><code>identity.providers.loginHint</code> provides a hint about the account option(s) the browser should present for user sign-in. This hint is matched against the <code>login_hints</code> values that the IdP provides from the <a href=\"#the_accounts_list_endpoint\">accounts list endpoint</a>.</li>\n</ul>\n<p>The browser requests the IdP config file and carries out the sign-in flow detailed below. For more information on the kind of interaction a user might expect from the browser-supplied UI, see <a href=\"https://developer.chrome.com/docs/privacy-sandbox/fedcm/#sign-into-rp\" class=\"external\" target=\"_blank\">Sign in to the relying party with the identity provider</a>.</p>"}},{"type":"prose","value":{"id":"fedcm_sign-in_flow","title":"FedCM sign-in flow","isH3":true,"content":"<ol>\n  <li>The RP invokes <a href=\"/en-US/docs/Web/API/CredentialsContainer/get\" title=\"navigator.credentials.get()\"><code>navigator.credentials.get()</code></a> to start off the sign-in flow.</li>\n  <li>\n    From the <code>configURL</code> provided in the <code>get()</code> call, the browser requests two files:\n    <ol>\n      <li>The well-known file (<code>/.well-known/web-identity</code>), available from <code>/.well-known/web-identity</code> at the <a href=\"https://web.dev/articles/same-site-same-origin#site\" class=\"external\" target=\"_blank\">eTLD+1</a> of the <code>configURL</code>.</li>\n      <li>The config file (<code>/config.json</code>), available at the <code>configURL</code>.</li>\n    </ol>These are both a <a href=\"/en-US/docs/Web/HTTP/Methods/GET\"><code>GET</code></a> requests, which don't have cookies and don't follow redirects. This effectively prevents the IdP from learning who made the request and which RP is attempting to connect.\n    For example, the config file request would look like so:\n    <div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">http</span></p><pre class=\"brush: http notranslate\"><code><span class=\"token request-line\"><span class=\"token method property\">GET</span> <span class=\"token request-target url\"><span class=\"token path\"><span class=\"token path-separator\">/</span>config.json</span></span> <span class=\"token http-version property\">HTTP/1.1</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Host</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">accounts.idp.example</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Accept</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">application/json</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Sec-Fetch-Dest</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">webidentity</span></span>\n</code></pre></div>\n    <div class=\"notecard note\" id=\"sect3\">\n      <p><strong>Note:</strong> All requests sent from the browser via FedCM include a <code>Sec-Fetch-Dest: webidentity</code> header to prevent <a href=\"/en-US/docs/Glossary/CSRF\">CSRF</a> attacks. All IdP endpoints must confirm this header is included.</p>\n    </div>\n  </li>\n  <li>The IdP responds with the requested files. The config file URL is validated against the list of valid config URLs inside the well-known file.</li>\n  <li>\n    The browser makes a request to the <code>accounts_endpoint</code> inside the config file for the list of accounts that the user is currently signed in to on the IdP. This is a <code>GET</code> request with cookies, but without a <code>client_id</code> parameter or the <a href=\"/en-US/docs/Web/HTTP/Headers/Origin\"><code>Origin</code></a> header. This effectively prevents the IdP from learning which RP the user is trying to sign in to.\n    For example:\n    <div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">http</span></p><pre class=\"brush: http notranslate\"><code><span class=\"token request-line\"><span class=\"token method property\">GET</span> <span class=\"token request-target url\"><span class=\"token path\"><span class=\"token path-separator\">/</span>accounts.php</span></span> <span class=\"token http-version property\">HTTP/1.1</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Host</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">accounts.idp.example</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Accept</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">application/json</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Cookie</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">0x23223</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Sec-Fetch-Dest</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">webidentity</span></span>\n</code></pre></div>\n  </li>\n  <li>The IdP responds with the account information.</li>\n  <li>\n    <span class=\"badge inline optional\">Optional</span> If included in the config file, the browser makes a request to the <code>client_metadata_endpoint</code> for the location of the RP's terms of service and privacy policy pages. This is a <code>GET</code> request sent with the <code>clientId</code> passed into the <code>get()</code> call as a parameter, without cookies.\n    For example:\n    <div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">http</span></p><pre class=\"brush: http notranslate\"><code><span class=\"token request-line\"><span class=\"token method property\">GET</span> <span class=\"token request-target url\"><span class=\"token path\"><span class=\"token path-separator\">/</span>client_metadata.php</span><span class=\"token query\"><span class=\"token query-delimiter\">?</span><span class=\"token pair\"><span class=\"token key\">client_id</span>=<span class=\"token value\">1234</span></span></span></span> <span class=\"token http-version property\">HTTP/1.1</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Host</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">accounts.idp.example</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Origin</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">https://rp.example/</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Accept</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">application/json</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Sec-Fetch-Dest</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">webidentity</span></span>\n</code></pre></div>\n  </li>\n  <li><span class=\"badge inline optional\">Optional</span> The IdP responds with the requested URLs.</li>\n  <li>The browser uses the information obtained by the previous two requests to create the UI asking the user for permission to sign in to the RP using their federated IdP account.</li>\n  <li>\n    If the user grants permission to do so, the browser sends some credentials to the <code>id_assertion_endpoint</code> and requests a validation token from the IdP.\n    The credentials are sent in an HTTP <a href=\"/en-US/docs/Web/HTTP/Methods/POST\"><code>POST</code></a> request with cookies and a content type of <code>application/x-www-form-urlencoded</code>. It should look something like this:\n    <div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">http</span></p><pre class=\"brush: http notranslate\"><code><span class=\"token request-line\"><span class=\"token method property\">POST</span> <span class=\"token request-target url\"><span class=\"token path\"><span class=\"token path-separator\">/</span>assertion.php</span></span> <span class=\"token http-version property\">HTTP/1.1</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Host</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">accounts.idp.example</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Origin</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">https://rp.example/</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Content-Type</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">application/x-www-form-urlencoded</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Cookie</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">0x23223</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Sec-Fetch-Dest</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">webidentity</span></span>\naccount_id=123&amp;client_id=client1234&amp;nonce=Ct60bD&amp;disclosure_text_shown=true\n</code></pre></div>The payload should contain the following:\n    <dl>\n      <dt id=\"client_id\"><a href=\"#client_id\"><code>client_id</code></a></dt>\n      <dd>\n        <p>The RP's client identifier.</p>\n      </dd>\n      <dt id=\"account_id\"><a href=\"#account_id\"><code>account_id</code></a></dt>\n      <dd>\n        <p>The unique ID of the user account to be signed in.</p>\n      </dd>\n      <dt id=\"nonce\"><a href=\"#nonce\"><code>nonce</code></a> <span class=\"badge inline optional\">Optional</span></dt>\n      <dd>\n        <p>The request nonce, provided by the RP.</p>\n      </dd>\n      <dt id=\"disclosure_text_shown\"><a href=\"#disclosure_text_shown\"><code>disclosure_text_shown</code></a></dt>\n      <dd>\n        <p>A string of <code>\"true\"</code> or <code>\"false\"</code> indicating whether the disclosure text was shown or not. The disclosure text is the information shown to the user (which can include the terms of service and privacy policy links, if provided) if the user is signed in to the IdP but doesn't have an account specifically on the current RP (in which case they'd need to choose to \"Continue as...\" their IdP identity and then create a corresponding account on the RP).</p>\n      </dd>\n    </dl>\n  </li>\n  <li>The IdP checks that the account ID sent by the RP matches the ID for the account that is already signed in, and that the <code>Origin</code> matches the origin of the RP, which will have been registered in advance with the IdP. If everything looks good, it responds with the validation token.</li>\n</ol>\n<div class=\"notecard note\" id=\"sect4\">\n  <p><strong>Note:</strong> The origin of the RP will be registered with the IdP in a completely separate process when the RP first integrates with the IdP. This process will be specific to each IdP.</p>\n</div>\n<p>When the flow is complete, the RP validates the validation token. If validation is successful, the <code>get()</code> promise resolves with an <a href=\"/en-US/docs/Web/API/IdentityCredential\"><code>IdentityCredential</code></a> object, which provides further RP functionality. Additionally, at this point the RP may register the user or let them sign in and start a new session.</p>"}},{"type":"prose","value":{"id":"features_available_via_identitycredential","title":"Features available via IdentityCredential","isH3":true,"content":"<p>The <a href=\"/en-US/docs/Web/API/IdentityCredential\"><code>IdentityCredential</code></a> object obtained from a successful FedCM sign-in provides access to the token used to validate the sign-in (see <a href=\"/en-US/docs/Web/API/IdentityCredential/token\"><code>IdentityCredential.token</code></a>).</p>"}},{"type":"prose","value":{"id":"permissions_policy_integration_and_iframe_support","title":"Permissions Policy integration and IFrame support","isH3":false,"content":"<p>The <a href=\"/en-US/docs/Web/HTTP/Headers/Permissions-Policy/identity-credentials-get\"><code>identity-credentials-get</code></a> <a href=\"/en-US/docs/Web/HTTP/Permissions_Policy\">Permissions-Policy</a> can be used to control permission to use FedCM, more specifically usage of the <a href=\"/en-US/docs/Web/API/CredentialsContainer/get\" title=\"navigator.credentials.get()\"><code>navigator.credentials.get()</code></a> method.</p>\n<p>Developers can explicitly grant permission for an <a href=\"/en-US/docs/Web/HTML/Element/iframe\"><code>&lt;iframe&gt;</code></a> to use FedCM via the <code>allow</code> attribute:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">html</span></p><pre class=\"brush: html notranslate\"><code><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>iframe</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>3rd-party.example<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">allow</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>identity-credentials-get<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>iframe</span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre></div>\n<p>The availability of FedCM within <code>&lt;iframe&gt;</code>s enables a couple of use cases:</p>\n<ul>\n  <li>Larger sites won't want a third-party sign-in script to gain control over the top-level frame; instead they will want to add that script and invoke FedCM from within an <a href=\"/en-US/docs/Web/HTML/Element/iframe\"><code>&lt;iframe&gt;</code></a>.</li>\n  <li>Some <code>&lt;iframes&gt;</code> may themselves require federated authentication.</li>\n</ul>"}},{"type":"prose","value":{"id":"interfaces","title":"Interfaces","isH3":false,"content":"<dl>\n  <dt id=\"identitycredential\"><a href=\"/en-US/docs/Web/API/IdentityCredential\"><code>IdentityCredential</code></a></dt>\n  <dd>\n    <p>Represents a user identity credential arising from successful federated authentication. A successful <a href=\"/en-US/docs/Web/API/CredentialsContainer/get\" title=\"navigator.credentials.get()\"><code>navigator.credentials.get()</code></a> call that includes an <code>identity</code> option fulfills with an <a href=\"/en-US/docs/Web/API/IdentityCredential\"><code>IdentityCredential</code></a> instance.</p>\n  </dd>\n  <dt id=\"identityprovider\"><a href=\"/en-US/docs/Web/API/IdentityProvider\"><code>IdentityProvider</code></a></dt>\n  <dd>\n    <p>Represents an IdP and provides access to related information. The static <a href=\"/en-US/docs/Web/API/IdentityProvider/getUserInfo_static\" title=\"IdentityProvider.getUserInfo()\"><code>IdentityProvider.getUserInfo()</code></a> method returns information about a user who was previously signed in, when they return to an IdP. This information can be used to display a personalized welcome message and sign-in button.</p>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"extensions_to_other_interfaces","title":"Extensions to other interfaces","isH3":false,"content":"<dl>\n  <dt id=\"credentialscontainer.get\"><a href=\"/en-US/docs/Web/API/CredentialsContainer/get\"><code>CredentialsContainer.get()</code></a>, the <code>identity</code> option.</dt>\n  <dd>\n    <p><code>identity</code> is an object containing details of federated IdPs that a relying party (RP) website can use to sign users in. It causes a <code>get()</code> call to initiate a request for a user to sign in to an RP with an IdP.</p>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"examples","title":"Examples","isH3":false,"content":"<ul>\n  <li><a href=\"https://fedcm-rp-demo.glitch.me/\" class=\"external\" target=\"_blank\">FedCM sign-in example</a>\n    <ul>\n      <li><a href=\"https://glitch.com/edit/#!/fedcm-rp-demo?path=server.js%3A1%3A0\" class=\"external\" target=\"_blank\">RP source code</a></li>\n      <li><a href=\"https://glitch.com/edit/#!/fedcm-idp-demo?path=server.js%3A1%3A0\" class=\"external\" target=\"_blank\">IdP source code</a></li>\n    </ul>\n  </li>\n  <li><a href=\"https://fedcm-main-frame.glitch.me/\" class=\"external\" target=\"_blank\">FedCM <code>&lt;iframe&gt;</code> sign-in</a>\n    <ul>\n      <li><a href=\"https://glitch.com/edit/#!/fedcm-main-frame?path=index.html%3A1%3A0\" class=\"external\" target=\"_blank\">RP <code>&lt;iframe&gt;</code> page source code</a></li>\n      <li><a href=\"https://glitch.com/edit/#!/webid-fcm-idp-single?path=server.js%3A1%3A0\" class=\"external\" target=\"_blank\">IdP source code</a></li>\n    </ul>\n  </li>\n</ul>"}},{"type":"specifications","value":{"title":"Specifications","id":"specifications","isH3":false,"specifications":[{"bcdSpecificationURL":"https://fedidcg.github.io/FedCM/#browser-api-identity-credential-interface","title":"Federated Credential Management API"}],"query":"api.IdentityCredential"}},{"type":"browser_compatibility","value":{"title":"Browser compatibility","id":"browser_compatibility","isH3":false,"query":"api.IdentityCredential"}},{"type":"prose","value":{"id":"see_also","title":"See also","isH3":false,"content":"<ul>\n  <li><a href=\"https://developer.chrome.com/docs/privacy-sandbox/fedcm/\" class=\"external\" target=\"_blank\">Federated Credential Management API</a></li>\n</ul>"}}],"toc":[{"text":"FedCM concepts","id":"fedcm_concepts"},{"text":"IdP integration with FedCM","id":"idp_integration_with_fedcm"},{"text":"RP sign-in using the JavaScript API","id":"rp_sign-in_using_the_javascript_api"},{"text":"Permissions Policy integration and IFrame support","id":"permissions_policy_integration_and_iframe_support"},{"text":"Interfaces","id":"interfaces"},{"text":"Extensions to other interfaces","id":"extensions_to_other_interfaces"},{"text":"Examples","id":"examples"},{"text":"Specifications","id":"specifications"},{"text":"Browser compatibility","id":"browser_compatibility"},{"text":"See also","id":"see_also"}],"summary":"The Federated Credential Management API (or FedCM API) provides a standard mechanism for identity providers (IdPs) to make identity federation services available on the web in a privacy-preserving way, without the need for third-party cookies and redirects. This includes a JavaScript API that enables the use of federated authentication for activities such as signing in or signing up on a website.","popularity":0.0053,"modified":"2023-10-25T17:27:32.000Z","source":{"folder":"en-us/web/api/fedcm_api","github_url":"https://github.com/mdn/content/blob/main/files/en-us/web/api/fedcm_api/index.md","last_commit_url":"https://github.com/mdn/content/commit/835d6632d59993861a0458510402787f8a2c3cb3","filename":"index.md"},"short_title":"Federated Credential Management (FedCM) API","parents":[{"uri":"/en-US/docs/Web","title":"References"},{"uri":"/en-US/docs/Web/API","title":"Web APIs"},{"uri":"/en-US/docs/Web/API/FedCM_API","title":"Federated Credential Management (FedCM) API"}],"pageTitle":"Federated Credential Management (FedCM) API - Web APIs | MDN","noIndexing":false}}