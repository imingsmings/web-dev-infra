<!doctype html><html lang="en-US" prefix="og: https://ogp.me/ns#"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><link rel="icon" href="/favicon-48x48.cbbd161b.png"/><link rel="apple-touch-icon" href="/apple-touch-icon.6803c6f0.png"/><meta name="theme-color" content="#ffffff"/><link rel="manifest" href="/manifest.56b1cedc.json"/><link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="MDN Web Docs"/><title>Spaces and reference spaces: Spatial tracking in WebXR - Web APIs | MDN</title><link rel="alternate" type="application/rss+xml" title="MDN Blog RSS Feed" href="https://developer.mozilla.org/en-US/blog/rss.xml" hreflang="en" /><meta name="robots" content="noindex, nofollow"><meta name="description" content="The WebXR APIs used for implementing augmented and virtual reality is designed specifically to provide the ability to insert a human into a virtual environment. To accomplish this, software needs the ability to not only track the locations, orientation, and movements of objects in the virtual world, but the user&apos;s location, orientation, and movement as well. But WebXR goes beyond that by adding the ability to track the location, orientation, and motion of the input devices which generate data used to determine the position and movement of individual parts of the viewer&apos;s body (with appropriate equipment)."/><meta property="og:url" content="https://developer.mozilla.org/en-US/docs/Web/API/WebXR_Device_API/Spatial_tracking"/><meta property="og:title" content="Spaces and reference spaces: Spatial tracking in WebXR - Web APIs | MDN"/><meta property="og:type" content="website"/><meta property="og:locale" content="en_US"/><meta property="og:description" content="The WebXR APIs used for implementing augmented and virtual reality is designed specifically to provide the ability to insert a human into a virtual environment. To accomplish this, software needs the ability to not only track the locations, orientation, and movements of objects in the virtual world, but the user&apos;s location, orientation, and movement as well. But WebXR goes beyond that by adding the ability to track the location, orientation, and motion of the input devices which generate data used to determine the position and movement of individual parts of the viewer&apos;s body (with appropriate equipment)."/><meta property="og:image" content="https://developer.mozilla.org/mdn-social-share.cd6c4a5a.png"/><meta property="og:image:type" content="image/png"/><meta property="og:image:height" content="1080"/><meta property="og:image:width" content="1920"/><meta property="og:image:alt" content="The MDN Web Docs logo, featuring a blue accent color, displayed on a solid black background."/><meta property="og:site_name" content="MDN Web Docs"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:creator" content="MozDevNet"/><link rel="canonical" href="https://developer.mozilla.org/en-US/docs/Web/API/WebXR_Device_API/Spatial_tracking"/><style media="print">.article-actions-container,.document-toc-container,.language-menu,.main-menu-toggle,.on-github,.page-footer,.place,.sidebar,.top-banner,.top-navigation-main,ul.prev-next{display:none!important}.main-page-content,.main-page-content pre{padding:2px}.main-page-content pre{border-left-width:2px}</style><script defer="defer" src="/static/js/main.8204838d.js"></script><link href="/static/css/main.3551aa81.css" rel="stylesheet"></head><body><script>if(document.body.addEventListener("load",(t=>{t.target.classList.contains("interactive")&&t.target.setAttribute("data-readystate","complete")}),{capture:!0}),window&&document.documentElement){const t={light:"#ffffff",dark:"#1b1b1b"};try{const e=window.localStorage.getItem("theme");e&&(document.documentElement.className=e,document.documentElement.style.backgroundColor=t[e])}catch(t){console.warn("Unable to read theme from localStorage",t)}}</script><div id="root"><ul id="nav-access" class="a11y-nav"><li><a id="skip-main" href="#content">Skip to main content</a></li><li><a id="skip-search" href="#top-nav-search-input">Skip to search</a></li><li><a id="skip-select-language" href="#languages-switcher-button">Skip to select language</a></li></ul><div class="page-wrapper  category-api document-page"><div class="top-banner loading"><section class="place top container"></section></div><div class="sticky-header-container"><header class="top-navigation 
      
      "><div class="container "><div class="top-navigation-wrap"><a href="/en-US/" class="logo" aria-label="MDN homepage"><svg id="mdn-docs-logo" xmlns="http://www.w3.org/2000/svg" x="0" y="0" viewBox="0 0 694.9 104.4" style="enable-background:new 0 0 694.9 104.4" xml:space="preserve" role="img"><title>MDN Web Docs</title><path d="M40.3 0 11.7 92.1H0L28.5 0h11.8zm10.4 0v92.1H40.3V0h10.4zM91 0 62.5 92.1H50.8L79.3 0H91zm10.4 0v92.1H91V0h10.4z" class="logo-m"></path><path d="M627.9 95.6h67v8.8h-67v-8.8z" class="logo-_"></path><path d="M367 42h-4l-10.7 30.8h-5.5l-10.8-26h-.4l-10.5 26h-5.2L308.7 42h-3.8v-5.6H323V42h-6.5l6.8 20.4h.4l10.3-26h4.7l11.2 26h.5l5.7-20.3h-6.2v-5.6H367V42zm34.9 20c-.4 3.2-2 5.9-4.7 8.2-2.8 2.3-6.5 3.4-11.3 3.4-5.4 0-9.7-1.6-13.1-4.7-3.3-3.2-5-7.7-5-13.7 0-5.7 1.6-10.3 4.7-14s7.4-5.5 12.9-5.5c5.1 0 9.1 1.6 11.9 4.7s4.3 6.9 4.3 11.3c0 1.5-.2 3-.5 4.7h-25.6c.3 7.7 4 11.6 10.9 11.6 2.9 0 5.1-.7 6.5-2 1.5-1.4 2.5-3 3-4.9l6 .9zM394 51.3c.2-2.4-.4-4.7-1.8-6.9s-3.8-3.3-7-3.3c-3.1 0-5.3 1-6.9 3-1.5 2-2.5 4.4-2.8 7.2H394zm51 2.4c0 5-1.3 9.5-4 13.7s-6.9 6.2-12.7 6.2c-6 0-10.3-2.2-12.7-6.7-.1.4-.2 1.4-.4 2.9s-.3 2.5-.4 2.9h-7.3c.3-1.7.6-3.5.8-5.3.3-1.8.4-3.7.4-5.5V22.3h-6v-5.6H416v27c1.1-2.2 2.7-4.1 4.7-5.7 2-1.6 4.8-2.4 8.4-2.4 4.6 0 8.4 1.6 11.4 4.7 3 3.2 4.5 7.6 4.5 13.4zm-7.7.6c0-4.2-1-7.4-3-9.5-2-2.2-4.4-3.3-7.4-3.3-3.4 0-6 1.2-8 3.7-1.9 2.4-2.9 5-3 7.7V57c0 3 1 5.6 3 7.7s4.5 3.1 7.6 3.1c3.6 0 6.3-1.3 8.1-3.9 1.8-2.7 2.7-5.9 2.7-9.6zm69.2 18.5h-13.2v-7.2c-1.2 2.2-2.8 4.1-4.9 5.6-2.1 1.6-4.8 2.4-8.3 2.4-4.8 0-8.7-1.6-11.6-4.9-2.9-3.2-4.3-7.7-4.3-13.3 0-5 1.3-9.6 4-13.7 2.6-4.1 6.9-6.2 12.8-6.2 5.7 0 9.8 2.2 12.3 6.5V22.3h-8.6v-5.6h15.8v50.6h6v5.5zM493.2 56v-4.4c-.1-3-1.2-5.5-3.2-7.3s-4.4-2.8-7.2-2.8c-3.6 0-6.3 1.3-8.2 3.9-1.9 2.6-2.8 5.8-2.8 9.6 0 4.1 1 7.3 3 9.5s4.5 3.3 7.4 3.3c3.2 0 5.8-1.3 7.8-3.8 2.1-2.6 3.1-5.3 3.2-8zm53.1-1.4c0 5.6-1.8 10.2-5.3 13.7s-8.2 5.3-13.9 5.3-10.1-1.7-13.4-5.1c-3.3-3.4-5-7.9-5-13.5 0-5.3 1.6-9.9 4.7-13.7 3.2-3.8 7.9-5.7 14.2-5.7s11 1.9 14.1 5.7c3 3.7 4.6 8.1 4.6 13.3zm-7.7-.2c0-4-1-7.2-3-9.5s-4.8-3.5-8.2-3.5c-3.6 0-6.4 1.2-8.3 3.7s-2.9 5.6-2.9 9.5c0 3.7.9 6.8 2.8 9.4 1.9 2.6 4.6 3.9 8.3 3.9 3.6 0 6.4-1.3 8.4-3.8 1.9-2.6 2.9-5.8 2.9-9.7zm45 5.8c-.4 3.2-1.9 6.3-4.4 9.1-2.5 2.9-6.4 4.3-11.8 4.3-5.2 0-9.4-1.6-12.6-4.8-3.2-3.2-4.8-7.7-4.8-13.7 0-5.5 1.6-10.1 4.7-13.9 3.2-3.8 7.6-5.7 13.2-5.7 2.3 0 4.6.3 6.7.8 2.2.5 4.2 1.5 6.2 2.9l1.5 9.5-5.9.7-1.3-6.1c-2.1-1.2-4.5-1.8-7.2-1.8-3.5 0-6.1 1.2-7.7 3.7-1.7 2.5-2.5 5.7-2.5 9.6 0 4.1.9 7.3 2.7 9.5 1.8 2.3 4.4 3.4 7.8 3.4 5.2 0 8.2-2.9 9.2-8.8l6.2 1.3zm34.7 1.9c0 3.6-1.5 6.5-4.6 8.5s-7 3-11.7 3c-5.7 0-10.6-1.2-14.6-3.6l1.2-8.8 5.7.6-.2 4.7c1.1.5 2.3.9 3.6 1.1s2.6.3 3.9.3c2.4 0 4.5-.4 6.5-1.3 1.9-.9 2.9-2.2 2.9-4.1 0-1.8-.8-3.1-2.3-3.8s-3.5-1.3-5.8-1.7-4.6-.9-6.9-1.4c-2.3-.6-4.2-1.6-5.7-2.9-1.6-1.4-2.3-3.5-2.3-6.3 0-4.1 1.5-6.9 4.6-8.5s6.4-2.4 9.9-2.4c2.6 0 5 .3 7.2.9 2.2.6 4.3 1.4 6.1 2.4l.8 8.8-5.8.7-.8-5.7c-2.3-1-4.7-1.6-7.2-1.6-2.1 0-3.7.4-5.1 1.1-1.3.8-2 2-2 3.8 0 1.7.8 2.9 2.3 3.6 1.5.7 3.4 1.2 5.7 1.6 2.2.4 4.5.8 6.7 1.4 2.2.6 4.1 1.6 5.7 3 1.4 1.6 2.2 3.7 2.2 6.6zM197.6 73.2h-17.1v-5.5h3.8V51.9c0-3.7-.7-6.3-2.1-7.9-1.4-1.6-3.3-2.3-5.7-2.3-3.2 0-5.6 1.1-7.2 3.4s-2.4 4.6-2.5 6.9v15.6h6v5.5h-17.1v-5.5h3.8V51.9c0-3.8-.7-6.4-2.1-7.9-1.4-1.5-3.3-2.3-5.6-2.3-3.2 0-5.5 1.1-7.2 3.3-1.6 2.2-2.4 4.5-2.5 6.9v15.8h6.9v5.5h-20.2v-5.5h6V42.4h-6.1v-5.6h13.4v6.4c1.2-2.1 2.7-3.8 4.7-5.2 2-1.3 4.4-2 7.3-2s5.3.7 7.5 2.1c2.2 1.4 3.7 3.5 4.5 6.4 1.1-2.5 2.7-4.5 4.9-6.1s4.8-2.4 7.9-2.4c3.5 0 6.5 1.1 8.9 3.3s3.7 5.6 3.7 10.2v18.2h6.1v5.5zm42.5 0h-13.2V66c-1.2 2.2-2.8 4.1-4.9 5.6-2.1 1.6-4.8 2.4-8.3 2.4-4.8 0-8.7-1.6-11.6-4.9-2.9-3.2-4.3-7.7-4.3-13.3 0-5 1.3-9.6 4-13.7 2.6-4.1 6.9-6.2 12.8-6.2s9.8 2.2 12.3 6.5V22.7h-8.6v-5.6h15.8v50.6h6v5.5zm-13.3-16.8V52c-.1-3-1.2-5.5-3.2-7.3s-4.4-2.8-7.2-2.8c-3.6 0-6.3 1.3-8.2 3.9-1.9 2.6-2.8 5.8-2.8 9.6 0 4.1 1 7.3 3 9.5s4.5 3.3 7.4 3.3c3.2 0 5.8-1.3 7.8-3.8 2.1-2.6 3.1-5.3 3.2-8zm61.5 16.8H269v-5.5h6V51.9c0-3.7-.7-6.3-2.2-7.9-1.4-1.6-3.4-2.3-5.7-2.3-3.1 0-5.6 1-7.4 3s-2.8 4.4-2.9 7v15.9h6v5.5h-19.3v-5.5h6V42.4h-6.2v-5.6h13.6V43c2.6-4.6 6.8-6.9 12.7-6.9 3.6 0 6.7 1.1 9.2 3.3s3.7 5.6 3.7 10.2v18.2h6v5.4h-.2z" class="logo-text"></path></svg></a><button title="Open main menu" type="button" class="button action has-icon main-menu-toggle" aria-haspopup="menu" aria-label="Open main menu" aria-expanded="false"><span class="button-wrap"><span class="icon icon-menu "></span><span class="visually-hidden">Open main menu</span></span></button></div><div class="top-navigation-main"><nav class="main-nav" aria-label="Main menu"><ul class="main-menu nojs"><li class="top-level-entry-container active"><button type="button" id="references-button" class="top-level-entry menu-toggle" aria-controls="references-menu" aria-expanded="false">References</button><a href="/en-US/docs/Web" class="top-level-entry">References</a><ul id="references-menu" class="submenu references hidden inline-submenu-lg" aria-labelledby="references-button"><li class="apis-link-container mobile-only "><a href="/en-US/docs/Web" class="submenu-item "><div class="submenu-icon"></div><div class="submenu-content-container"><div class="submenu-item-heading">Overview / Web Technology</div><p class="submenu-item-description">Web technology reference for developers</p></div></a></li><li class="html-link-container "><a href="/en-US/docs/Web/HTML" class="submenu-item "><div class="submenu-icon html"></div><div class="submenu-content-container"><div class="submenu-item-heading">HTML</div><p class="submenu-item-description">Structure of content on the web</p></div></a></li><li class="css-link-container "><a href="/en-US/docs/Web/CSS" class="submenu-item "><div class="submenu-icon css"></div><div class="submenu-content-container"><div class="submenu-item-heading">CSS</div><p class="submenu-item-description">Code used to describe document style</p></div></a></li><li class="javascript-link-container "><a href="/en-US/docs/Web/JavaScript" class="submenu-item "><div class="submenu-icon javascript"></div><div class="submenu-content-container"><div class="submenu-item-heading">JavaScript</div><p class="submenu-item-description">General-purpose scripting language</p></div></a></li><li class="http-link-container "><a href="/en-US/docs/Web/HTTP" class="submenu-item "><div class="submenu-icon http"></div><div class="submenu-content-container"><div class="submenu-item-heading">HTTP</div><p class="submenu-item-description">Protocol for transmitting web resources</p></div></a></li><li class="apis-link-container "><a href="/en-US/docs/Web/API" class="submenu-item "><div class="submenu-icon apis"></div><div class="submenu-content-container"><div class="submenu-item-heading">Web APIs</div><p class="submenu-item-description">Interfaces for building web applications</p></div></a></li><li class="apis-link-container "><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions" class="submenu-item "><div class="submenu-icon"></div><div class="submenu-content-container"><div class="submenu-item-heading">Web Extensions</div><p class="submenu-item-description">Developing extensions for web browsers</p></div></a></li><li class="apis-link-container desktop-only "><a href="/en-US/docs/Web" class="submenu-item "><div class="submenu-icon"></div><div class="submenu-content-container"><div class="submenu-item-heading">Web Technology</div><p class="submenu-item-description">Web technology reference for developers</p></div></a></li></ul></li><li class="top-level-entry-container "><button type="button" id="guides-button" class="top-level-entry menu-toggle" aria-controls="guides-menu" aria-expanded="false">Guides</button><a href="/en-US/docs/Learn" class="top-level-entry">Guides</a><ul id="guides-menu" class="submenu guides hidden inline-submenu-lg" aria-labelledby="guides-button"><li class="apis-link-container mobile-only "><a href="/en-US/docs/Learn" class="submenu-item "><div class="submenu-icon learn"></div><div class="submenu-content-container"><div class="submenu-item-heading">Overview / MDN Learning Area</div><p class="submenu-item-description">Learn web development</p></div></a></li><li class="apis-link-container desktop-only "><a href="/en-US/docs/Learn" class="submenu-item "><div class="submenu-icon learn"></div><div class="submenu-content-container"><div class="submenu-item-heading">MDN Learning Area</div><p class="submenu-item-description">Learn web development</p></div></a></li><li class="html-link-container "><a href="/en-US/docs/Learn/HTML" class="submenu-item "><div class="submenu-icon html"></div><div class="submenu-content-container"><div class="submenu-item-heading">HTML</div><p class="submenu-item-description">Learn to structure web content with HTML</p></div></a></li><li class="css-link-container "><a href="/en-US/docs/Learn/CSS" class="submenu-item "><div class="submenu-icon css"></div><div class="submenu-content-container"><div class="submenu-item-heading">CSS</div><p class="submenu-item-description">Learn to style content using CSS</p></div></a></li><li class="javascript-link-container "><a href="/en-US/docs/Learn/JavaScript" class="submenu-item "><div class="submenu-icon javascript"></div><div class="submenu-content-container"><div class="submenu-item-heading">JavaScript</div><p class="submenu-item-description">Learn to run scripts in the browser</p></div></a></li><li class=" "><a href="/en-US/docs/Web/Accessibility" class="submenu-item "><div class="submenu-icon"></div><div class="submenu-content-container"><div class="submenu-item-heading">Accessibility</div><p class="submenu-item-description">Learn to make the web accessible to all</p></div></a></li></ul></li><li class="top-level-entry-container "><a class="top-level-entry menu-link" href="/en-US/blog/">Blog</a></li><li class="top-level-entry-container "><a class="top-level-entry menu-link" href="/en-US/play">Play</a></li><li class="top-level-entry-container "><a class="top-level-entry menu-link" href="/en-US/plus/ai-help">AI Help <sup class="new beta">Beta</sup></a></li></ul></nav><div class="header-search"><form action="/en-US/search" class="search-form search-widget" id="top-nav-search-form" role="search"><label id="top-nav-search-label" for="top-nav-search-input" class="visually-hidden">Search MDN</label><input aria-activedescendant="" aria-autocomplete="list" aria-controls="top-nav-search-menu" aria-expanded="false" aria-labelledby="top-nav-search-label" autoComplete="off" id="top-nav-search-input" role="combobox" type="search" class="search-input-field" name="q" placeholder="   " required="" value=""/><button type="button" class="button action has-icon clear-search-button"><span class="button-wrap"><span class="icon icon-cancel "></span><span class="visually-hidden">Clear search input</span></span></button><button type="submit" class="button action has-icon search-button"><span class="button-wrap"><span class="icon icon-search "></span><span class="visually-hidden">Search</span></span></button><div id="top-nav-search-menu" role="listbox" aria-labelledby="top-nav-search-label"></div></form></div><div class="theme-switcher-menu"><button type="button" class="button action has-icon theme-switcher-menu small" aria-haspopup="menu"><span class="button-wrap"><span class="icon icon-theme-os-default "></span>Theme</span></button></div><ul class="auth-container"><li><a href="?next=%2Fen-US%2Fdocs%2FWeb%2FAPI%2FWebXR_Device_API%2FSpatial_tracking" class="login-link" rel="nofollow">Log in</a></li><li><a href="?next=%2Fen-US%2Fdocs%2FWeb%2FAPI%2FWebXR_Device_API%2FSpatial_tracking" target="_self" class="button primary mdn-plus-subscribe-link"><span class="button-wrap">Sign up for free</span></a></li></ul></div></div></header><div class="article-actions-container"><div class="container"><button type="button" class="button action has-icon sidebar-button" aria-label="Expand sidebar" aria-expanded="false" aria-controls="sidebar-quicklinks"><span class="button-wrap"><span class="icon icon-sidebar "></span></span></button><nav class="breadcrumbs-container" aria-label="Breadcrumb"><ol typeof="BreadcrumbList" vocab="https://schema.org/" aria-label="breadcrumbs"><li property="itemListElement" typeof="ListItem"><a class="breadcrumb" property="item" typeof="WebPage" href="/en-US/docs/Web"><span property="name">References</span></a><meta property="position" content="1"/></li><li property="itemListElement" typeof="ListItem"><a class="breadcrumb" property="item" typeof="WebPage" href="/en-US/docs/Web/API"><span property="name">Web APIs</span></a><meta property="position" content="2"/></li><li property="itemListElement" typeof="ListItem"><a class="breadcrumb" property="item" typeof="WebPage" href="/en-US/docs/Web/API/WebXR_Device_API"><span property="name">WebXR Device API</span></a><meta property="position" content="3"/></li><li property="itemListElement" typeof="ListItem"><a class="breadcrumb-current-page" property="item" typeof="WebPage" href="/en-US/docs/Web/API/WebXR_Device_API/Spatial_tracking"><span property="name">Spaces and reference spaces: Spatial tracking in WebXR</span></a><meta property="position" content="4"/></li></ol></nav></div></div></div><div class="main-wrapper"><div class="sidebar-container"><aside id="sidebar-quicklinks" class="sidebar" data-macro="DefaultAPISidebar"><button type="button" class="button action backdrop" aria-label="Collapse sidebar"><span class="button-wrap"></span></button><nav aria-label="Related Topics" class="sidebar-inner"><header class="sidebar-actions"><section class="sidebar-filter-container"><div class="sidebar-filter "><label id="sidebar-filter-label" class="sidebar-filter-label" for="sidebar-filter-input"><span class="icon icon-filter"></span><span class="visually-hidden">Filter sidebar</span></label><input id="sidebar-filter-input" autoComplete="off" class="sidebar-filter-input-field false" type="text" placeholder="Filter" value=""/><button type="button" class="button action has-icon clear-sidebar-filter-button"><span class="button-wrap"><span class="icon icon-cancel "></span><span class="visually-hidden">Clear filter input</span></span></button></div></section></header><div class="sidebar-inner-nav"><div class="in-nav-toc"><div class="document-toc-container"><section class="document-toc"><header><h2 class="document-toc-heading">In this article</h2></header><ul class="document-toc-list"><li class="document-toc-item "><a class="document-toc-link" href="#representing_a_position_using_a_reference_space">Representing a position using a reference space</a></li><li class="document-toc-item "><a class="document-toc-link" href="#describing_a_position_relative_to_a_space">Describing a position relative to a space</a></li><li class="document-toc-item "><a class="document-toc-link" href="#offsetting_or_moving_reference_spaces">Offsetting or moving reference spaces</a></li><li class="document-toc-item "><a class="document-toc-link" href="#continuity_and_recovery_after_tracking_loss">Continuity and recovery after tracking loss</a></li><li class="document-toc-item "><a class="document-toc-link" href="#see_also">See also</a></li></ul></section></div></div><div class="sidebar-body"><ol><li><strong><a href="/en-US/docs/Web/API/WebXR_Device_API">WebXR Device API</a></strong></li><li class="toggle"><details open=""><summary>Guides</summary><ol><li><a href="/en-US/docs/Web/API/WebXR_Device_API/Fundamentals">Fundamentals of WebXR</a></li><li><a href="/en-US/docs/Web/API/WebXR_Device_API/Lifecycle">WebXR application life cycle</a></li><li><a href="/en-US/docs/Web/API/WebXR_Device_API/Startup_and_shutdown">Starting up and shutting down a WebXR session</a></li><li><a href="/en-US/docs/Web/API/WebXR_Device_API/Cameras">Viewpoints and viewers: Simulating cameras in WebXR</a></li><li><a href="/en-US/docs/Web/API/WebXR_Device_API/Geometry">Geometry and reference spaces in WebXR</a></li><li><em><a href="/en-US/docs/Web/API/WebXR_Device_API/Spatial_tracking" aria-current="page">Spaces and reference spaces: Spatial tracking in WebXR</a></em></li></ol></details></li><li class="toggle"><details open=""><summary>Interfaces</summary><ol><li><a href="/en-US/docs/Web/API/XRAnchor"><code>XRAnchor</code></a></li><li><a href="/en-US/docs/Web/API/XRBoundedReferenceSpace"><code>XRBoundedReferenceSpace</code></a></li><li><a href="/en-US/docs/Web/API/XRCPUDepthInformation"><code>XRCPUDepthInformation</code></a></li><li><a href="/en-US/docs/Web/API/XRDepthInformation"><code>XRDepthInformation</code></a></li><li><a href="/en-US/docs/Web/API/XRFrame"><code>XRFrame</code></a></li><li><a href="/en-US/docs/Web/API/XRInputSource"><code>XRInputSource</code></a></li><li><a href="/en-US/docs/Web/API/XRInputSourceArray"><code>XRInputSourceArray</code></a></li><li><a href="/en-US/docs/Web/API/XRInputSourceEvent"><code>XRInputSourceEvent</code></a></li><li><a href="/en-US/docs/Web/API/XRInputSourcesChangeEvent"><code>XRInputSourcesChangeEvent</code></a></li><li><a href="/en-US/docs/Web/API/XRPose"><code>XRPose</code></a></li><li><a href="/en-US/docs/Web/API/XRReferenceSpace"><code>XRReferenceSpace</code></a></li><li><a href="/en-US/docs/Web/API/XRReferenceSpaceEvent"><code>XRReferenceSpaceEvent</code></a></li><li><a href="/en-US/docs/Web/API/XRRenderState"><code>XRRenderState</code></a></li><li><a href="/en-US/docs/Web/API/XRRigidTransform"><code>XRRigidTransform</code></a></li><li><a href="/en-US/docs/Web/API/XRSession"><code>XRSession</code></a></li><li><a href="/en-US/docs/Web/API/XRSessionEvent"><code>XRSessionEvent</code></a></li><li><a href="/en-US/docs/Web/API/XRSpace"><code>XRSpace</code></a></li><li><a href="/en-US/docs/Web/API/XRSystem"><code>XRSystem</code></a></li><li><a href="/en-US/docs/Web/API/XRView"><code>XRView</code></a></li><li><a href="/en-US/docs/Web/API/XRViewerPose"><code>XRViewerPose</code></a></li><li><a href="/en-US/docs/Web/API/XRViewport"><code>XRViewport</code></a></li><li><a href="/en-US/docs/Web/API/XRWebGLBinding"><code>XRWebGLBinding</code></a></li><li><a href="/en-US/docs/Web/API/XRWebGLDepthInformation"><code>XRWebGLDepthInformation</code></a></li><li><a href="/en-US/docs/Web/API/XRWebGLLayer"><code>XRWebGLLayer</code></a></li></ol></details></li><li class="toggle"><details open=""><summary>Properties</summary><ol><li><a href="/en-US/docs/Web/API/Navigator/xr"><code>Navigator.xr</code></a></li></ol></details></li><li class="toggle"><details open=""><summary>Methods</summary><ol><li><a href="/en-US/docs/Web/API/WebGLRenderingContext/makeXRCompatible"><code>WebGLRenderingContext.makeXRCompatible()</code></a></li></ol></details></li><li class="toggle"><details open=""><summary>Events</summary><ol><li><a href="/en-US/docs/Web/API/XRReferenceSpace/reset_event"><code>XRReferenceSpace</code>: <code>reset</code></a></li><li><a href="/en-US/docs/Web/API/XRSession/end_event"><code>XRSession</code>: <code>end</code></a></li><li><a href="/en-US/docs/Web/API/XRSession/inputsourceschange_event"><code>XRSession</code>: <code>inputsourceschange</code></a></li><li><a href="/en-US/docs/Web/API/XRSession/select_event"><code>XRSession</code>: <code>select</code></a></li><li><a href="/en-US/docs/Web/API/XRSession/selectend_event"><code>XRSession</code>: <code>selectend</code></a></li><li><a href="/en-US/docs/Web/API/XRSession/selectstart_event"><code>XRSession</code>: <code>selectstart</code></a></li><li><a href="/en-US/docs/Web/API/XRSession/visibilitychange_event"><code>XRSession</code>: <code>visibilitychange</code></a></li><li><a href="/en-US/docs/Web/API/XRSystem/devicechange_event"><code>XRSystem</code>: <code>devicechange</code></a></li></ol></details></li></ol></div></div></nav></aside><div class="toc-container"><aside class="toc"><nav><div class="document-toc-container"><section class="document-toc"><header><h2 class="document-toc-heading">In this article</h2></header><ul class="document-toc-list"><li class="document-toc-item "><a class="document-toc-link" href="#representing_a_position_using_a_reference_space">Representing a position using a reference space</a></li><li class="document-toc-item "><a class="document-toc-link" href="#describing_a_position_relative_to_a_space">Describing a position relative to a space</a></li><li class="document-toc-item "><a class="document-toc-link" href="#offsetting_or_moving_reference_spaces">Offsetting or moving reference spaces</a></li><li class="document-toc-item "><a class="document-toc-link" href="#continuity_and_recovery_after_tracking_loss">Continuity and recovery after tracking loss</a></li><li class="document-toc-item "><a class="document-toc-link" href="#see_also">See also</a></li></ul></section></div></nav></aside></div></div><main id="content" class="main-content  "><article class="main-page-content" lang="en-US"><header><h1>Spaces and reference spaces: Spatial tracking in WebXR</h1></header><div class="section-content"><p>The WebXR APIs used for implementing augmented and virtual reality is designed specifically to provide the ability to insert a human into a virtual environment. To accomplish this, software needs the ability to not only track the locations, orientation, and movements of objects in the virtual world, but the user's location, orientation, and movement as well. But WebXR goes beyond that by adding the ability to track the location, orientation, and motion of the input devices which generate data used to determine the position and movement of individual parts of the viewer's body (with appropriate equipment).</p>
<p>The location and movement of the user's headset represent their head's position and orientation in the virtual environment. Hand controllers represent their hands in the same manner. Other hardware elements can be used similarly to represent other parts of the body, providing additional data to use when simulating the user's actions in their environment.</p>
<p>In this guide, we'll explore how WebXR uses <strong>spaces</strong> and, more specifically, <strong>reference spaces</strong>, to track the positions, orientations, and movements of objects and of the user's body in the virtual world.</p>
<div class="notecard note" id="sect1">
  <p><strong>Note:</strong> This article presumes that you are familiar with the concepts introduced in <a href="/en-US/docs/Web/API/WebXR_Device_API/Geometry">Geometry and reference spaces in WebXR</a>: that is, the basics of 3D coordinate systems, as well as WebXR spaces, reference spaces, and how reference spaces are used to create local coordinate systems for individual objects or movable components within a scene.</p>
</div></div><section aria-labelledby="representing_a_position_using_a_reference_space"><h2 id="representing_a_position_using_a_reference_space"><a href="#representing_a_position_using_a_reference_space">Representing a position using a reference space</a></h2><div class="section-content"><p>As covered in <a href="/en-US/docs/Web/API/WebXR_Device_API/Geometry#defining_spatial_relationships_with_reference_spaces">Defining spatial relationships with reference spaces</a>, reference spaces establish a local coordinate system which is offset from another coordinate system that is itself defined by some other space. Thus, a reference space can be used to define the position and orientation of a point and by extension the entire object for which that point is the origin. While this is a little heavy-handed to be used for every single object in a scene, it can be very useful for a few specific objects to have their own coordinate system in this manner.</p>
<ul>
  <li><strong>The world space</strong>; the origin of this space is the origin of the <a href="/en-US/docs/Web/API/WebGL_API/WebGL_model_view_projection">WebGL coordinate system</a> underlying the entire 3D canvas.</li>
  <li>The player, avatar, or camera; the origin of this space is used as the camera position for rendering the scene to be displayed to the user.</li>
  <li>The hand and/or hand controller; each of these represents one of the user's hands, either in the form of the hand itself or a controller (or both). The origin is generally the center of the user's fisted hand.</li>
  <li><strong>The target ray</strong>; each controller or other handheld device may have a targeting ray associated with it, which is represented by a space whose origin is at the point on the controller at which the ray is emitted, and is oriented so that -Z extends in the direction of the target it's pointing at.</li>
</ul>
<p>Because each of these is defined using a reference space as its foundation, the WebXR Device API can easily be used to convert among the coordinate systems, perform operations affecting these spaces and their corresponding objects, and so forth.</p></div></section><section aria-labelledby="describing_a_position_relative_to_a_space"><h2 id="describing_a_position_relative_to_a_space"><a href="#describing_a_position_relative_to_a_space">Describing a position relative to a space</a></h2><div class="section-content"><p>There are two scenarios in which you may need to describe a position and/or orientation relative to a space. The first is <a href="#offsetting_or_moving_reference_spaces">described above</a>: applying a reference space to an offset (or vice versa, since the result is the same) to determine the transform matrix that represents the resulting location in the space's coordinate system.</p></div></section><section aria-labelledby="poses"><h3 id="poses"><a href="#poses">Poses</a></h3><div class="section-content"><p>Once your reference space or spaces are established for the various key objects in the scene, you will have times when you need to describe another position relative to the origin of a particular reference space. This is done using poses. A pose, put, describes a position and orientation relative to the origin of the reference space from which it was created.</p>
<p>In WebXR, a pose is represented by an <a href="/en-US/docs/Web/API/XRPose"><code>XRPose</code></a> object, whose <a href="/en-US/docs/Web/API/XRPose/transform" title="transform"><code>transform</code></a> property is an <a href="/en-US/docs/Web/API/XRRigidTransform"><code>XRRigidTransform</code></a> defining the transform matrix that, applied to any coordinate, vector, or matrix in the original space, converts it to the target space. Thus a pose can be used to not only convert and determine positions, but also rotational information.</p>
<p>There is only one way to create an <a href="/en-US/docs/Web/API/XRPose"><code>XRPose</code></a>, and that's using the <a href="/en-US/docs/Web/API/XRFrame/getPose" title="getPose()"><code>getPose()</code></a> method on an animation frame as given using an <a href="/en-US/docs/Web/API/XRFrame"><code>XRFrame</code></a> object. This means that most frequently, you'll be using poses within your frame rendering code, which is executed as a callback from the <a href="/en-US/docs/Web/API/XRFrame"><code>XRFrame</code></a> method <a href="/en-US/docs/Web/API/XRSession/requestAnimationFrame" title="requestAnimationFrame()"><code>requestAnimationFrame()</code></a>.</p>
<p><code>getPose()</code> computes the position of an <a href="/en-US/docs/Web/API/XRReferenceSpace"><code>XRReferenceSpace</code></a> relative to the origin of a specified <a href="/en-US/docs/Web/API/XRSpace"><code>XRSpace</code></a> and then creates a pose representing the resulting position and orientation.</p>
<p>For example, if you wish to draw a hand controller's representation using the controller's <a href="/en-US/docs/Web/API/XRInputSource/gripSpace" title="gripSpace"><code>gripSpace</code></a>, you can get the pose needed like this:</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code><span class="token keyword">let</span> controlPose <span class="token operator">=</span> frame<span class="token punctuation">.</span><span class="token function">getPose</span><span class="token punctuation">(</span>inputSource<span class="token punctuation">.</span>gripSpace<span class="token punctuation">,</span> worldRefSpace<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>This converts the position and orientation of the input's grip space to use the world's coordinate system, then generates the corresponding <code>XRPose</code>, storing it in <code>controlPose</code>. You can then apply <code>controlPose</code>'s <a href="/en-US/docs/Web/API/XRPose/transform" title="transform"><code>transform</code></a> to the vertices in the object model representing the controller to calculate the WebGL coordinates to use when rendering the controller's representation to the framebuffer.</p></div></section><section aria-labelledby="viewer_poses"><h3 id="viewer_poses"><a href="#viewer_poses">Viewer poses</a></h3><div class="section-content"><p>A specialized type of pose, the <strong>viewer pose</strong>, is the pose that represents the perspective of the viewer of the scene. A viewer pose is represented by WebXR's <a href="/en-US/docs/Web/API/XRViewerPose"><code>XRViewerPose</code></a> interface. When rendering a frame, you'll use the viewer pose to determine the position and facing direction of the viewer in order to <a href="/en-US/docs/Web/API/WebXR_Device_API/Cameras">place the virtual camera</a> and <a href="/en-US/docs/Web/API/WebXR_Device_API/Rendering">render the scene</a>.</p>
<p>The only way to obtain a pose that adapts positional information from one space to another is through the <a href="/en-US/docs/Web/API/XRFrame"><code>XRFrame</code></a> object received by your frame rendering callback function specified when you called the <a href="/en-US/docs/Web/API/XRSession"><code>XRSession</code></a> method <a href="/en-US/docs/Web/API/XRSession/requestAnimationFrame" title="requestAnimationFrame()"><code>requestAnimationFrame()</code></a>.</p>
<p>For example, given an <a href="/en-US/docs/Web/API/XRSession"><code>XRSession</code></a> whose reference space is <code>worldRefSpace</code>, the following line of code would request the first frame of animation to be scheduled:</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code>animationFrameRequestID <span class="token operator">=</span> xrSession<span class="token punctuation">.</span><span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>myDrawFrame<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>Then, the <code>myDrawFrame()</code> function—the callback executed when it's time to draw the frame—might be something like this:</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code><span class="token keyword">function</span> <span class="token function">myDrawFrame</span><span class="token punctuation">(</span><span class="token parameter">currentFrameTime<span class="token punctuation">,</span> frame</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> session <span class="token operator">=</span> frame<span class="token punctuation">.</span>session<span class="token punctuation">;</span>
  <span class="token keyword">let</span> viewerPose <span class="token operator">=</span> frame<span class="token punctuation">.</span><span class="token function">getViewerPose</span><span class="token punctuation">(</span>viewerRefSpace<span class="token punctuation">)</span><span class="token punctuation">;</span>

  animationFrameRequestID <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>myDrawFrame<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>viewerPose<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// render the frame</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p>The <code>frame</code> parameter is the <a href="/en-US/docs/Web/API/XRFrame"><code>XRFrame</code></a> representing the animation frame information provided by WebXR. When called, this function begins by getting the <a href="/en-US/docs/Web/API/XRSession"><code>XRSession</code></a> from the frame object, then uses the frame's <a href="/en-US/docs/Web/API/XRFrame/getViewerPose" title="getViewerPose()"><code>getViewerPose()</code></a> method to compute the <a href="/en-US/docs/Web/API/XRViewerPose"><code>XRViewerPose</code></a> for the viewer, given <code>viewerRefSpace</code>, which describes the current facing direction and position of the viewer.</p>
<p>The returned viewer pose, <code>viewerPose</code>, can in turn be used to <a href="/en-US/docs/Web/API/WebXR_Device_API/Cameras">compute positions and orientations to properly render</a> the objects in the scene given the user's point of view.</p></div></section><section aria-labelledby="offsetting_or_moving_reference_spaces"><h2 id="offsetting_or_moving_reference_spaces"><a href="#offsetting_or_moving_reference_spaces">Offsetting or moving reference spaces</a></h2><div class="section-content"><p>While you can't change a reference space since both <a href="/en-US/docs/Web/API/XRReferenceSpace"><code>XRReferenceSpace</code></a> and <a href="/en-US/docs/Web/API/XRBoundedReferenceSpace"><code>XRBoundedReferenceSpace</code></a> are read-only, you can easily create new reference spaces by applying an offset transform to them. This is done by calling the reference space's <a href="/en-US/docs/Web/API/XRReferenceSpace/getOffsetReferenceSpace" title="getOffsetReferenceSpace()"><code>getOffsetReferenceSpace()</code></a> method.</p></div></section><section aria-labelledby="offsetting_positions_within_a_reference_space"><h3 id="offsetting_positions_within_a_reference_space"><a href="#offsetting_positions_within_a_reference_space">Offsetting positions within a reference space</a></h3><div class="section-content"><p>The simplest case for using <code>getOffsetReferenceSpace()</code> is to transform a point or matrix within the context of the same space. For example, to create a new reference space that moves the reference space <code>aRefSpace</code> a half meter in each direction, you can do something like this:</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code><span class="token keyword">let</span> halfMeterTransform <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XRRigidTransform</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">0.5</span><span class="token punctuation">,</span>
  <span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">0.5</span><span class="token punctuation">,</span>
  <span class="token literal-property property">z</span><span class="token operator">:</span> <span class="token number">0.5</span><span class="token punctuation">,</span>
  <span class="token literal-property property">w</span><span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
aRefSpace <span class="token operator">=</span> aRefSpace<span class="token punctuation">.</span><span class="token function">getOffsetReferenceSpace</span><span class="token punctuation">(</span>halfMeterTransform<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>This replaces the existing reference space <code>aRefSpace</code> with one whose coordinates and orientation have had the transform <code>halfMeterTransform</code> applied. With no orientation data included in the transform, the orientation of <code>aRefSpace</code> is unaffected.</p></div></section><section aria-labelledby="converting_between_webxr_session_types"><h3 id="converting_between_webxr_session_types"><a href="#converting_between_webxr_session_types">Converting between WebXR session types</a></h3><div class="section-content"><p>Another common reason you may need to convert positional information from one reference space to another is when it's necessary to change the session type from <code>inline</code> to <code>immersive-vr</code> or back. This commonly happens when your user interface provides a way to preview the scene inline within the context of a web page, with a button or other control to switch to immersive mode.</p>
<p>Since most users would prefer that you maintain the same viewer position and facing direction while performing this transition, you can use the <a href="/en-US/docs/Web/API/XRFrame"><code>XRFrame</code></a> method <a href="/en-US/docs/Web/API/XRFrame/getViewerPose" title="getViewerPose()"><code>getViewerPose()</code></a> to obtain the current <a href="/en-US/docs/Web/API/XRViewerPose"><code>XRViewerPose</code></a>, switch the session, then use the saved viewer pose to restore the viewer's position and facing.</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code><span class="token keyword">let</span> viewerPose <span class="token operator">=</span> frame<span class="token punctuation">.</span><span class="token function">getViewerPose</span><span class="token punctuation">(</span>worldReferenceSpace<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> newSession <span class="token operator">=</span> navigator<span class="token punctuation">.</span>xr<span class="token punctuation">.</span><span class="token function">requestSession</span><span class="token punctuation">(</span><span class="token string">"immersive-vr"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">requiredFeatures</span><span class="token operator">:</span> <span class="token string">"unbounded"</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
worldReferenceSpace <span class="token operator">=</span> <span class="token keyword">await</span> newSession<span class="token punctuation">.</span><span class="token function">requestReferenceSpace</span><span class="token punctuation">(</span><span class="token string">"unbounded"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
viewerPose <span class="token operator">=</span> worldReferenceSpace<span class="token punctuation">.</span><span class="token function">getOffsetReferenceSpace</span><span class="token punctuation">(</span>viewerPose<span class="token punctuation">.</span>transform<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>Here, the viewer pose is obtained, with its transform defined relative to <code>worldReferenceSpace</code>, the current session's global reference space. Then a new session is established and a reference space created to become the new world reference space.</p>
<p>Finally, the saved <code>viewerPose</code> is converted to the new world space's coordinate system by calling the new reference system's <a href="/en-US/docs/Web/API/XRReferenceSpace/getOffsetReferenceSpace" title="getOffsetReferenceSpace()"><code>getOffsetReferenceSpace()</code></a> method. With this in hand, we can resume rendering the scene as usual, with the viewer's perspective unaffected.</p></div></section><section aria-labelledby="converting_between_bounded_and_unbounded_spaces"><h3 id="converting_between_bounded_and_unbounded_spaces"><a href="#converting_between_bounded_and_unbounded_spaces">Converting between bounded and unbounded spaces</a></h3><div class="section-content"><p>Sometimes when your primary experience uses an unbounded space, you may have a need to temporarily transition the user's experience to a bounded space. For instance, it may be easier to implement the interactions with the objects in a single room in a house by switching to a bounded space representing the single room. This might make it easier to do things like implement support for customizing the walls, placing furniture on the floor, and so forth.</p>
<p>In cases like this, where you need to begin tracking using a different reference space than the one you've been using, you can use a combination of <a href="/en-US/docs/Web/API/XRFrame/getViewerPose" title="getViewerPose()"><code>getViewerPose()</code></a> and some matrix computations to transition everything in your scene to be based at the new reference frame's origin.</p>
<p>Because <code>getViewerPose()</code> is only available in an <a href="/en-US/docs/Web/API/XRFrame"><code>XRFrame</code></a>, you will need to begin this process in your rendering callback, possibly using a worker to do the computations in order to reduce frame dropping.</p>
<div class="code-example"><p class="example-header"><span class="language-name">js</span></p><pre class="brush: js notranslate"><code><span class="token keyword">let</span> previousViewerPose <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">myDrawFrame</span><span class="token punctuation">(</span><span class="token parameter">currentFrameTime<span class="token punctuation">,</span> frame</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> session <span class="token operator">=</span> frame<span class="token punctuation">.</span>session<span class="token punctuation">;</span>
  <span class="token keyword">let</span> viewerPose <span class="token operator">=</span> frame<span class="token punctuation">.</span><span class="token function">getViewerPose</span><span class="token punctuation">(</span>viewerRefSpace<span class="token punctuation">)</span><span class="token punctuation">;</span>

  animationFrameRequestID <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>myDrawFrame<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>viewerPose<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>previousViewerPose<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      previousViewerPose <span class="token operator">=</span> viewerPose<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">let</span> offsetMatrix <span class="token operator">=</span> mat4<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    mat4<span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>
      offsetMatrix<span class="token punctuation">,</span>
      previousViewerPose<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>matrix<span class="token punctuation">,</span>
      viewerPose<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>matrix<span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    previousViewerPose <span class="token operator">=</span> viewerPose<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div></section><section aria-labelledby="continuity_and_recovery_after_tracking_loss"><h2 id="continuity_and_recovery_after_tracking_loss"><a href="#continuity_and_recovery_after_tracking_loss">Continuity and recovery after tracking loss</a></h2><div class="section-content"><p>Sometimes, while the user is actively using their XR hardware with your app, the flow of data containing updates as to the user's position and orientation might be lost for a period of time. Not only does your app need to determine what to show the user during these periods, but it needs to cleanly recover when tracking resumes.</p>
<p>Once the XR hardware begins providing tracking information, it will continue to do so until the XR session is closed. This data is obtained during each frame by calling the <a href="/en-US/docs/Web/API/XRFrame"><code>XRFrame</code></a> method <a href="/en-US/docs/Web/API/XRFrame/getViewerPose" title="getViewerPose()"><code>getViewerPose()</code></a> to get the position and facing direction of the viewer (defining what the user should see), and <a href="/en-US/docs/Web/API/XRFrame/getPose" title="getPose()"><code>getPose()</code></a> to get any other poses, such as the positions of the hand controllers and any other parts of the XR system.</p></div></section><section aria-labelledby="detecting_and_functioning_after_tracking_loss"><h3 id="detecting_and_functioning_after_tracking_loss"><a href="#detecting_and_functioning_after_tracking_loss">Detecting and functioning after tracking loss</a></h3><div class="section-content"><p>If tracking fails, such as due to a temporary loss of connectivity between the headset and the user's device, the XR layer will continue to return poses, but those poses' <a href="/en-US/docs/Web/API/XRPose/emulatedPosition" title="emulatedPosition"><code>emulatedPosition</code></a> property will be <code>true</code>, indicating that the computation of the pose is based on a guess of the current position of the user.</p>
<p>Some XR hardware uses algorithms to compute the estimated position of the user based on the movement currently ongoing, while other hardware will report no movement at all, but with <code>emulatedPosition</code> set to <code>true</code>. In either case, you may wish to adjust your rendering to compensate for the loss, depending on your specific needs.</p></div></section><section aria-labelledby="when_tracking_resumes"><h3 id="when_tracking_resumes"><a href="#when_tracking_resumes">When tracking resumes</a></h3><div class="section-content"><p>You can detect when tracking has resumed after being lost when the user position jumps while at the same time the value of <code>emulatedPosition</code> changes from <code>true</code> to <code>false</code>. How you handle this depends on your application. If your app provides a way for the user to move through the virtual world without physically moving in the real world (a so-called <strong>teleportation</strong> mechanic), you can accept the new position and continue, allowing the jump from your previously-assumed position to be immediately corrected with the new position.</p>
<p>On the other hand, if your app involves the user physically moving in real space to move around through your virtual world, adopting the new tracking position and jumping there can be unsettling to the user, and should be avoided if possible. Instead, use the difference between the current position and the new tracking position to compute the new teleportation offset; that is, a transform applied to everything to adapt the position and orientation data from WebXR to your needs.</p>
<p>You can do this by creating a new reference space that incorporates into its effective origin the distance the viewer's position jumped since the previous frame, using the <a href="/en-US/docs/Web/API/XRReferenceSpace"><code>XRReferenceSpace</code></a> method <a href="/en-US/docs/Web/API/XRReferenceSpace/getOffsetReferenceSpace" title="getOffsetReferenceSpace()"><code>getOffsetReferenceSpace()</code></a>.</p></div></section><section aria-labelledby="the_reset_event"><h3 id="the_reset_event"><a href="#the_reset_event">The reset event</a></h3><div class="section-content"><p><strong><em>&lt;&lt;&lt;--- this section probably has problems still; corrections are appreciated ---&gt;&gt;&gt;</em></strong></p>
<p>When a discontinuity or break in the native or effective origin of a reference space occurs, the <a href="/en-US/docs/Glossary/User_agent">user agent</a> will send the <a href="/en-US/docs/Web/API/XRReferenceSpace"><code>XRReferenceSpace</code></a> a <a href="/en-US/docs/Web/API/XRReferenceSpace/reset_event" title="reset"><code>reset</code></a> event. This event indicates that a significant change to the origin's position has taken place relative to the user's environment.</p>
<p>A <code>reset</code> may occur because the XR hardware lost connectivity for a time, resulting in the user's movements not being properly tracked for a while. Upon recovery of tracking, a <code>reset</code> means tracking has been restored and the new position information represents the actual position information provided by the XR hardware, rather than cached or "best-guess" data.</p>
<p>Another reason <code>reset</code> may be sent is because the user has exited the bounds of a reference space and entered another reference space, or because the user has been transitioned programmatically from one reference space to another. Any time the bounds geometry of the user's space changes, a <code>reset</code> is sent.</p>
<p><code>reset</code> is only used for significant jumps or transitions; minor things will just be absorbed automatically. The event is always sent to every affected reference space, including those created using <code>getOffsetReferenceSpace()</code>, so if you listen for <code>reset</code> events, you need to be sure you retain a strong reference to any spaces you're still using.</p></div></section><section aria-labelledby="see_also"><h2 id="see_also"><a href="#see_also">See also</a></h2><div class="section-content"><ul>
  <li><a href="/en-US/docs/Web/API/WebGL_API/Matrix_math_for_the_web">Matrix math for the web</a></li>
  <li><a href="/en-US/docs/Web/API/WebXR_Device_API/Geometry">Geometry and reference spaces in WebXR</a></li>
  <li><a href="/en-US/docs/Web/API/WebXR_Device_API/Rendering">Rendering and the WebXR frame animation callback</a></li>
  <li><a href="/en-US/docs/Web/API/WebXR_Device_API/Cameras">Viewpoints and viewers: Simulating cameras in WebXR</a></li>
  <li><a href="/en-US/docs/Web/API/WebXR_Device_API/Movement_and_motion">Movement, orientation, and motion: A WebXR example</a></li>
  <li><a href="/en-US/docs/Web/API/WebXR_Device_API/Bounded_reference_spaces">Using bounded reference spaces</a></li>
</ul></div></section><aside class="metadata"><div class="metadata-content-container"><div id="on-github" class="on-github"><h3>Found a content problem with this page?</h3><ul><li><a href="https://github.com/mdn/content/edit/main/files/en-us/web/api/webxr_device_api/spatial_tracking/index.md" title="This will take you to GitHub, where you&#x27;ll need to sign in first." target="_blank" rel="noopener noreferrer">Edit the page on GitHub</a>.</li><li><a href="https://github.com/mdn/content/issues/new?template=page-report.yml&amp;mdn-url=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FWebXR_Device_API%2FSpatial_tracking&amp;metadata=%3C%21--+Do+not+make+changes+below+this+line+--%3E%0A%3Cdetails%3E%0A%3Csummary%3EPage+report+details%3C%2Fsummary%3E%0A%0A*+Folder%3A+%60en-us%2Fweb%2Fapi%2Fwebxr_device_api%2Fspatial_tracking%60%0A*+MDN+URL%3A+https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FWebXR_Device_API%2FSpatial_tracking%0A*+GitHub+URL%3A+https%3A%2F%2Fgithub.com%2Fmdn%2Fcontent%2Fblob%2Fmain%2Ffiles%2Fen-us%2Fweb%2Fapi%2Fwebxr_device_api%2Fspatial_tracking%2Findex.md%0A*+Last+commit%3A+https%3A%2F%2Fgithub.com%2Fmdn%2Fcontent%2Fcommit%2Facfe8c9f1f4145f77653a2bc64a9744b001358dc%0A*+Document+last+modified%3A+2023-07-07T07%3A19%3A19.000Z%0A%0A%3C%2Fdetails%3E" title="This will take you to GitHub to file a new issue." target="_blank" rel="noopener noreferrer">Report the content issue</a>.</li><li><a href="https://github.com/mdn/content/blob/main/files/en-us/web/api/webxr_device_api/spatial_tracking/index.md?plain=1" title="Folder: en-us/web/api/webxr_device_api/spatial_tracking (Opens in a new tab)" target="_blank" rel="noopener noreferrer">View the source on GitHub</a>.</li></ul>Want to get more involved?<!-- --> <a href="https://github.com/mdn/content/blob/main/CONTRIBUTING.md" title="This will take you to our contribution guidelines on GitHub." target="_blank" rel="noopener noreferrer">Learn how to contribute</a>.</div><p class="last-modified-date">This page was last modified on<!-- --> <time dateTime="2023-07-07T07:19:19.000Z">Jul 7, 2023</time> by<!-- --> <a href="/en-US/docs/Web/API/WebXR_Device_API/Spatial_tracking/contributors.txt">MDN contributors</a>.</p></div></aside></article></main></div></div><footer id="nav-footer" class="page-footer"><div class="page-footer-grid"><div class="page-footer-logo-col"><a href="/" class="mdn-footer-logo" aria-label="MDN homepage"><svg width="48" height="17" viewBox="0 0 48 17" fill="none" xmlns="http://www.w3.org/2000/svg"><title id="mdn-footer-logo-svg">MDN logo</title><path d="M20.04 16.512H15.504V10.416C15.504 9.488 15.344 8.824 15.024 8.424C14.72 8.024 14.264 7.824 13.656 7.824C12.92 7.824 12.384 8.064 12.048 8.544C11.728 9.024 11.568 9.64 11.568 10.392V14.184H13.008V16.512H8.472V10.416C8.472 9.488 8.312 8.824 7.992 8.424C7.688 8.024 7.232 7.824 6.624 7.824C5.872 7.824 5.336 8.064 5.016 8.544C4.696 9.024 4.536 9.64 4.536 10.392V14.184H6.6V16.512H0V14.184H1.44V8.04H0.024V5.688H4.536V7.32C5.224 6.088 6.32 5.472 7.824 5.472C8.608 5.472 9.328 5.664 9.984 6.048C10.64 6.432 11.096 7.016 11.352 7.8C11.992 6.248 13.168 5.472 14.88 5.472C15.856 5.472 16.72 5.776 17.472 6.384C18.224 6.992 18.6 7.936 18.6 9.216V14.184H20.04V16.512Z" fill="currentColor"></path><path d="M33.6714 16.512H29.1354V14.496C28.8314 15.12 28.3834 15.656 27.7914 16.104C27.1994 16.536 26.4154 16.752 25.4394 16.752C24.0154 16.752 22.8954 16.264 22.0794 15.288C21.2634 14.312 20.8554 12.984 20.8554 11.304C20.8554 9.688 21.2554 8.312 22.0554 7.176C22.8554 6.04 24.0634 5.472 25.6794 5.472C26.5594 5.472 27.2794 5.648 27.8394 6C28.3994 6.352 28.8314 6.8 29.1354 7.344V2.352H26.9754V0H32.2314V14.184H33.6714V16.512ZM29.1354 11.04V10.776C29.1354 9.88 28.8954 9.184 28.4154 8.688C27.9514 8.176 27.3674 7.92 26.6634 7.92C25.9754 7.92 25.3674 8.176 24.8394 8.688C24.3274 9.2 24.0714 10.008 24.0714 11.112C24.0714 12.152 24.3114 12.944 24.7914 13.488C25.2714 14.032 25.8394 14.304 26.4954 14.304C27.3114 14.304 27.9514 13.96 28.4154 13.272C28.8954 12.584 29.1354 11.84 29.1354 11.04Z" fill="currentColor"></path><path d="M47.9589 16.512H41.9829V14.184H43.4229V10.416C43.4229 9.488 43.2629 8.824 42.9429 8.424C42.6389 8.024 42.1829 7.824 41.5749 7.824C40.8389 7.824 40.2709 8.056 39.8709 8.52C39.4709 8.968 39.2629 9.56 39.2469 10.296V14.184H40.6869V16.512H34.7109V14.184H36.1509V8.04H34.5909V5.688H39.2469V7.344C39.9669 6.096 41.1269 5.472 42.7269 5.472C43.7509 5.472 44.6389 5.776 45.3909 6.384C46.1429 6.992 46.5189 7.936 46.5189 9.216V14.184H47.9589V16.512Z" fill="currentColor"></path></svg></a><p>Your blueprint for a better internet.</p><ul class="social-icons"><li><a class="icon icon-mastodon" href="https://mozilla.social/@mdn" target="_blank" rel="me noopener noreferrer"><span class="visually-hidden">MDN on Mastodon</span></a></li><li><a class="icon icon-twitter" href="https://twitter.com/mozdevnet" target="_blank" rel="noopener noreferrer"><span class="visually-hidden">MDN on Twitter</span></a></li><li><a class="icon icon-github-mark-small" href="https://github.com/mdn/" target="_blank" rel="noopener noreferrer"><span class="visually-hidden">MDN on GitHub</span></a></li><li><a class="icon icon-feed" href="/en-US/blog/rss.xml" target="_blank"><span class="visually-hidden">MDN Blog RSS Feed</span></a></li></ul></div><div class="page-footer-nav-col-1"><h2 class="footer-nav-heading">MDN</h2><ul class="footer-nav-list"><li class="footer-nav-item"><a href="/en-US/about">About</a></li><li class="footer-nav-item"><a href="/en-US/blog/">Blog</a></li><li class="footer-nav-item"><a href="https://www.mozilla.org/en-US/careers/listings/?team=ProdOps" target="_blank" rel="noopener noreferrer">Careers</a></li><li class="footer-nav-item"><a href="/en-US/advertising">Advertise with us</a></li></ul></div><div class="page-footer-nav-col-2"><h2 class="footer-nav-heading">Support</h2><ul class="footer-nav-list"><li class="footer-nav-item"><a class="footer-nav-link" href="/en-US/docs/MDN/Community/Issues">Report an issue</a></li></ul></div><div class="page-footer-nav-col-3"><h2 class="footer-nav-heading">Our communities</h2><ul class="footer-nav-list"><li class="footer-nav-item"><a class="footer-nav-link" href="/en-US/community">MDN Community</a></li><li class="footer-nav-item"><a class="footer-nav-link" href="https://discourse.mozilla.org/c/mdn/236" target="_blank" rel="noopener noreferrer">MDN Forum</a></li><li class="footer-nav-item"><a class="footer-nav-link" href="/discord" target="_blank" rel="noopener noreferrer">MDN Chat</a></li></ul></div><div class="page-footer-nav-col-4"><h2 class="footer-nav-heading">Developers</h2><ul class="footer-nav-list"><li class="footer-nav-item"><a class="footer-nav-link" href="/en-US/docs/Web">Web Technologies</a></li><li class="footer-nav-item"><a class="footer-nav-link" href="/en-US/docs/Learn">Learn Web Development</a></li><li class="footer-nav-item"><a href="https://hacks.mozilla.org/" target="_blank" rel="noopener noreferrer">Hacks Blog</a></li></ul></div><div class="page-footer-moz"><a href="https://www.mozilla.org/" class="footer-moz-logo-link" target="_blank" rel="noopener noreferrer"><svg width="112" height="32" fill="none" xmlns="http://www.w3.org/2000/svg"><title id="mozilla-footer-logo-svg">Mozilla logo</title><path d="M41.753 14.218c-2.048 0-3.324 1.522-3.324 4.157 0 2.423 1.119 4.286 3.29 4.286 2.082 0 3.447-1.678 3.447-4.347 0-2.826-1.522-4.096-3.413-4.096Zm54.89 7.044c0 .901.437 1.618 1.645 1.618 1.427 0 2.949-1.024 3.044-3.352-.649-.095-1.365-.185-2.02-.185-1.426-.005-2.668.397-2.668 1.92Z" fill="currentColor"></path><path d="M0 0v32h111.908V0H0Zm32.56 25.426h-5.87v-7.884c0-2.423-.806-3.352-2.39-3.352-1.924 0-2.702 1.365-2.702 3.324v4.868h1.864v3.044h-5.864v-7.884c0-2.423-.806-3.352-2.39-3.352-1.924 0-2.702 1.365-2.702 3.324v4.868h2.669v3.044H6.642v-3.044h1.863v-7.918H6.642V11.42h5.864v2.11c.839-1.489 2.3-2.39 4.252-2.39 2.02 0 3.878.963 4.566 3.01.778-1.862 2.361-3.01 4.566-3.01 2.512 0 4.812 1.522 4.812 4.84v6.402h1.863v3.044h-.005Zm9.036.307c-4.314 0-7.296-2.635-7.296-7.106 0-4.096 2.484-7.481 7.514-7.481s7.481 3.38 7.481 7.29c0 4.472-3.228 7.297-7.699 7.297Zm22.578-.307H51.942l-.403-2.11 7.7-8.846h-4.376l-.621 2.17-2.888-.313.498-4.907h12.294l.313 2.11-7.767 8.852h4.533l.654-2.172 3.167.308-.872 4.908Zm7.99 0h-4.191v-5.03h4.19v5.03Zm0-8.976h-4.191v-5.03h4.19v5.03Zm2.618 8.976 6.054-21.358h3.945l-6.054 21.358h-3.945Zm8.136 0 6.048-21.358h3.945l-6.054 21.358h-3.939Zm21.486.307c-1.863 0-2.887-1.085-3.072-2.792-.805 1.427-2.232 2.792-4.498 2.792-2.02 0-4.314-1.085-4.314-4.006 0-3.447 3.323-4.253 6.518-4.253.778 0 1.584.034 2.3.124v-.465c0-1.427-.034-3.133-2.3-3.133-.84 0-1.488.061-2.143.402l-.453 1.578-3.195-.34.549-3.224c2.45-.996 3.692-1.27 5.992-1.27 3.01 0 5.556 1.55 5.556 4.75v6.083c0 .805.314 1.085.963 1.085.184 0 .375-.034.587-.095l.034 2.11a5.432 5.432 0 0 1-2.524.654Z" fill="currentColor"></path></svg></a><ul class="footer-moz-list"><li class="footer-moz-item"><a href="https://www.mozilla.org/privacy/websites/" class="footer-moz-link" target="_blank" rel="noopener noreferrer">Website Privacy Notice</a></li><li class="footer-moz-item"><a href="https://www.mozilla.org/privacy/websites/#cookies" class="footer-moz-link" target="_blank" rel="noopener noreferrer">Cookies</a></li><li class="footer-moz-item"><a href="https://www.mozilla.org/about/legal/terms/mozilla" class="footer-moz-link" target="_blank" rel="noopener noreferrer">Legal</a></li><li class="footer-moz-item"><a href="https://www.mozilla.org/about/governance/policies/participation/" class="footer-moz-link" target="_blank" rel="noopener noreferrer">Community Participation Guidelines</a></li></ul></div><div class="page-footer-legal"><p id="license" class="page-footer-legal-text">Visit<!-- --> <a href="https://www.mozilla.org" target="_blank" rel="noopener noreferrer">Mozilla Corporation’s</a> <!-- -->not-for-profit parent, the<!-- --> <a target="_blank" rel="noopener noreferrer" href="https://foundation.mozilla.org/">Mozilla Foundation</a>.<br/>Portions of this content are ©1998–<!-- -->2023<!-- --> by individual mozilla.org contributors. Content available under<!-- --> <a href="/en-US/docs/MDN/Writing_guidelines/Attrib_copyright_license">a Creative Commons license</a>.</p></div></div></footer></div><script type="application/json" id="hydration">{"doc":{"isMarkdown":true,"isTranslated":false,"isActive":true,"flaws":{},"title":"Spaces and reference spaces: Spatial tracking in WebXR","mdn_url":"/en-US/docs/Web/API/WebXR_Device_API/Spatial_tracking","locale":"en-US","native":"English (US)","sidebarHTML":"<ol><li><strong><a href=\"/en-US/docs/Web/API/WebXR_Device_API\">WebXR Device API</a></strong></li><li class=\"toggle\"><details open=\"\"><summary>Guides</summary><ol><li><a href=\"/en-US/docs/Web/API/WebXR_Device_API/Fundamentals\">Fundamentals of WebXR</a></li><li><a href=\"/en-US/docs/Web/API/WebXR_Device_API/Lifecycle\">WebXR application life cycle</a></li><li><a href=\"/en-US/docs/Web/API/WebXR_Device_API/Startup_and_shutdown\">Starting up and shutting down a WebXR session</a></li><li><a href=\"/en-US/docs/Web/API/WebXR_Device_API/Cameras\">Viewpoints and viewers: Simulating cameras in WebXR</a></li><li><a href=\"/en-US/docs/Web/API/WebXR_Device_API/Geometry\">Geometry and reference spaces in WebXR</a></li><li><em><a href=\"/en-US/docs/Web/API/WebXR_Device_API/Spatial_tracking\" aria-current=\"page\">Spaces and reference spaces: Spatial tracking in WebXR</a></em></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Interfaces</summary><ol><li><a href=\"/en-US/docs/Web/API/XRAnchor\"><code>XRAnchor</code></a></li><li><a href=\"/en-US/docs/Web/API/XRBoundedReferenceSpace\"><code>XRBoundedReferenceSpace</code></a></li><li><a href=\"/en-US/docs/Web/API/XRCPUDepthInformation\"><code>XRCPUDepthInformation</code></a></li><li><a href=\"/en-US/docs/Web/API/XRDepthInformation\"><code>XRDepthInformation</code></a></li><li><a href=\"/en-US/docs/Web/API/XRFrame\"><code>XRFrame</code></a></li><li><a href=\"/en-US/docs/Web/API/XRInputSource\"><code>XRInputSource</code></a></li><li><a href=\"/en-US/docs/Web/API/XRInputSourceArray\"><code>XRInputSourceArray</code></a></li><li><a href=\"/en-US/docs/Web/API/XRInputSourceEvent\"><code>XRInputSourceEvent</code></a></li><li><a href=\"/en-US/docs/Web/API/XRInputSourcesChangeEvent\"><code>XRInputSourcesChangeEvent</code></a></li><li><a href=\"/en-US/docs/Web/API/XRPose\"><code>XRPose</code></a></li><li><a href=\"/en-US/docs/Web/API/XRReferenceSpace\"><code>XRReferenceSpace</code></a></li><li><a href=\"/en-US/docs/Web/API/XRReferenceSpaceEvent\"><code>XRReferenceSpaceEvent</code></a></li><li><a href=\"/en-US/docs/Web/API/XRRenderState\"><code>XRRenderState</code></a></li><li><a href=\"/en-US/docs/Web/API/XRRigidTransform\"><code>XRRigidTransform</code></a></li><li><a href=\"/en-US/docs/Web/API/XRSession\"><code>XRSession</code></a></li><li><a href=\"/en-US/docs/Web/API/XRSessionEvent\"><code>XRSessionEvent</code></a></li><li><a href=\"/en-US/docs/Web/API/XRSpace\"><code>XRSpace</code></a></li><li><a href=\"/en-US/docs/Web/API/XRSystem\"><code>XRSystem</code></a></li><li><a href=\"/en-US/docs/Web/API/XRView\"><code>XRView</code></a></li><li><a href=\"/en-US/docs/Web/API/XRViewerPose\"><code>XRViewerPose</code></a></li><li><a href=\"/en-US/docs/Web/API/XRViewport\"><code>XRViewport</code></a></li><li><a href=\"/en-US/docs/Web/API/XRWebGLBinding\"><code>XRWebGLBinding</code></a></li><li><a href=\"/en-US/docs/Web/API/XRWebGLDepthInformation\"><code>XRWebGLDepthInformation</code></a></li><li><a href=\"/en-US/docs/Web/API/XRWebGLLayer\"><code>XRWebGLLayer</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Properties</summary><ol><li><a href=\"/en-US/docs/Web/API/Navigator/xr\"><code>Navigator.xr</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Methods</summary><ol><li><a href=\"/en-US/docs/Web/API/WebGLRenderingContext/makeXRCompatible\"><code>WebGLRenderingContext.makeXRCompatible()</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Events</summary><ol><li><a href=\"/en-US/docs/Web/API/XRReferenceSpace/reset_event\"><code>XRReferenceSpace</code>: <code>reset</code></a></li><li><a href=\"/en-US/docs/Web/API/XRSession/end_event\"><code>XRSession</code>: <code>end</code></a></li><li><a href=\"/en-US/docs/Web/API/XRSession/inputsourceschange_event\"><code>XRSession</code>: <code>inputsourceschange</code></a></li><li><a href=\"/en-US/docs/Web/API/XRSession/select_event\"><code>XRSession</code>: <code>select</code></a></li><li><a href=\"/en-US/docs/Web/API/XRSession/selectend_event\"><code>XRSession</code>: <code>selectend</code></a></li><li><a href=\"/en-US/docs/Web/API/XRSession/selectstart_event\"><code>XRSession</code>: <code>selectstart</code></a></li><li><a href=\"/en-US/docs/Web/API/XRSession/visibilitychange_event\"><code>XRSession</code>: <code>visibilitychange</code></a></li><li><a href=\"/en-US/docs/Web/API/XRSystem/devicechange_event\"><code>XRSystem</code>: <code>devicechange</code></a></li></ol></details></li></ol>","sidebarMacro":"DefaultAPISidebar","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p>The WebXR APIs used for implementing augmented and virtual reality is designed specifically to provide the ability to insert a human into a virtual environment. To accomplish this, software needs the ability to not only track the locations, orientation, and movements of objects in the virtual world, but the user's location, orientation, and movement as well. But WebXR goes beyond that by adding the ability to track the location, orientation, and motion of the input devices which generate data used to determine the position and movement of individual parts of the viewer's body (with appropriate equipment).</p>\n<p>The location and movement of the user's headset represent their head's position and orientation in the virtual environment. Hand controllers represent their hands in the same manner. Other hardware elements can be used similarly to represent other parts of the body, providing additional data to use when simulating the user's actions in their environment.</p>\n<p>In this guide, we'll explore how WebXR uses <strong>spaces</strong> and, more specifically, <strong>reference spaces</strong>, to track the positions, orientations, and movements of objects and of the user's body in the virtual world.</p>\n<div class=\"notecard note\" id=\"sect1\">\n  <p><strong>Note:</strong> This article presumes that you are familiar with the concepts introduced in <a href=\"/en-US/docs/Web/API/WebXR_Device_API/Geometry\">Geometry and reference spaces in WebXR</a>: that is, the basics of 3D coordinate systems, as well as WebXR spaces, reference spaces, and how reference spaces are used to create local coordinate systems for individual objects or movable components within a scene.</p>\n</div>"}},{"type":"prose","value":{"id":"representing_a_position_using_a_reference_space","title":"Representing a position using a reference space","isH3":false,"content":"<p>As covered in <a href=\"/en-US/docs/Web/API/WebXR_Device_API/Geometry#defining_spatial_relationships_with_reference_spaces\">Defining spatial relationships with reference spaces</a>, reference spaces establish a local coordinate system which is offset from another coordinate system that is itself defined by some other space. Thus, a reference space can be used to define the position and orientation of a point and by extension the entire object for which that point is the origin. While this is a little heavy-handed to be used for every single object in a scene, it can be very useful for a few specific objects to have their own coordinate system in this manner.</p>\n<ul>\n  <li><strong>The world space</strong>; the origin of this space is the origin of the <a href=\"/en-US/docs/Web/API/WebGL_API/WebGL_model_view_projection\">WebGL coordinate system</a> underlying the entire 3D canvas.</li>\n  <li>The player, avatar, or camera; the origin of this space is used as the camera position for rendering the scene to be displayed to the user.</li>\n  <li>The hand and/or hand controller; each of these represents one of the user's hands, either in the form of the hand itself or a controller (or both). The origin is generally the center of the user's fisted hand.</li>\n  <li><strong>The target ray</strong>; each controller or other handheld device may have a targeting ray associated with it, which is represented by a space whose origin is at the point on the controller at which the ray is emitted, and is oriented so that -Z extends in the direction of the target it's pointing at.</li>\n</ul>\n<p>Because each of these is defined using a reference space as its foundation, the WebXR Device API can easily be used to convert among the coordinate systems, perform operations affecting these spaces and their corresponding objects, and so forth.</p>"}},{"type":"prose","value":{"id":"describing_a_position_relative_to_a_space","title":"Describing a position relative to a space","isH3":false,"content":"<p>There are two scenarios in which you may need to describe a position and/or orientation relative to a space. The first is <a href=\"#offsetting_or_moving_reference_spaces\">described above</a>: applying a reference space to an offset (or vice versa, since the result is the same) to determine the transform matrix that represents the resulting location in the space's coordinate system.</p>"}},{"type":"prose","value":{"id":"poses","title":"Poses","isH3":true,"content":"<p>Once your reference space or spaces are established for the various key objects in the scene, you will have times when you need to describe another position relative to the origin of a particular reference space. This is done using poses. A pose, put, describes a position and orientation relative to the origin of the reference space from which it was created.</p>\n<p>In WebXR, a pose is represented by an <a href=\"/en-US/docs/Web/API/XRPose\"><code>XRPose</code></a> object, whose <a href=\"/en-US/docs/Web/API/XRPose/transform\" title=\"transform\"><code>transform</code></a> property is an <a href=\"/en-US/docs/Web/API/XRRigidTransform\"><code>XRRigidTransform</code></a> defining the transform matrix that, applied to any coordinate, vector, or matrix in the original space, converts it to the target space. Thus a pose can be used to not only convert and determine positions, but also rotational information.</p>\n<p>There is only one way to create an <a href=\"/en-US/docs/Web/API/XRPose\"><code>XRPose</code></a>, and that's using the <a href=\"/en-US/docs/Web/API/XRFrame/getPose\" title=\"getPose()\"><code>getPose()</code></a> method on an animation frame as given using an <a href=\"/en-US/docs/Web/API/XRFrame\"><code>XRFrame</code></a> object. This means that most frequently, you'll be using poses within your frame rendering code, which is executed as a callback from the <a href=\"/en-US/docs/Web/API/XRFrame\"><code>XRFrame</code></a> method <a href=\"/en-US/docs/Web/API/XRSession/requestAnimationFrame\" title=\"requestAnimationFrame()\"><code>requestAnimationFrame()</code></a>.</p>\n<p><code>getPose()</code> computes the position of an <a href=\"/en-US/docs/Web/API/XRReferenceSpace\"><code>XRReferenceSpace</code></a> relative to the origin of a specified <a href=\"/en-US/docs/Web/API/XRSpace\"><code>XRSpace</code></a> and then creates a pose representing the resulting position and orientation.</p>\n<p>For example, if you wish to draw a hand controller's representation using the controller's <a href=\"/en-US/docs/Web/API/XRInputSource/gripSpace\" title=\"gripSpace\"><code>gripSpace</code></a>, you can get the pose needed like this:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">let</span> controlPose <span class=\"token operator\">=</span> frame<span class=\"token punctuation\">.</span><span class=\"token function\">getPose</span><span class=\"token punctuation\">(</span>inputSource<span class=\"token punctuation\">.</span>gripSpace<span class=\"token punctuation\">,</span> worldRefSpace<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>This converts the position and orientation of the input's grip space to use the world's coordinate system, then generates the corresponding <code>XRPose</code>, storing it in <code>controlPose</code>. You can then apply <code>controlPose</code>'s <a href=\"/en-US/docs/Web/API/XRPose/transform\" title=\"transform\"><code>transform</code></a> to the vertices in the object model representing the controller to calculate the WebGL coordinates to use when rendering the controller's representation to the framebuffer.</p>"}},{"type":"prose","value":{"id":"viewer_poses","title":"Viewer poses","isH3":true,"content":"<p>A specialized type of pose, the <strong>viewer pose</strong>, is the pose that represents the perspective of the viewer of the scene. A viewer pose is represented by WebXR's <a href=\"/en-US/docs/Web/API/XRViewerPose\"><code>XRViewerPose</code></a> interface. When rendering a frame, you'll use the viewer pose to determine the position and facing direction of the viewer in order to <a href=\"/en-US/docs/Web/API/WebXR_Device_API/Cameras\">place the virtual camera</a> and <a href=\"/en-US/docs/Web/API/WebXR_Device_API/Rendering\">render the scene</a>.</p>\n<p>The only way to obtain a pose that adapts positional information from one space to another is through the <a href=\"/en-US/docs/Web/API/XRFrame\"><code>XRFrame</code></a> object received by your frame rendering callback function specified when you called the <a href=\"/en-US/docs/Web/API/XRSession\"><code>XRSession</code></a> method <a href=\"/en-US/docs/Web/API/XRSession/requestAnimationFrame\" title=\"requestAnimationFrame()\"><code>requestAnimationFrame()</code></a>.</p>\n<p>For example, given an <a href=\"/en-US/docs/Web/API/XRSession\"><code>XRSession</code></a> whose reference space is <code>worldRefSpace</code>, the following line of code would request the first frame of animation to be scheduled:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code>animationFrameRequestID <span class=\"token operator\">=</span> xrSession<span class=\"token punctuation\">.</span><span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span>myDrawFrame<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Then, the <code>myDrawFrame()</code> function—the callback executed when it's time to draw the frame—might be something like this:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">function</span> <span class=\"token function\">myDrawFrame</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">currentFrameTime<span class=\"token punctuation\">,</span> frame</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> session <span class=\"token operator\">=</span> frame<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">let</span> viewerPose <span class=\"token operator\">=</span> frame<span class=\"token punctuation\">.</span><span class=\"token function\">getViewerPose</span><span class=\"token punctuation\">(</span>viewerRefSpace<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  animationFrameRequestID <span class=\"token operator\">=</span> session<span class=\"token punctuation\">.</span><span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span>myDrawFrame<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>viewerPose<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// render the frame</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>The <code>frame</code> parameter is the <a href=\"/en-US/docs/Web/API/XRFrame\"><code>XRFrame</code></a> representing the animation frame information provided by WebXR. When called, this function begins by getting the <a href=\"/en-US/docs/Web/API/XRSession\"><code>XRSession</code></a> from the frame object, then uses the frame's <a href=\"/en-US/docs/Web/API/XRFrame/getViewerPose\" title=\"getViewerPose()\"><code>getViewerPose()</code></a> method to compute the <a href=\"/en-US/docs/Web/API/XRViewerPose\"><code>XRViewerPose</code></a> for the viewer, given <code>viewerRefSpace</code>, which describes the current facing direction and position of the viewer.</p>\n<p>The returned viewer pose, <code>viewerPose</code>, can in turn be used to <a href=\"/en-US/docs/Web/API/WebXR_Device_API/Cameras\">compute positions and orientations to properly render</a> the objects in the scene given the user's point of view.</p>"}},{"type":"prose","value":{"id":"offsetting_or_moving_reference_spaces","title":"Offsetting or moving reference spaces","isH3":false,"content":"<p>While you can't change a reference space since both <a href=\"/en-US/docs/Web/API/XRReferenceSpace\"><code>XRReferenceSpace</code></a> and <a href=\"/en-US/docs/Web/API/XRBoundedReferenceSpace\"><code>XRBoundedReferenceSpace</code></a> are read-only, you can easily create new reference spaces by applying an offset transform to them. This is done by calling the reference space's <a href=\"/en-US/docs/Web/API/XRReferenceSpace/getOffsetReferenceSpace\" title=\"getOffsetReferenceSpace()\"><code>getOffsetReferenceSpace()</code></a> method.</p>"}},{"type":"prose","value":{"id":"offsetting_positions_within_a_reference_space","title":"Offsetting positions within a reference space","isH3":true,"content":"<p>The simplest case for using <code>getOffsetReferenceSpace()</code> is to transform a point or matrix within the context of the same space. For example, to create a new reference space that moves the reference space <code>aRefSpace</code> a half meter in each direction, you can do something like this:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">let</span> halfMeterTransform <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">XRRigidTransform</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">x</span><span class=\"token operator\">:</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">y</span><span class=\"token operator\">:</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">z</span><span class=\"token operator\">:</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">w</span><span class=\"token operator\">:</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\naRefSpace <span class=\"token operator\">=</span> aRefSpace<span class=\"token punctuation\">.</span><span class=\"token function\">getOffsetReferenceSpace</span><span class=\"token punctuation\">(</span>halfMeterTransform<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>This replaces the existing reference space <code>aRefSpace</code> with one whose coordinates and orientation have had the transform <code>halfMeterTransform</code> applied. With no orientation data included in the transform, the orientation of <code>aRefSpace</code> is unaffected.</p>"}},{"type":"prose","value":{"id":"converting_between_webxr_session_types","title":"Converting between WebXR session types","isH3":true,"content":"<p>Another common reason you may need to convert positional information from one reference space to another is when it's necessary to change the session type from <code>inline</code> to <code>immersive-vr</code> or back. This commonly happens when your user interface provides a way to preview the scene inline within the context of a web page, with a button or other control to switch to immersive mode.</p>\n<p>Since most users would prefer that you maintain the same viewer position and facing direction while performing this transition, you can use the <a href=\"/en-US/docs/Web/API/XRFrame\"><code>XRFrame</code></a> method <a href=\"/en-US/docs/Web/API/XRFrame/getViewerPose\" title=\"getViewerPose()\"><code>getViewerPose()</code></a> to obtain the current <a href=\"/en-US/docs/Web/API/XRViewerPose\"><code>XRViewerPose</code></a>, switch the session, then use the saved viewer pose to restore the viewer's position and facing.</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">let</span> viewerPose <span class=\"token operator\">=</span> frame<span class=\"token punctuation\">.</span><span class=\"token function\">getViewerPose</span><span class=\"token punctuation\">(</span>worldReferenceSpace<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> newSession <span class=\"token operator\">=</span> navigator<span class=\"token punctuation\">.</span>xr<span class=\"token punctuation\">.</span><span class=\"token function\">requestSession</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"immersive-vr\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">requiredFeatures</span><span class=\"token operator\">:</span> <span class=\"token string\">\"unbounded\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nworldReferenceSpace <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> newSession<span class=\"token punctuation\">.</span><span class=\"token function\">requestReferenceSpace</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"unbounded\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nviewerPose <span class=\"token operator\">=</span> worldReferenceSpace<span class=\"token punctuation\">.</span><span class=\"token function\">getOffsetReferenceSpace</span><span class=\"token punctuation\">(</span>viewerPose<span class=\"token punctuation\">.</span>transform<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Here, the viewer pose is obtained, with its transform defined relative to <code>worldReferenceSpace</code>, the current session's global reference space. Then a new session is established and a reference space created to become the new world reference space.</p>\n<p>Finally, the saved <code>viewerPose</code> is converted to the new world space's coordinate system by calling the new reference system's <a href=\"/en-US/docs/Web/API/XRReferenceSpace/getOffsetReferenceSpace\" title=\"getOffsetReferenceSpace()\"><code>getOffsetReferenceSpace()</code></a> method. With this in hand, we can resume rendering the scene as usual, with the viewer's perspective unaffected.</p>"}},{"type":"prose","value":{"id":"converting_between_bounded_and_unbounded_spaces","title":"Converting between bounded and unbounded spaces","isH3":true,"content":"<p>Sometimes when your primary experience uses an unbounded space, you may have a need to temporarily transition the user's experience to a bounded space. For instance, it may be easier to implement the interactions with the objects in a single room in a house by switching to a bounded space representing the single room. This might make it easier to do things like implement support for customizing the walls, placing furniture on the floor, and so forth.</p>\n<p>In cases like this, where you need to begin tracking using a different reference space than the one you've been using, you can use a combination of <a href=\"/en-US/docs/Web/API/XRFrame/getViewerPose\" title=\"getViewerPose()\"><code>getViewerPose()</code></a> and some matrix computations to transition everything in your scene to be based at the new reference frame's origin.</p>\n<p>Because <code>getViewerPose()</code> is only available in an <a href=\"/en-US/docs/Web/API/XRFrame\"><code>XRFrame</code></a>, you will need to begin this process in your rendering callback, possibly using a worker to do the computations in order to reduce frame dropping.</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">let</span> previousViewerPose <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">myDrawFrame</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">currentFrameTime<span class=\"token punctuation\">,</span> frame</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> session <span class=\"token operator\">=</span> frame<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">let</span> viewerPose <span class=\"token operator\">=</span> frame<span class=\"token punctuation\">.</span><span class=\"token function\">getViewerPose</span><span class=\"token punctuation\">(</span>viewerRefSpace<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  animationFrameRequestID <span class=\"token operator\">=</span> session<span class=\"token punctuation\">.</span><span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span>myDrawFrame<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>viewerPose<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>previousViewerPose<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      previousViewerPose <span class=\"token operator\">=</span> viewerPose<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">let</span> offsetMatrix <span class=\"token operator\">=</span> mat4<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    mat4<span class=\"token punctuation\">.</span><span class=\"token function\">sub</span><span class=\"token punctuation\">(</span>\n      offsetMatrix<span class=\"token punctuation\">,</span>\n      previousViewerPose<span class=\"token punctuation\">.</span>transform<span class=\"token punctuation\">.</span>matrix<span class=\"token punctuation\">,</span>\n      viewerPose<span class=\"token punctuation\">.</span>transform<span class=\"token punctuation\">.</span>matrix<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    previousViewerPose <span class=\"token operator\">=</span> viewerPose<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"continuity_and_recovery_after_tracking_loss","title":"Continuity and recovery after tracking loss","isH3":false,"content":"<p>Sometimes, while the user is actively using their XR hardware with your app, the flow of data containing updates as to the user's position and orientation might be lost for a period of time. Not only does your app need to determine what to show the user during these periods, but it needs to cleanly recover when tracking resumes.</p>\n<p>Once the XR hardware begins providing tracking information, it will continue to do so until the XR session is closed. This data is obtained during each frame by calling the <a href=\"/en-US/docs/Web/API/XRFrame\"><code>XRFrame</code></a> method <a href=\"/en-US/docs/Web/API/XRFrame/getViewerPose\" title=\"getViewerPose()\"><code>getViewerPose()</code></a> to get the position and facing direction of the viewer (defining what the user should see), and <a href=\"/en-US/docs/Web/API/XRFrame/getPose\" title=\"getPose()\"><code>getPose()</code></a> to get any other poses, such as the positions of the hand controllers and any other parts of the XR system.</p>"}},{"type":"prose","value":{"id":"detecting_and_functioning_after_tracking_loss","title":"Detecting and functioning after tracking loss","isH3":true,"content":"<p>If tracking fails, such as due to a temporary loss of connectivity between the headset and the user's device, the XR layer will continue to return poses, but those poses' <a href=\"/en-US/docs/Web/API/XRPose/emulatedPosition\" title=\"emulatedPosition\"><code>emulatedPosition</code></a> property will be <code>true</code>, indicating that the computation of the pose is based on a guess of the current position of the user.</p>\n<p>Some XR hardware uses algorithms to compute the estimated position of the user based on the movement currently ongoing, while other hardware will report no movement at all, but with <code>emulatedPosition</code> set to <code>true</code>. In either case, you may wish to adjust your rendering to compensate for the loss, depending on your specific needs.</p>"}},{"type":"prose","value":{"id":"when_tracking_resumes","title":"When tracking resumes","isH3":true,"content":"<p>You can detect when tracking has resumed after being lost when the user position jumps while at the same time the value of <code>emulatedPosition</code> changes from <code>true</code> to <code>false</code>. How you handle this depends on your application. If your app provides a way for the user to move through the virtual world without physically moving in the real world (a so-called <strong>teleportation</strong> mechanic), you can accept the new position and continue, allowing the jump from your previously-assumed position to be immediately corrected with the new position.</p>\n<p>On the other hand, if your app involves the user physically moving in real space to move around through your virtual world, adopting the new tracking position and jumping there can be unsettling to the user, and should be avoided if possible. Instead, use the difference between the current position and the new tracking position to compute the new teleportation offset; that is, a transform applied to everything to adapt the position and orientation data from WebXR to your needs.</p>\n<p>You can do this by creating a new reference space that incorporates into its effective origin the distance the viewer's position jumped since the previous frame, using the <a href=\"/en-US/docs/Web/API/XRReferenceSpace\"><code>XRReferenceSpace</code></a> method <a href=\"/en-US/docs/Web/API/XRReferenceSpace/getOffsetReferenceSpace\" title=\"getOffsetReferenceSpace()\"><code>getOffsetReferenceSpace()</code></a>.</p>"}},{"type":"prose","value":{"id":"the_reset_event","title":"The reset event","isH3":true,"content":"<p><strong><em>&lt;&lt;&lt;--- this section probably has problems still; corrections are appreciated ---&gt;&gt;&gt;</em></strong></p>\n<p>When a discontinuity or break in the native or effective origin of a reference space occurs, the <a href=\"/en-US/docs/Glossary/User_agent\">user agent</a> will send the <a href=\"/en-US/docs/Web/API/XRReferenceSpace\"><code>XRReferenceSpace</code></a> a <a href=\"/en-US/docs/Web/API/XRReferenceSpace/reset_event\" title=\"reset\"><code>reset</code></a> event. This event indicates that a significant change to the origin's position has taken place relative to the user's environment.</p>\n<p>A <code>reset</code> may occur because the XR hardware lost connectivity for a time, resulting in the user's movements not being properly tracked for a while. Upon recovery of tracking, a <code>reset</code> means tracking has been restored and the new position information represents the actual position information provided by the XR hardware, rather than cached or \"best-guess\" data.</p>\n<p>Another reason <code>reset</code> may be sent is because the user has exited the bounds of a reference space and entered another reference space, or because the user has been transitioned programmatically from one reference space to another. Any time the bounds geometry of the user's space changes, a <code>reset</code> is sent.</p>\n<p><code>reset</code> is only used for significant jumps or transitions; minor things will just be absorbed automatically. The event is always sent to every affected reference space, including those created using <code>getOffsetReferenceSpace()</code>, so if you listen for <code>reset</code> events, you need to be sure you retain a strong reference to any spaces you're still using.</p>"}},{"type":"prose","value":{"id":"see_also","title":"See also","isH3":false,"content":"<ul>\n  <li><a href=\"/en-US/docs/Web/API/WebGL_API/Matrix_math_for_the_web\">Matrix math for the web</a></li>\n  <li><a href=\"/en-US/docs/Web/API/WebXR_Device_API/Geometry\">Geometry and reference spaces in WebXR</a></li>\n  <li><a href=\"/en-US/docs/Web/API/WebXR_Device_API/Rendering\">Rendering and the WebXR frame animation callback</a></li>\n  <li><a href=\"/en-US/docs/Web/API/WebXR_Device_API/Cameras\">Viewpoints and viewers: Simulating cameras in WebXR</a></li>\n  <li><a href=\"/en-US/docs/Web/API/WebXR_Device_API/Movement_and_motion\">Movement, orientation, and motion: A WebXR example</a></li>\n  <li><a href=\"/en-US/docs/Web/API/WebXR_Device_API/Bounded_reference_spaces\">Using bounded reference spaces</a></li>\n</ul>"}}],"toc":[{"text":"Representing a position using a reference space","id":"representing_a_position_using_a_reference_space"},{"text":"Describing a position relative to a space","id":"describing_a_position_relative_to_a_space"},{"text":"Offsetting or moving reference spaces","id":"offsetting_or_moving_reference_spaces"},{"text":"Continuity and recovery after tracking loss","id":"continuity_and_recovery_after_tracking_loss"},{"text":"See also","id":"see_also"}],"summary":"The WebXR APIs used for implementing augmented and virtual reality is designed specifically to provide the ability to insert a human into a virtual environment. To accomplish this, software needs the ability to not only track the locations, orientation, and movements of objects in the virtual world, but the user's location, orientation, and movement as well. But WebXR goes beyond that by adding the ability to track the location, orientation, and motion of the input devices which generate data used to determine the position and movement of individual parts of the viewer's body (with appropriate equipment).","popularity":0.0006,"modified":"2023-07-07T07:19:19.000Z","source":{"folder":"en-us/web/api/webxr_device_api/spatial_tracking","github_url":"https://github.com/mdn/content/blob/main/files/en-us/web/api/webxr_device_api/spatial_tracking/index.md","last_commit_url":"https://github.com/mdn/content/commit/acfe8c9f1f4145f77653a2bc64a9744b001358dc","filename":"index.md"},"short_title":"Spaces and reference spaces: Spatial tracking in WebXR","parents":[{"uri":"/en-US/docs/Web","title":"References"},{"uri":"/en-US/docs/Web/API","title":"Web APIs"},{"uri":"/en-US/docs/Web/API/WebXR_Device_API","title":"WebXR Device API"},{"uri":"/en-US/docs/Web/API/WebXR_Device_API/Spatial_tracking","title":"Spaces and reference spaces: Spatial tracking in WebXR"}],"pageTitle":"Spaces and reference spaces: Spatial tracking in WebXR - Web APIs | MDN","noIndexing":false}}</script></body></html>