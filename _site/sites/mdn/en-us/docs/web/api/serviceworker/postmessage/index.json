{"doc":{"isMarkdown":true,"isTranslated":false,"isActive":true,"flaws":{},"title":"ServiceWorker: postMessage() method","mdn_url":"/en-US/docs/Web/API/ServiceWorker/postMessage","locale":"en-US","native":"English (US)","browserCompat":["api.ServiceWorker.postMessage"],"sidebarHTML":"<ol><li><strong><a href=\"/en-US/docs/Web/API/Service_Worker_API\">Service Worker API</a></strong></li><li><strong><a href=\"/en-US/docs/Web/API/ServiceWorker\"><code>ServiceWorker</code></a></strong></li><li class=\"toggle\"><details open=\"\"><summary>Instance properties</summary><ol><li><a href=\"/en-US/docs/Web/API/ServiceWorker/scriptURL\"><code>scriptURL</code></a></li><li><a href=\"/en-US/docs/Web/API/ServiceWorker/state\"><code>state</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Instance methods</summary><ol><li><em><code>postMessage()</code> </em></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Events</summary><ol><li><a href=\"/en-US/docs/Web/API/ServiceWorker/error_event\"><code>error</code></a></li><li><a href=\"/en-US/docs/Web/API/ServiceWorker/statechange_event\"><code>statechange</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Inheritance:</summary><ol><li><a href=\"/en-US/docs/Web/API/EventTarget\"><code>EventTarget</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Related pages for Service Workers API</summary><ol><li><a href=\"/en-US/docs/Web/API/Cache\"><code>Cache</code></a></li><li><a href=\"/en-US/docs/Web/API/CacheStorage\"><code>CacheStorage</code></a></li><li><a href=\"/en-US/docs/Web/API/Client\"><code>Client</code></a></li><li><a href=\"/en-US/docs/Web/API/Clients\"><code>Clients</code></a></li><li><a href=\"/en-US/docs/Web/API/ExtendableEvent\"><code>ExtendableEvent</code></a></li><li><a href=\"/en-US/docs/Web/API/ExtendableMessageEvent\"><code>ExtendableMessageEvent</code></a></li><li><a href=\"/en-US/docs/Web/API/FetchEvent\"><code>FetchEvent</code></a></li><li><a href=\"/en-US/docs/Web/API/InstallEvent\"><code>InstallEvent</code></a></li><li><a href=\"/en-US/docs/Web/API/Navigator/serviceWorker\"><code>Navigator.serviceWorker</code></a></li><li><a href=\"/en-US/docs/Web/API/ServiceWorkerContainer\"><code>ServiceWorkerContainer</code></a></li><li><a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope\"><code>ServiceWorkerGlobalScope</code></a></li><li><a href=\"/en-US/docs/Web/API/ServiceWorkerRegistration\"><code>ServiceWorkerRegistration</code></a></li><li><a href=\"/en-US/docs/Web/API/WindowClient\"><code>WindowClient</code></a></li><li><a href=\"/en-US/docs/Web/API/WorkerNavigator/serviceWorker\"><code>WorkerNavigator.serviceWorker</code></a></li></ol></details></li></ol>","sidebarMacro":"APIRef","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<div class=\"notecard secure\" id=\"sect1\"><p><strong>Secure context:</strong> This feature is available only in <a href=\"/en-US/docs/Web/Security/Secure_Contexts\">secure contexts</a> (HTTPS), in some or all <a href=\"#browser_compatibility\">supporting browsers</a>.</p></div>\n<p>The <strong><code>postMessage()</code></strong> method of the <a href=\"/en-US/docs/Web/API/ServiceWorker\"><code>ServiceWorker</code></a> interface sends a message to the worker. This accepts a single parameter, which is the data to send to the worker. The data may be any JavaScript object which can be handled by the <a href=\"/en-US/docs/Web/API/Web_Workers_API/Structured_clone_algorithm\">structured clone algorithm</a>.</p>\n<p>The service worker can send back information to its clients by using the <a href=\"/en-US/docs/Web/API/Client/postMessage\" title=\"postMessage()\"><code>postMessage()</code></a> method. The message will not be sent back to this <code>ServiceWorker</code> object but to the associated <a href=\"/en-US/docs/Web/API/ServiceWorkerContainer\"><code>ServiceWorkerContainer</code></a> available via <a href=\"/en-US/docs/Web/API/Navigator/serviceWorker\"><code>navigator.serviceWorker</code></a>.</p>"}},{"type":"prose","value":{"id":"syntax","title":"Syntax","isH3":false,"content":"<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token function\">postMessage</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">)</span>\n<span class=\"token function\">postMessage</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">,</span> options<span class=\"token punctuation\">)</span>\n<span class=\"token function\">postMessage</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">,</span> transfer<span class=\"token punctuation\">)</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"parameters","title":"Parameters","isH3":true,"content":"<dl>\n  <dt id=\"message\"><a href=\"#message\"><code>message</code></a></dt>\n  <dd>\n    <p>The object to deliver to the worker; this will be in the <code>data</code> field in the event delivered to the <a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope/message_event\" title=\"message\"><code>message</code></a> event. This may be any JavaScript object handled by the <a href=\"/en-US/docs/Web/API/Web_Workers_API/Structured_clone_algorithm\">structured clone algorithm</a>.</p>\n    <p>The <code>message</code> parameter is mandatory. If the data to be passed to the worker is unimportant, <code>null</code> or <code>undefined</code> must be passed explicitly.</p>\n  </dd>\n  <dt id=\"options\"><a href=\"#options\"><code>options</code></a> <span class=\"badge inline optional\">Optional</span></dt>\n  <dd>\n    <p>An optional object containing a <code>transfer</code> field with an <a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array\">array</a> of <a href=\"/en-US/docs/Web/API/Web_Workers_API/Transferable_objects\">transferable objects</a> to transfer ownership of.</p>\n  </dd>\n  <dt id=\"transfer\"><a href=\"#transfer\"><code>transfer</code></a> <span class=\"badge inline optional\">Optional</span></dt>\n  <dd>\n    <p>An optional <a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array\">array</a> of <a href=\"/en-US/docs/Web/API/Web_Workers_API/Transferable_objects\">transferable objects</a> to transfer ownership of. If the ownership of an object is transferred, it becomes unusable in the context it was sent from and becomes available only to the worker it was sent to.</p>\n    <p>Transferable objects are instances of classes like <a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer\"><code>ArrayBuffer</code></a>, <a href=\"/en-US/docs/Web/API/MessagePort\"><code>MessagePort</code></a> or <a href=\"/en-US/docs/Web/API/ImageBitmap\"><code>ImageBitmap</code></a> objects that can be transferred. <code>null</code> is not an acceptable value for <code>transfer</code>.</p>\n  </dd>\n</dl>\n<div class=\"notecard note\" id=\"sect2\">\n  <p><strong>Note:</strong> The parameters <code>options</code> and <code>transfer</code> can't both be used at the same time.</p>\n</div>"}},{"type":"prose","value":{"id":"return_value","title":"Return value","isH3":true,"content":"<p>None (<a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/undefined\"><code>undefined</code></a>).</p>"}},{"type":"prose","value":{"id":"exceptions","title":"Exceptions","isH3":true,"content":"<dl>\n  <dt id=\"syntaxerror\"><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/SyntaxError\"><code>SyntaxError</code></a></dt>\n  <dd>\n    <p>Thrown if the <code>message</code> parameter is not provided.</p>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"examples","title":"Examples","isH3":false,"content":"<p>In this example a <a href=\"/en-US/docs/Web/API/ServiceWorker\"><code>ServiceWorker</code></a> is created and a message is immediately sent:</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code>navigator<span class=\"token punctuation\">.</span>serviceWorker<span class=\"token punctuation\">.</span><span class=\"token function\">register</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"service-worker.js\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nnavigator<span class=\"token punctuation\">.</span>serviceWorker<span class=\"token punctuation\">.</span>ready<span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">registration</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  registration<span class=\"token punctuation\">.</span>active<span class=\"token punctuation\">.</span><span class=\"token function\">postMessage</span><span class=\"token punctuation\">(</span>\n    <span class=\"token string\">\"Test message sent immediately after creation\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>In order to receive the message, the service worker, in <code>service-worker.js</code> has to listen to the <a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope/message_event\" title=\"message\"><code>message</code></a> event on its global scope.</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// This must be in `service-worker.js`</span>\n<span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"message\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Message received: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>event<span class=\"token punctuation\">.</span>data<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Note that the service worker can send back messages to the main thread using the <a href=\"/en-US/docs/Web/API/Client/postMessage\" title=\"postMessage()\"><code>postMessage()</code></a> method. To receive it, the main thread needs to listen for a <a href=\"/en-US/docs/Web/API/ServiceWorkerContainer/message_event\" title=\"message\"><code>message</code></a> event on the <a href=\"/en-US/docs/Web/API/ServiceWorkerContainer\"><code>ServiceWorkerContainer</code></a> object.</p>"}},{"type":"specifications","value":{"title":"Specifications","id":"specifications","isH3":false,"specifications":[{"bcdSpecificationURL":"https://w3c.github.io/ServiceWorker/#dom-serviceworker-postmessage","title":"Service Workers"},{"bcdSpecificationURL":"https://w3c.github.io/ServiceWorker/#dom-serviceworker-postmessage-message-options","title":"Service Workers"}],"query":"api.ServiceWorker.postMessage"}},{"type":"browser_compatibility","value":{"title":"Browser compatibility","id":"browser_compatibility","isH3":false,"query":"api.ServiceWorker.postMessage"}},{"type":"prose","value":{"id":"see_also","title":"See also","isH3":false,"content":"<ul>\n  <li>The <a href=\"/en-US/docs/Web/API/ServiceWorker\"><code>ServiceWorker</code></a> interface it belongs to.</li>\n  <li>Its counterpart, the <a href=\"/en-US/docs/Web/API/Client/postMessage\" title=\"postMessage()\"><code>postMessage()</code></a> method that a service worker must use to send a message back to the associated <a href=\"/en-US/docs/Web/API/ServiceWorkerContainer\"><code>ServiceWorkerContainer</code></a>.</li>\n</ul>"}}],"toc":[{"text":"Syntax","id":"syntax"},{"text":"Examples","id":"examples"},{"text":"Specifications","id":"specifications"},{"text":"Browser compatibility","id":"browser_compatibility"},{"text":"See also","id":"see_also"}],"summary":"The postMessage() method of the ServiceWorker interface sends a message to the worker. This accepts a single parameter, which is the data to send to the worker. The data may be any JavaScript object which can be handled by the structured clone algorithm.","popularity":0.006,"modified":"2023-07-07T07:19:19.000Z","source":{"folder":"en-us/web/api/serviceworker/postmessage","github_url":"https://github.com/mdn/content/blob/main/files/en-us/web/api/serviceworker/postmessage/index.md","last_commit_url":"https://github.com/mdn/content/commit/acfe8c9f1f4145f77653a2bc64a9744b001358dc","filename":"index.md"},"short_title":"postMessage()","parents":[{"uri":"/en-US/docs/Web","title":"References"},{"uri":"/en-US/docs/Web/API","title":"Web APIs"},{"uri":"/en-US/docs/Web/API/ServiceWorker","title":"ServiceWorker"},{"uri":"/en-US/docs/Web/API/ServiceWorker/postMessage","title":"postMessage()"}],"pageTitle":"ServiceWorker: postMessage() method - Web APIs | MDN","noIndexing":false}}