{"doc":{"isMarkdown":true,"isTranslated":false,"isActive":true,"flaws":{},"title":"ServiceWorkerGlobalScope: paymentrequest event","mdn_url":"/en-US/docs/Web/API/ServiceWorkerGlobalScope/paymentrequest_event","locale":"en-US","native":"English (US)","browserCompat":["api.ServiceWorkerGlobalScope.paymentrequest_event"],"sidebarHTML":"<ol><li><strong><a href=\"/en-US/docs/Web/API/Payment_Handler_API\">Payment Handler API</a></strong></li><li><strong><a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope\"><code>ServiceWorkerGlobalScope</code></a></strong></li><li class=\"toggle\"><details open=\"\"><summary>Instance properties</summary><ol><li><a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope/clients\"><code>clients</code></a></li><li><a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope/registration\"><code>registration</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Instance methods</summary><ol><li><a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope/skipWaiting\"><code>skipWaiting()</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Events</summary><ol><li><a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope/activate_event\"><code>activate</code></a></li><li><a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope/backgroundfetchabort_event\"><code>backgroundfetchabort</code></a><abbr class=\"icon icon-experimental\" title=\"Experimental. Expect behavior to change in the future.\">\n    <span class=\"visually-hidden\">Experimental</span>\n</abbr></li><li><a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope/backgroundfetchclick_event\"><code>backgroundfetchclick</code></a><abbr class=\"icon icon-experimental\" title=\"Experimental. Expect behavior to change in the future.\">\n    <span class=\"visually-hidden\">Experimental</span>\n</abbr></li><li><a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope/backgroundfetchfail_event\"><code>backgroundfetchfail</code></a><abbr class=\"icon icon-experimental\" title=\"Experimental. Expect behavior to change in the future.\">\n    <span class=\"visually-hidden\">Experimental</span>\n</abbr></li><li><a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope/backgroundfetchsuccess_event\"><code>backgroundfetchsuccess</code></a><abbr class=\"icon icon-experimental\" title=\"Experimental. Expect behavior to change in the future.\">\n    <span class=\"visually-hidden\">Experimental</span>\n</abbr></li><li><a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope/canmakepayment_event\"><code>canmakepayment</code></a><abbr class=\"icon icon-experimental\" title=\"Experimental. Expect behavior to change in the future.\">\n    <span class=\"visually-hidden\">Experimental</span>\n</abbr></li><li><a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope/contentdelete_event\"><code>contentdelete</code></a><abbr class=\"icon icon-experimental\" title=\"Experimental. Expect behavior to change in the future.\">\n    <span class=\"visually-hidden\">Experimental</span>\n</abbr></li><li><a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope/fetch_event\"><code>fetch</code></a></li><li><a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope/install_event\"><code>install</code></a></li><li><a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope/message_event\"><code>message</code></a></li><li><a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope/messageerror_event\"><code>messageerror</code></a></li><li><a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope/notificationclick_event\"><code>notificationclick</code></a></li><li><a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope/notificationclose_event\"><code>notificationclose</code></a></li><li><em><code>paymentrequest</code> <abbr class=\"icon icon-experimental\" title=\"Experimental. Expect behavior to change in the future.\">\n    <span class=\"visually-hidden\">Experimental</span>\n</abbr></em></li><li><a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope/periodicsync_event\"><code>periodicsync</code></a><abbr class=\"icon icon-experimental\" title=\"Experimental. Expect behavior to change in the future.\">\n    <span class=\"visually-hidden\">Experimental</span>\n</abbr></li><li><a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope/push_event\"><code>push</code></a></li><li><a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope/pushsubscriptionchange_event\"><code>pushsubscriptionchange</code></a></li><li><a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope/sync_event\"><code>sync</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Inheritance:</summary><ol><li><a href=\"/en-US/docs/Web/API/WorkerGlobalScope\"><code>WorkerGlobalScope</code></a></li><li><a href=\"/en-US/docs/Web/API/EventTarget\"><code>EventTarget</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Related pages for Payment Handler API</summary><ol><li><a href=\"/en-US/docs/Web/API/CanMakePaymentEvent\"><code>CanMakePaymentEvent</code></a></li><li><a href=\"/en-US/docs/Web/API/PaymentManager\"><code>PaymentManager</code></a></li><li><a href=\"/en-US/docs/Web/API/PaymentRequestEvent\"><code>PaymentRequestEvent</code></a></li><li><a href=\"/en-US/docs/Web/API/ServiceWorkerRegistration/paymentManager\"><code>ServiceWorkerRegistration.paymentManager</code></a></li></ol></details></li></ol>","sidebarMacro":"APIRef","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<div class=\"notecard experimental\" id=\"sect1\"><p><strong>Experimental:</strong> <strong>This is an <a href=\"/en-US/docs/MDN/Writing_guidelines/Experimental_deprecated_obsolete#experimental\">experimental technology</a></strong><br>Check the <a href=\"#browser_compatibility\">Browser compatibility table</a> carefully before using this in production.</p></div>\n<p>The <strong><code>paymentrequest</code></strong> event of the <a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope\"><code>ServiceWorkerGlobalScope</code></a> interface is fired on a payment app when a payment flow has been initiated on the merchant website via the <a href=\"/en-US/docs/Web/API/PaymentRequest/show\"><code>PaymentRequest.show()</code></a> method.</p>"}},{"type":"prose","value":{"id":"syntax","title":"Syntax","isH3":false,"content":"<p>Use the event name in methods like <a href=\"/en-US/docs/Web/API/EventTarget/addEventListener\" title=\"addEventListener()\"><code>addEventListener()</code></a>, or set an event handler property.</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"paymentrequest\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function-variable function\">onpaymentrequest</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"event_type","title":"Event type","isH3":false,"content":"<p>A <a href=\"/en-US/docs/Web/API/PaymentRequestEvent\"><code>PaymentRequestEvent</code></a>. Inherits from <a href=\"/en-US/docs/Web/API/ExtendableEvent\"><code>ExtendableEvent</code></a>.</p><svg viewBox=\"-1 -1 650 42\" preserveAspectRatio=\"xMinYMin meet\">\n  <a style=\"text-decoration: none;\" xlink:href=\"/en-US/docs/Web/API/Event\">\n    <rect x=\"0\" y=\"0\" width=\"75\" height=\"25\" fill=\"#fff\" stroke=\"#D4DDE4\" stroke-width=\"2px\"></rect>\n    <text x=\"37.5\" y=\"16\" font-size=\"10px\" fill=\"#4D4E53\" text-anchor=\"middle\">\n      Event\n    </text>\n  </a>\n  <line x1=\"75\" y1=\"14\" x2=\"105\" y2=\"14\" stroke=\"#D4DDE4\"></line>\n  <polyline points=\"75,14 85,9 85,19 75,14\" stroke=\"#D4DDE4\" fill=\"#fff\"></polyline>\n  <a style=\"text-decoration: none;\" xlink:href=\"/en-US/docs/Web/API/ExtendableEvent\">\n    <rect x=\"105\" y=\"0\" width=\"120\" height=\"25\" fill=\"#fff\" stroke=\"#D4DDE4\" stroke-width=\"2px\"></rect>\n    <text x=\"165\" y=\"16\" font-size=\"10px\" fill=\"#4D4E53\" text-anchor=\"middle\">\n      ExtendableEvent\n    </text>\n  </a>\n  <line x1=\"225\" y1=\"14\" x2=\"255\" y2=\"14\" stroke=\"#D4DDE4\"></line>\n  <polyline points=\"225,14 235,9 235,19 225,14\" stroke=\"#D4DDE4\" fill=\"#fff\"></polyline>\n  <a style=\"text-decoration: none;\" xlink:href=\"/en-US/docs/Web/API/PaymentRequestEvent\">\n    <rect x=\"255\" y=\"0\" width=\"152\" height=\"25\" fill=\"#F4F7F8\" stroke=\"#D4DDE4\" stroke-width=\"2px\"></rect>\n    <text x=\"331\" y=\"16\" font-size=\"10px\" fill=\"#4D4E53\" text-anchor=\"middle\">\n      PaymentRequestEvent\n    </text>\n  </a></svg>"}},{"type":"prose","value":{"id":"examples","title":"Examples","isH3":false,"content":"<p>When the <a href=\"/en-US/docs/Web/API/PaymentRequest/show\"><code>PaymentRequest.show()</code></a> method is invoked, a <a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope/paymentrequest_event\" title=\"paymentrequest\" aria-current=\"page\"><code>paymentrequest</code></a> event is fired on the service worker of the payment app. This event is listened for inside the payment app's service worker to begin the next stage of the payment process.</p>\n<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">let</span> payment_request_event<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> resolver<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> client<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// `self` is the global object in service worker</span>\nself<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"paymentrequest\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>payment_request_event<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// If there's an ongoing payment transaction, reject it.</span>\n    resolver<span class=\"token punctuation\">.</span><span class=\"token function\">reject</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token comment\">// Preserve the event for future use</span>\n  payment_request_event <span class=\"token operator\">=</span> e<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>When a <code>paymentrequest</code> event is received, the payment app can open a payment handler window by calling <a href=\"/en-US/docs/Web/API/PaymentRequestEvent/openWindow\"><code>PaymentRequestEvent.openWindow()</code></a>. The payment handler window will present the customers with a payment app interface where they can authenticate, choose shipping address and options, and authorize the payment.</p>\n<p>When the payment has been handled, <a href=\"/en-US/docs/Web/API/PaymentRequestEvent/respondWith\"><code>PaymentRequestEvent.respondWith()</code></a> is used to pass the payment result back to the merchant website.</p>\n<p>See <a href=\"https://web.dev/articles/orchestrating-payment-transactions#receive-payment-request-event\" class=\"external\" target=\"_blank\">Receive a payment request event from the merchant</a> for more details of this stage.</p>"}},{"type":"specifications","value":{"title":"Specifications","id":"specifications","isH3":false,"specifications":[{"bcdSpecificationURL":"https://w3c.github.io/payment-handler/#the-paymentrequestevent","title":"Payment Handler API"}],"query":"api.ServiceWorkerGlobalScope.paymentrequest_event"}},{"type":"browser_compatibility","value":{"title":"Browser compatibility","id":"browser_compatibility","isH3":false,"query":"api.ServiceWorkerGlobalScope.paymentrequest_event"}},{"type":"prose","value":{"id":"see_also","title":"See also","isH3":false,"content":"<ul>\n  <li><a href=\"/en-US/docs/Web/API/Payment_Handler_API\" title=\"Payment Handler API\">Payment Handler API</a></li>\n  <li><a href=\"https://web.dev/articles/web-based-payment-apps-overview\" class=\"external\" target=\"_blank\">Web-based payment apps overview</a></li>\n  <li><a href=\"https://web.dev/articles/setting-up-a-payment-method\" class=\"external\" target=\"_blank\">Setting up a payment method</a></li>\n  <li><a href=\"https://web.dev/articles/life-of-a-payment-transaction\" class=\"external\" target=\"_blank\">Life of a payment transaction</a></li>\n  <li><a href=\"/en-US/docs/Web/API/Payment_Request_API/Using_the_Payment_Request_API\">Using the Payment Request API</a></li>\n  <li><a href=\"/en-US/docs/Web/API/Payment_Request_API/Concepts\">Payment processing concepts</a></li>\n</ul>"}}],"toc":[{"text":"Syntax","id":"syntax"},{"text":"Event type","id":"event_type"},{"text":"Examples","id":"examples"},{"text":"Specifications","id":"specifications"},{"text":"Browser compatibility","id":"browser_compatibility"},{"text":"See also","id":"see_also"}],"summary":"The paymentrequest event of the ServiceWorkerGlobalScope interface is fired on a payment app when a payment flow has been initiated on the merchant website via the PaymentRequest.show() method.","popularity":0,"modified":"2023-10-25T17:27:32.000Z","source":{"folder":"en-us/web/api/serviceworkerglobalscope/paymentrequest_event","github_url":"https://github.com/mdn/content/blob/main/files/en-us/web/api/serviceworkerglobalscope/paymentrequest_event/index.md","last_commit_url":"https://github.com/mdn/content/commit/835d6632d59993861a0458510402787f8a2c3cb3","filename":"index.md"},"short_title":"paymentrequest","parents":[{"uri":"/en-US/docs/Web","title":"References"},{"uri":"/en-US/docs/Web/API","title":"Web APIs"},{"uri":"/en-US/docs/Web/API/ServiceWorkerGlobalScope","title":"ServiceWorkerGlobalScope"},{"uri":"/en-US/docs/Web/API/ServiceWorkerGlobalScope/paymentrequest_event","title":"paymentrequest"}],"pageTitle":"ServiceWorkerGlobalScope: paymentrequest event - Web APIs | MDN","noIndexing":false}}