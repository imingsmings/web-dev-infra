{"doc":{"isMarkdown":true,"isTranslated":false,"isActive":true,"flaws":{},"title":"RTCRtpSender: replaceTrack() method","mdn_url":"/en-US/docs/Web/API/RTCRtpSender/replaceTrack","locale":"en-US","native":"English (US)","browserCompat":["api.RTCRtpSender.replaceTrack"],"sidebarHTML":"<ol><li><strong><a href=\"/en-US/docs/Web/API/WebRTC_API\">WebRTC API</a></strong></li><li><strong><a href=\"/en-US/docs/Web/API/RTCRtpSender\"><code>RTCRtpSender</code></a></strong></li><li class=\"toggle\"><details open=\"\"><summary>Instance properties</summary><ol><li><a href=\"/en-US/docs/Web/API/RTCRtpSender/dtmf\"><code>dtmf</code></a></li><li><a href=\"/en-US/docs/Web/API/RTCRtpSender/track\"><code>track</code></a></li><li><a href=\"/en-US/docs/Web/API/RTCRtpSender/transform\"><code>transform</code></a></li><li><a href=\"/en-US/docs/Web/API/RTCRtpSender/transport\"><code>transport</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Static methods</summary><ol><li><a href=\"/en-US/docs/Web/API/RTCRtpSender/getCapabilities_static\"><code>getCapabilities()</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Instance methods</summary><ol><li><a href=\"/en-US/docs/Web/API/RTCRtpSender/getParameters\"><code>getParameters()</code></a></li><li><a href=\"/en-US/docs/Web/API/RTCRtpSender/getStats\"><code>getStats()</code></a></li><li><em><code>replaceTrack()</code> </em></li><li><a href=\"/en-US/docs/Web/API/RTCRtpSender/setParameters\"><code>setParameters()</code></a></li><li><a href=\"/en-US/docs/Web/API/RTCRtpSender/setStreams\"><code>setStreams()</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Related pages for WebRTC</summary><ol><li><a href=\"/en-US/docs/Web/API/MediaDevices/getUserMedia\"><code>MediaDevices.getUserMedia()</code></a></li><li><a href=\"/en-US/docs/Web/API/Navigator/mediaDevices\"><code>Navigator.mediaDevices</code></a></li><li><a href=\"/en-US/docs/Web/API/RTCCertificate\"><code>RTCCertificate</code></a></li><li><a href=\"/en-US/docs/Web/API/RTCDTMFSender\"><code>RTCDTMFSender</code></a></li><li><a href=\"/en-US/docs/Web/API/RTCDTMFToneChangeEvent\"><code>RTCDTMFToneChangeEvent</code></a></li><li><a href=\"/en-US/docs/Web/API/RTCDataChannel\"><code>RTCDataChannel</code></a></li><li><a href=\"/en-US/docs/Web/API/RTCDataChannelEvent\"><code>RTCDataChannelEvent</code></a></li><li><a href=\"/en-US/docs/Web/API/RTCDtlsTransport\"><code>RTCDtlsTransport</code></a></li><li><a href=\"/en-US/docs/Web/API/RTCEncodedAudioFrame\"><code>RTCEncodedAudioFrame</code></a></li><li><a href=\"/en-US/docs/Web/API/RTCEncodedVideoFrame\"><code>RTCEncodedVideoFrame</code></a></li><li><a href=\"/en-US/docs/Web/API/RTCErrorEvent\"><code>RTCErrorEvent</code></a></li><li><a href=\"/en-US/docs/Web/API/RTCIceCandidate\"><code>RTCIceCandidate</code></a></li><li><a href=\"/en-US/docs/Web/API/RTCIceTransport\"><code>RTCIceTransport</code></a></li><li><a href=\"/en-US/docs/Web/API/RTCPeerConnection\"><code>RTCPeerConnection</code></a></li><li><a href=\"/en-US/docs/Web/API/RTCPeerConnectionIceErrorEvent\"><code>RTCPeerConnectionIceErrorEvent</code></a></li><li><a href=\"/en-US/docs/Web/API/RTCPeerConnectionIceEvent\"><code>RTCPeerConnectionIceEvent</code></a></li><li><a href=\"/en-US/docs/Web/API/RTCRtpReceiver\"><code>RTCRtpReceiver</code></a></li><li><a href=\"/en-US/docs/Web/API/RTCRtpReceiver/transform\"><code>RTCRtpReceiver.transform</code></a></li><li><a href=\"/en-US/docs/Web/API/RTCRtpScriptTransform\"><code>RTCRtpScriptTransform</code></a></li><li><a href=\"/en-US/docs/Web/API/RTCRtpScriptTransformer\"><code>RTCRtpScriptTransformer</code></a></li><li><a href=\"/en-US/docs/Web/API/RTCRtpSender/transform\"><code>RTCRtpSender.transform</code></a></li><li><a href=\"/en-US/docs/Web/API/RTCRtpTransceiver\"><code>RTCRtpTransceiver</code></a></li><li><a href=\"/en-US/docs/Web/API/RTCSctpTransport\"><code>RTCSctpTransport</code></a></li><li><a href=\"/en-US/docs/Web/API/RTCSessionDescription\"><code>RTCSessionDescription</code></a></li><li><a href=\"/en-US/docs/Web/API/RTCStatsReport\"><code>RTCStatsReport</code></a></li><li><a href=\"/en-US/docs/Web/API/RTCTrackEvent\"><code>RTCTrackEvent</code></a></li><li><a href=\"/en-US/docs/Web/API/RTCTransformEvent\"><code>RTCTransformEvent</code></a></li></ol></details></li></ol>","sidebarMacro":"APIRef","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p>\n  The <a href=\"/en-US/docs/Web/API/RTCRtpSender\"><code>RTCRtpSender</code></a> method\n  <strong><code>replaceTrack()</code></strong> replaces the track currently being used\n  as the sender's source with a new <a href=\"/en-US/docs/Web/API/MediaStreamTrack\"><code>MediaStreamTrack</code></a>.\n</p>\n<p>\n  The new\n  track must be of the same media kind (audio, video, etc.) and switching the track should\n  not require negotiation.\n</p>\n<p>\n  Among the use cases for <code>replaceTrack()</code> is the common need to switch\n  between the rear- and front-facing cameras on a phone. With <code>replaceTrack()</code>,\n  you can have a track object for each camera and switch between the two as needed. See\n  the example <a href=\"#switching_cameras\">Switching cameras</a> below.\n</p>"}},{"type":"prose","value":{"id":"syntax","title":"Syntax","isH3":false,"content":"<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token function\">replaceTrack</span><span class=\"token punctuation\">(</span>newTrack<span class=\"token punctuation\">)</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"parameters","title":"Parameters","isH3":true,"content":"<dl>\n  <dt id=\"newtrack\"><a href=\"#newtrack\"><code>newTrack</code></a> <span class=\"badge inline optional\">Optional</span></dt>\n  <dd>\n    <p>\n      A <a href=\"/en-US/docs/Web/API/MediaStreamTrack\"><code>MediaStreamTrack</code></a> specifying the track with which to replace the\n      <code>RTCRtpSender</code>'s current source track. The new track's\n      <a href=\"/en-US/docs/Web/API/MediaStreamTrack/kind\" title=\"kind\"><code>kind</code></a> must be the same as the current track's,\n      or the replace track request will fail.\n    </p>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"return_value","title":"Return value","isH3":true,"content":"<p>\n  A <a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise\"><code>Promise</code></a> which is fulfilled once the track has been successfully\n  replaced. The promise is rejected if the track cannot be replaced for any reason; this\n  is commonly because the change would require renegotiation of the codec, which is not\n  allowed (see <a href=\"#things_that_require_negotiation\">Things that require negotiation</a>).\n</p>\n<p>\n  If <code>newTrack</code> was omitted or was <code>null</code>,\n  <code>replaceTrack()</code> stops the sender. No negotiation is required in this case.\n</p>\n<p>\n  When the promise is fulfilled, the fulfillment handler receives a value of\n  <code>undefined</code>.\n</p>"}},{"type":"prose","value":{"id":"exceptions","title":"Exceptions","isH3":true,"content":"<p>\n  If the returned promise is rejected, one of the following exceptions is provided to the\n  rejection handler:\n</p>\n<dl>\n  <dt id=\"invalidmodificationerror\"><a href=\"#invalidmodificationerror\"><code>InvalidModificationError</code></a> <a href=\"/en-US/docs/Web/API/DOMException\"><code>DOMException</code></a></dt>\n  <dd>\n    <p>\n      Returned if replacing the <code>RTCRtpSender</code>'s current track with the new one\n      would require negotiation.\n    </p>\n  </dd>\n  <dt id=\"invalidstateerror\"><a href=\"#invalidstateerror\"><code>InvalidStateError</code></a> <a href=\"/en-US/docs/Web/API/DOMException\"><code>DOMException</code></a></dt>\n  <dd>\n    <p>Returned if the track on which this method was called is stopped rather than running.</p>\n  </dd>\n  <dt id=\"typeerror\"><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypeError\"><code>TypeError</code></a></dt>\n  <dd>\n    <p>Returned if the new track's <code>kind</code> doesn't match the original track.</p>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"usage_notes","title":"Usage notes","isH3":false,"content":""}},{"type":"prose","value":{"id":"things_that_require_negotiation","title":"Things that require negotiation","isH3":true,"content":"<p>\n  Most track replacements can be done without renegotiation. In fact, even changes that seem huge\n  can be done without requiring negotiation. However, some changes may require\n  negotiation and thus fail <code>replaceTrack()</code>:\n</p>\n<ul>\n  <li>\n    The new track has a resolution which is outside the bounds of the dimensions negotiated with the peer;\n    however, most browser end points allow resolution changes.\n  </li>\n  <li>\n    The new track's frame rate is high enough to cause the codec's block rate to be\n    exceeded.\n  </li>\n  <li>\n    The new track is a video track and its raw or pre-encoded state differs from that of\n    the original track.\n  </li>\n  <li>\n    The new track is an audio track with a different number of channels from the\n    original.\n  </li>\n  <li>\n    Media sources that have built-in encoders — such as hardware encoders — may not be\n    able to provide the negotiated codec. Software sources may not implement the\n    negotiated codec.\n  </li>\n</ul>"}},{"type":"prose","value":{"id":"examples","title":"Examples","isH3":false,"content":""}},{"type":"prose","value":{"id":"switching_video_cameras","title":"Switching video cameras","isH3":true,"content":"<div class=\"code-example\"><p class=\"example-header\"><span class=\"language-name\">js</span></p><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">const</span> localConnection <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RTCPeerConnection</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> remoteConnection <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RTCPeerConnection</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// Configuring these to use the WebRTC API can be explored at</span>\n<span class=\"token comment\">// https://developer.mozilla.org/en-US/docs/Web/API/WebRTC_API/Simple_RTCDataChannel_sample</span>\n<span class=\"token keyword\">const</span> connections <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>localConnection<span class=\"token punctuation\">,</span> remoteConnection<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">setCamera</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">selectedCamera</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  navigator<span class=\"token punctuation\">.</span>mediaDevices\n    <span class=\"token punctuation\">.</span><span class=\"token function\">getUserMedia</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">video</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">deviceId</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token literal-property property\">exact</span><span class=\"token operator\">:</span> selectedCamera<span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">stream</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>videoTrack<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> stream<span class=\"token punctuation\">.</span><span class=\"token function\">getVideoTracks</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      connections<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">pc</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> sender <span class=\"token operator\">=</span> pc\n          <span class=\"token punctuation\">.</span><span class=\"token function\">getSenders</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">s</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> s<span class=\"token punctuation\">.</span>track<span class=\"token punctuation\">.</span>kind <span class=\"token operator\">===</span> videoTrack<span class=\"token punctuation\">.</span>kind<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Found sender:\"</span><span class=\"token punctuation\">,</span> sender<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        sender<span class=\"token punctuation\">.</span><span class=\"token function\">replaceTrack</span><span class=\"token punctuation\">(</span>videoTrack<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">err</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Error happened: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>err<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>"}},{"type":"specifications","value":{"title":"Specifications","id":"specifications","isH3":false,"specifications":[{"bcdSpecificationURL":"https://w3c.github.io/webrtc-pc/#dom-rtcrtpsender-replacetrack","title":"WebRTC: Real-Time Communication in Browsers"}],"query":"api.RTCRtpSender.replaceTrack"}},{"type":"browser_compatibility","value":{"title":"Browser compatibility","id":"browser_compatibility","isH3":false,"query":"api.RTCRtpSender.replaceTrack"}},{"type":"prose","value":{"id":"see_also","title":"See also","isH3":false,"content":"<ul>\n  <li><a href=\"/en-US/docs/Web/API/WebRTC_API\">WebRTC API</a></li>\n</ul>"}}],"toc":[{"text":"Syntax","id":"syntax"},{"text":"Usage notes","id":"usage_notes"},{"text":"Examples","id":"examples"},{"text":"Specifications","id":"specifications"},{"text":"Browser compatibility","id":"browser_compatibility"},{"text":"See also","id":"see_also"}],"summary":"The RTCRtpSender method\n  replaceTrack() replaces the track currently being used\n  as the sender's source with a new MediaStreamTrack.","popularity":0.0021,"modified":"2023-07-03T09:21:02.000Z","source":{"folder":"en-us/web/api/rtcrtpsender/replacetrack","github_url":"https://github.com/mdn/content/blob/main/files/en-us/web/api/rtcrtpsender/replacetrack/index.md","last_commit_url":"https://github.com/mdn/content/commit/e0d92259b485a219840367cf4e23a7069f192eec","filename":"index.md"},"short_title":"replaceTrack()","parents":[{"uri":"/en-US/docs/Web","title":"References"},{"uri":"/en-US/docs/Web/API","title":"Web APIs"},{"uri":"/en-US/docs/Web/API/RTCRtpSender","title":"RTCRtpSender"},{"uri":"/en-US/docs/Web/API/RTCRtpSender/replaceTrack","title":"replaceTrack()"}],"pageTitle":"RTCRtpSender: replaceTrack() method - Web APIs | MDN","noIndexing":false}}